1
00:00:10,320 --> 00:00:35,100
Okay. Let's get started. So today we're going to we're hoping to finish the hidden Markov models and talk a little bit about the F of T possible.

2
00:00:38,650 --> 00:00:49,030
So before starting I just wanted to make you aware that the same.

3
00:00:49,240 --> 00:00:56,660
So. The assignments are posted for regarding the final project.

4
00:00:56,670 --> 00:01:01,610
So as you see. Well, let's go to the home.

5
00:01:04,040 --> 00:01:10,280
So as you say, you're you're expected to submit your.

6
00:01:13,310 --> 00:01:22,040
Final project presentation slide before sunrise, so on or before Sunday night.

7
00:01:22,790 --> 00:01:31,250
So this is required. So we're going to we're going to decide who's going to present first and who's

8
00:01:31,260 --> 00:01:39,500
going to present they want or need to that is that will be decided and Wednesday.

9
00:01:40,780 --> 00:01:52,540
But. So it's important that you submit everyone submit the slide on Sunday so you can change the slides.

10
00:01:52,720 --> 00:02:01,060
So no matter which date you're presenting, you need to prep you need to prepare your slide before then.

11
00:02:01,540 --> 00:02:05,139
And we're going to just present to All in my computer.

12
00:02:05,140 --> 00:02:10,959
So you should expect to submit a PDF file that is that is presentable.

13
00:02:10,960 --> 00:02:15,190
No and no PowerPoint animation or anything. Okay. And.

14
00:02:16,300 --> 00:02:25,330
You're strictly given 10 minutes and we recommend to use 7 minutes for the presentation, 30 minutes for the Q&A.

15
00:02:25,690 --> 00:02:34,719
So the region, 10 minutes is definitely not enough for to, uh, to, to explain all of what you have done.

16
00:02:34,720 --> 00:02:37,990
But we have a time limit because we have a 15 teams.

17
00:02:38,380 --> 00:02:44,320
So in the first day you're going to have uh, eight people present presenting.

18
00:02:44,320 --> 00:02:51,590
In the second day we are going to have. Seven groups presenting an aid group is actually quite limited for them for the ten days.

19
00:02:51,590 --> 00:02:54,680
So I'm not going to have 10 minutes. I probably need to.

20
00:02:54,900 --> 00:03:00,230
You are welcome to use less than 10 minutes. And what if you have 10 minutes over?

21
00:03:00,470 --> 00:03:08,900
We're going to just switch it up a bit of what happens. Okay. So so it's very important that you deliver what you want to do.

22
00:03:10,400 --> 00:03:16,970
Yeah. Whether you want to say within, within the time limit so that that's important.

23
00:03:17,150 --> 00:03:25,129
Okay. And you have so you have more time to write out your final report.

24
00:03:25,130 --> 00:03:29,930
You're not we're not expecting very long final report to you.

25
00:03:30,620 --> 00:03:37,579
But what what matters more is that the code itself so the have have a have a good

26
00:03:37,580 --> 00:03:43,190
quality code and then if you have some evaluation result in your final report,

27
00:03:43,190 --> 00:03:53,980
that'll be great. The due date is due date is December 16, 12:30 p.m. this is the third.

28
00:03:54,370 --> 00:03:58,749
This is a time where we're supposed to have a final exam. So that's that.

29
00:03:58,750 --> 00:04:02,309
That's how that. That was set up.

30
00:04:02,310 --> 00:04:07,890
So make sure to submit everything before this deadline.

31
00:04:08,080 --> 00:04:19,479
Okay. So yeah. So that's one thing I just wanted to make sure because we have only one week left and I know you came back from the holiday break,

32
00:04:19,480 --> 00:04:27,219
but this is important announcement. Yeah, I noticed that, uh, that many people are watching that.

33
00:04:27,220 --> 00:04:38,730
I mean, not so. My, my expectation is that if you're not coming in person, those people will, will watch the, uh, the video recording.

34
00:04:38,740 --> 00:04:42,670
But it doesn't. I checked the who who watched the who didn't.

35
00:04:42,670 --> 00:04:46,660
And it looks like not everyone is watching them, which is kind of concerning.

36
00:04:47,350 --> 00:04:56,530
But yeah, if you can. Yeah. Because you guys probably have, you could have made, uh, not in this class if, you know,

37
00:04:56,590 --> 00:05:01,000
make sure that this message is delivered to everyone so that there is no confusion.

38
00:05:01,270 --> 00:05:03,700
Okay? Yeah. Yeah.

39
00:05:03,710 --> 00:05:12,830
But you're definitely every student is definitely expected to either come in, attend a class, or at least to watch the video recording.

40
00:05:12,830 --> 00:05:17,180
And I was quite surprised that how many people are not doing either.

41
00:05:17,860 --> 00:05:23,390
Okay. So, uh, yeah, so that that was one surprise.

42
00:05:23,420 --> 00:05:28,760
The other surprise I just wanted to mention is that I was, uh, grading.

43
00:05:30,200 --> 00:05:37,600
I mean, I didn't finish decorating that midterm project and I it'll take time to for us to grade all of them.

44
00:05:37,610 --> 00:05:50,330
It's a quite a quite a lot of problems and people, uh, but when I, uh, when I try to see some of them well.

45
00:05:51,210 --> 00:05:57,020
So I noticed some of both support the informal for and.

46
00:05:58,370 --> 00:06:11,899
Mid-term project, I noticed that there are people who are who look at me who are very obviously, you know, violating the honor code of conduct.

47
00:06:11,900 --> 00:06:18,680
And I was surprised because I thought that, you know, you know, we had a lesson to learn.

48
00:06:18,680 --> 00:06:26,049
And, you know, I, I emphasize about it multiple times, but then I observed that.

49
00:06:26,050 --> 00:06:29,240
So I need to go through the official process.

50
00:06:29,240 --> 00:06:41,960
But, you know, it's yeah, I, you know, first thing I want to say is that it's I really don't understand why people do that when I you know,

51
00:06:42,050 --> 00:06:51,080
and and it's it's really so the consequences will be really critical if you violate the code of conduct.

52
00:06:51,080 --> 00:06:58,910
So, you know, please never do that, like not just in this class, but in any of the any of the course is a very serious offense to the.

53
00:07:01,410 --> 00:07:08,270
To the, to to to the school and university and instructor and yeah.

54
00:07:08,370 --> 00:07:13,530
And second thing is that, you know, I observed those cases, but I was also, you know,

55
00:07:13,870 --> 00:07:20,130
I strongly believe that the most of the people who who who did the homework and midterm,

56
00:07:20,600 --> 00:07:24,290
you know, did did the, you know, finish the project independently.

57
00:07:24,300 --> 00:07:33,900
So in a in the homework as well. So that that is a I think that I'm very proud of those students and that those are you know,

58
00:07:33,930 --> 00:07:40,020
I understand that those are really hard work and it could yeah, you could be tempted by,

59
00:07:40,200 --> 00:07:44,339
you know, you know, take taking a shortcut that is not allowed.

60
00:07:44,340 --> 00:07:53,430
But I, I appreciate that most of the student didn't do that and try to solve that problem as much as you can independently.

61
00:07:53,430 --> 00:07:57,180
So that that is exactly what the.

62
00:07:58,860 --> 00:08:04,400
Uh. Yeah. Exam is the hallmark and exam is designed for.

63
00:08:04,440 --> 00:08:09,100
So. Yeah. So I just wanted to mention. Okay.

64
00:08:09,150 --> 00:08:14,000
Any any questions regarding final project or anything else?

65
00:08:15,310 --> 00:08:18,460
Before starting. Okay.

66
00:08:18,550 --> 00:08:23,180
If not. Uh, yeah. Let's, uh.

67
00:08:24,850 --> 00:08:27,930
Let let's continue the Mark Twain question.

68
00:08:27,940 --> 00:08:32,620
So we talked about the mark of hidden Markov model.

69
00:08:32,640 --> 00:08:36,470
It's been on an. Uh, weak.

70
00:08:36,720 --> 00:08:41,130
But basically this this was the example, Mark that we were talking about.

71
00:08:41,670 --> 00:08:47,250
And you have heat in state, which is big pressure, high and low.

72
00:08:47,550 --> 00:08:51,410
And here is a sunny, cloudy, rainy is what you observe here.

73
00:08:52,110 --> 00:09:06,929
Okay. So then, uh, the question we wanted to answer is that, oh, if the observation was so, you know, I have five days, uh, weather observations.

74
00:09:06,930 --> 00:09:11,070
Sunny, sunny, cloudy, rainy, rainy from day 135.

75
00:09:11,640 --> 00:09:14,700
And what is the distribution of the hidden state on each day?

76
00:09:14,700 --> 00:09:18,859
Or you can say, Oh, what is, what is? You know, what was that?

77
00:09:18,860 --> 00:09:24,000
The most big spending pressure in day three? You can ask that question, too.

78
00:09:24,720 --> 00:09:29,190
So how do I answer those questions?

79
00:09:29,190 --> 00:09:40,139
So basically what what you are trying to ask is that you want to estimate the probability of the hidden state in the particular date,

80
00:09:40,140 --> 00:09:44,730
particular time, given all the observations and specific parameters you have.

81
00:09:45,090 --> 00:09:45,330
Okay.

82
00:09:46,520 --> 00:10:00,470
So the calculation, basically, if you wanted to calculate this value, if you wanted to calculate this value, you are supposed to calculate this value.

83
00:10:01,550 --> 00:10:10,990
So which means basically you need to you need to calculate this value with actually, you know, jointly with some with a with the sum of the cookie.

84
00:10:11,000 --> 00:10:20,210
But once you when you calculate this value, this value calculation is not trivial because.

85
00:10:23,530 --> 00:10:28,390
Were calculated, these value basically in a brute force way.

86
00:10:28,780 --> 00:10:37,960
You need to go through all possible combinations of a hidden state, which is exponentially growing with the number of observations.

87
00:10:38,620 --> 00:10:45,520
So in this case, there are two state, two hidden states, so two to the T or whatever the number of observation is.

88
00:10:45,610 --> 00:10:59,840
So you need to, uh, you need to marginalize across all the hidden states and calculate the proper value to, to calculate this observation.

89
00:10:59,860 --> 00:11:06,100
Basically, what it what it is is that. You four for each of the state.

90
00:11:06,310 --> 00:11:12,160
You're trying to look at the well, look at look at the probably the first state and.

91
00:11:13,410 --> 00:11:19,860
Uh. And so this is this is a prior for the Q once.

92
00:11:19,860 --> 00:11:26,690
So first for whatever whatever combination of states you have there, there should be the state for the first first state.

93
00:11:27,500 --> 00:11:36,350
So first they state you have a priors and you have emission probability for the first day and from second there you keep multiplying

94
00:11:36,590 --> 00:11:46,219
the what is the transition probability to move to that particular state and multiply the emission probably then keep doing it.

95
00:11:46,220 --> 00:11:52,880
And the well, this part is not that hard, but what the hard part is a you need to calculate all the,

96
00:11:53,150 --> 00:11:57,530
all the possible combinations of the states and the, you know,

97
00:11:57,620 --> 00:12:04,949
marginalize over so that that is painstaking and that could be easily competition

98
00:12:04,950 --> 00:12:09,409
intractable if you are dealing with a large number of starvation in this case,

99
00:12:09,410 --> 00:12:13,969
you need to modernize over 32 different observations.

100
00:12:13,970 --> 00:12:19,850
But in general, if you have 100 different observation, then it's not possible to calculate.

101
00:12:22,470 --> 00:12:27,100
So. Okay. So.

102
00:12:28,820 --> 00:12:37,190
So here so and the the algorithm we are going to run is, is a quota for the backward algorithm.

103
00:12:37,430 --> 00:12:49,249
Okay. So for the backward argument is an algorithm that allows this computation in polynomial time rather than exponential time.

104
00:12:49,250 --> 00:12:53,990
So to do that, we need to define something here.

105
00:12:55,010 --> 00:12:58,580
So. So we're going to.

106
00:13:04,970 --> 00:13:08,750
We're going to talk about queue of T minus one.

107
00:13:10,370 --> 00:13:15,290
So t minus one. Q over tea.

108
00:13:24,290 --> 00:13:33,890
And to keep plus one. And each of them has their own observation at this time.

109
00:13:46,270 --> 00:13:49,780
Okay. Oh, well.

110
00:13:50,500 --> 00:13:55,630
So. So there is a thought that these are all connected.

111
00:13:57,370 --> 00:14:10,540
And. What we want to calculate is the is the probability or should be given of all the observations.

112
00:14:12,400 --> 00:14:16,130
And and a number right. To.

113
00:14:16,690 --> 00:14:22,389
So calculating. This is basically same as calculating disjoint probabilities.

114
00:14:22,390 --> 00:14:27,400
So instead of conditioning on conditioning by. Oh, you can see just how.

115
00:14:28,820 --> 00:14:34,010
I'm going to hike. I'm going to populate this joint the probability.

116
00:14:34,790 --> 00:14:40,759
And if as soon as you divide them by the joint, probably across to all,

117
00:14:40,760 --> 00:14:47,330
all possible other states of the Q, you can calculate this conditional probability.

118
00:14:49,180 --> 00:14:51,090
So. And.

119
00:14:52,610 --> 00:15:02,660
So so basically we're going to we're going to focus on how to calculate this part because the upper the numerator and denominator has the same form.

120
00:15:02,870 --> 00:15:06,780
Okay. So numerator.

121
00:15:07,200 --> 00:15:10,229
Oh. Okay. So all observation.

122
00:15:10,230 --> 00:15:13,770
We are going to just separate them into three parts. Okay.

123
00:15:14,190 --> 00:15:19,890
So, uh. We are going to separate them into.

124
00:15:30,770 --> 00:15:39,200
This part will. This part of the planet.

125
00:15:40,520 --> 00:15:43,820
And this part. In this part.

126
00:15:44,190 --> 00:15:50,450
Okay. So this is the bowtie. We're going to say this is a T minus and this is a T plus.

127
00:15:50,730 --> 00:16:01,190
Okay. So that's how we define. And the nice thing here is that when you when when you so when you conditioned on the cure.

128
00:16:01,190 --> 00:16:05,270
PD Because this is disconnected and based on the difficulty.

129
00:16:07,460 --> 00:16:11,870
So. Yeah, so, uh, based.

130
00:16:14,590 --> 00:16:17,690
Based on the, you know, the.

131
00:16:19,490 --> 00:16:27,880
The critical network we had. Uh, we had to learn in the beginning.

132
00:16:28,570 --> 00:16:36,490
We basically, we, we have this relationship that if you because there's a no, no direct connection, it would be between them.

133
00:16:37,750 --> 00:16:41,950
Even just the condition of the cure.

134
00:16:42,010 --> 00:16:47,050
He did things to get all of all these three things becomes independent.

135
00:16:47,260 --> 00:16:54,510
So the key question here is that this probability becomes conditionally independent.

136
00:16:54,520 --> 00:17:00,490
So you can write it this way. If you are if you can't.

137
00:17:00,820 --> 00:17:05,230
So if you you know, if you take this.

138
00:17:05,280 --> 00:17:17,680
So. So basically, this is a basically probability of, you know, all of given to Q T lambda and probably computing, right?

139
00:17:18,430 --> 00:17:30,670
So once you once you do this, this is a probability of all T minus O or t plus given to a T and lambda.

140
00:17:30,910 --> 00:17:41,180
Maybe I shouldn't be using this color. It's. So in the these three things, all of them are independent.

141
00:17:41,450 --> 00:17:45,140
If these are conditioned on the on the Q.T.

142
00:17:45,680 --> 00:17:50,450
So that's that's why this. That's why it's education.

143
00:17:51,300 --> 00:17:54,620
The second line is correct.

144
00:17:54,950 --> 00:18:00,380
Okay. So then. Well. So after having this.

145
00:18:00,410 --> 00:18:04,490
Well, actually, I don't need this many four pieces. I just need a two pieces.

146
00:18:04,500 --> 00:18:07,700
So what I want to do is that I'm going to separate hearing for me.

147
00:18:08,510 --> 00:18:16,160
So I want to separate the part that that involves the observation after the current point.

148
00:18:17,210 --> 00:18:20,450
And in the the part that involves the.

149
00:18:22,070 --> 00:18:30,110
The current or previous observations. So you can you can just merge this part into joint probability form in this way again.

150
00:18:31,390 --> 00:18:44,020
Okay. Then what I'm going to do is that I'm going to define this part as a beat up t o kuti and this part is a alpha t of Kuti.

151
00:18:44,260 --> 00:18:52,990
Okay, so our alpha t has, you know, for each of each of Kuti, there is a in this case there are two states.

152
00:18:53,140 --> 00:19:03,370
Sonny, how you alone? So each of the state half of t exist and each of the time after t just the same for the parent.

153
00:19:03,460 --> 00:19:06,560
You can define that we get. So.

154
00:19:09,100 --> 00:19:18,339
So one thing one encouraging thing here is that let's say we somehow know our fate and bait ante, which is not possible now.

155
00:19:18,340 --> 00:19:22,150
But if we know this well, this calculation is constant.

156
00:19:22,990 --> 00:19:29,020
So all this probably calculation is a constant divided by summation of the constant.

157
00:19:29,030 --> 00:19:32,260
So this can be calculated just in linear time.

158
00:19:32,530 --> 00:19:36,249
Okay. So that is that is an encouraging thing.

159
00:19:36,250 --> 00:19:43,030
So if you're figuring out how to calculate the alpha and beta without paying for the exponential computation problem,

160
00:19:43,660 --> 00:19:46,960
penalty is what we are trying to figure out.

161
00:19:48,790 --> 00:19:52,860
Can. So.

162
00:19:54,110 --> 00:20:01,189
So how do we do this? Okay, so now let's let's focus on the how we how we define that.

163
00:20:01,190 --> 00:20:02,900
These are brand data. Okay.

164
00:20:03,260 --> 00:20:13,300
There are multiple different ways to define or by meter to make it possible to, um, they could make it possible to build environment programmatically.

165
00:20:13,430 --> 00:20:19,200
But here we're just talking about a specific form here.

166
00:20:20,420 --> 00:20:27,300
So. So I'm phone is probability of.

167
00:20:28,860 --> 00:20:36,950
Oh. 0102 all the way to all of people.

168
00:20:38,200 --> 00:20:41,580
And. Eugene.

169
00:20:43,750 --> 00:20:48,820
Using the Q. Q key equals I given.

170
00:20:49,030 --> 00:20:54,490
Given. No, no. Okay. So this is this is the probability we're going to calculate.

171
00:20:56,050 --> 00:21:03,880
So here, whenever you have this kind of probability, you can always add a new random variable.

172
00:21:04,570 --> 00:21:09,940
It's a part of the joint is probably okay. Okay and.

173
00:21:11,440 --> 00:21:14,670
Sorry. And.

174
00:21:16,100 --> 00:21:26,930
She'll keep him. So in this case, t minus j quote I want equal j and kill with equal I in the number.

175
00:21:27,260 --> 00:21:35,020
Okay. And if you do this as well as with this J covers all the possible cases of these.

176
00:21:35,180 --> 00:21:50,420
Well, you can always do this, right? So probability of A is probability of A and B across all B in B, so you can actually mathematically so.

177
00:21:52,920 --> 00:21:58,670
Of all the puzzle, let's say just a small piece of the puzzle there will be then you can you can do this way.

178
00:21:58,680 --> 00:22:01,890
Right. So it's the same thing.

179
00:22:02,240 --> 00:22:10,790
Okay. So so one, once you have that, now you have this kind of graph.

180
00:22:10,820 --> 00:22:25,940
Now I have a Q minus T, one Q of t k and o t of t in all the previous observation and of 10t minus one t.

181
00:22:26,030 --> 00:22:30,319
Okay. So now previously I tried the condition on this.

182
00:22:30,320 --> 00:22:34,190
Now with let's think about conditioning, conditioning days.

183
00:22:34,730 --> 00:22:47,450
Then you can also have a separation. So here the key part is that you can actually separate this out by taking the Q of T minus one equal j first.

184
00:22:48,490 --> 00:22:52,780
If you take this first. Then everything else.

185
00:22:53,090 --> 00:22:57,970
Okay, so. So you can separate this part in this part.

186
00:22:58,000 --> 00:23:07,930
So basically what you can do is probability of all one through all the way to all t minus one given to t minus one and theta.

187
00:23:08,380 --> 00:23:19,360
So lambda. And I'm just multiplying here and here you have old T and chu t equals I.

188
00:23:19,930 --> 00:23:27,710
This part can be separated, right? So.

189
00:23:29,320 --> 00:23:33,930
Then this part can also be written as a probability of a q of.

190
00:23:34,000 --> 00:23:40,840
He calls I outside. I forgot to include them.

191
00:23:41,460 --> 00:23:50,940
So because of you, you take the cookie minus one equal j you have the condition on in order for each of the case equal g.

192
00:23:53,180 --> 00:24:02,390
So then you can also separate this part with because a few key things are directly connected.

193
00:24:02,630 --> 00:24:13,790
Well, you can do it here is that oh, I'm going to say cubed t equals I given the q t minus one equal j given lambda and after that.

194
00:24:14,000 --> 00:24:24,230
So you can decompose this as a product this way the probability of of a T given to a T because I given lambda.

195
00:24:24,530 --> 00:24:36,200
So in this case, the reason why Cube came out as one equal j is is gone is because of all t is only only the only independent of this.

196
00:24:36,200 --> 00:24:40,490
So if your condition of this condition your this doesn't doesn't matter.

197
00:24:40,640 --> 00:24:50,120
So you don't have the condition of this. So so you have, uh, you have these two equations.

198
00:24:51,290 --> 00:24:56,970
So that's how, uh, how this part is working.

199
00:24:57,410 --> 00:25:01,969
So the, this part, you can write it again.

200
00:25:01,970 --> 00:25:14,540
You can combine it again as a probability of all, one through all t minus one and two times equal to my could a given amendment right.

201
00:25:14,540 --> 00:25:20,360
So you can you can combine this way and you have three different part like this, okay?

202
00:25:20,930 --> 00:25:27,770
Which are a little tricky to treat, tricky to prove that this is coming from here to here.

203
00:25:28,550 --> 00:25:30,850
But this this all works out. You can.

204
00:25:32,160 --> 00:25:42,690
So then interesting part is that, oh, if you look at this, this is actually almost a similar form with the original RFA.

205
00:25:44,370 --> 00:25:50,429
Except that except that instead of using T now I'm using t minus one.

206
00:25:50,430 --> 00:26:00,090
I reduced the one over observation and instead of looking to equal I, I'm now looking at two minus one equal g.

207
00:26:00,210 --> 00:26:10,350
So this, this will be written as an iPhone T minus one J And if we if we write that definition up, if we follow the definition of T.

208
00:26:13,020 --> 00:26:23,700
Function. Okay. And this probability, this probability, if you look at it, this is a transition probability.

209
00:26:24,060 --> 00:26:28,350
Okay. Transition probability from T minus one to T.

210
00:26:28,560 --> 00:26:33,270
Okay. So this is a transition probability.

211
00:26:33,280 --> 00:26:38,900
So this is a. Well. Uh, Christian poetry said.

212
00:26:39,520 --> 00:26:42,920
So a of it. Right.

213
00:26:42,970 --> 00:26:51,170
This is a this is a of probability. Right. And this is the this is the emission probability.

214
00:26:51,190 --> 00:27:02,350
So emission probably when the current status is ah, what is the probability observed over t so this is defined as a p of I.

215
00:27:04,990 --> 00:27:15,070
All right. Okay. So you can write this down in terms of all known known content.

216
00:27:15,330 --> 00:27:23,379
Okay. So the the the important part is there are 40 or 40 of I can be just written

217
00:27:23,380 --> 00:27:31,720
as a linear combination of the of the physical function of t minus one of.

218
00:27:32,520 --> 00:27:33,510
As Jamie.

219
00:27:36,330 --> 00:27:47,489
So an initial condition I found one is basically you can calculate this size or just in this case just one observations of one cup of tea to equalize.

220
00:27:47,490 --> 00:27:56,970
So this is a probability of the first state and you multiply the image and probability and that's what you're going to get for the initial,

221
00:27:57,000 --> 00:28:01,200
initial value. So you have a recursive formula, you have a terminal condition.

222
00:28:01,770 --> 00:28:04,830
So you can write this as a sort of a recursive formula.

223
00:28:07,130 --> 00:28:13,870
Okay. Any questioning in this formula.

224
00:28:19,850 --> 00:28:28,370
So. So this is a I think this is a good exercise for you to.

225
00:28:30,300 --> 00:28:34,300
To. You know, practice your.

226
00:28:35,380 --> 00:28:41,920
You know this. You know, I think the one skill basically, I think and this is very practical, useful.

227
00:28:41,920 --> 00:28:51,160
But one thing, you know, to to get into this kind of derivation, you always need to picture this network,

228
00:28:51,730 --> 00:28:56,290
the graph, how the how each of the variable depends on each other.

229
00:28:56,800 --> 00:29:05,290
And I try to use the independence to decompose certain joint probability into, into individual pieces.

230
00:29:05,530 --> 00:29:15,000
So that's the part that will be tricky. Well, all of you raise this, but if you want to take a picture, just feel free to do so.

231
00:29:16,950 --> 00:29:23,040
Okay. So.

232
00:29:25,110 --> 00:29:29,010
So we have a similar equation.

233
00:29:29,610 --> 00:29:32,750
We can we can do for the backward probabilities.

234
00:29:33,660 --> 00:29:42,070
Okay. So. In the form of the probability we are basically.

235
00:29:44,180 --> 00:29:55,290
For the probability. What we want to do is. So we want to we want to calculate the probability of all.

236
00:29:57,030 --> 00:30:00,880
He. Well on.

237
00:30:02,910 --> 00:30:07,850
For T-minus and all key and cute.

238
00:30:07,890 --> 00:30:12,060
She even went up to be able to do that.

239
00:30:12,150 --> 00:30:19,559
So when you look at the disjoint probability, what we are doing is that we are introducing another random variable, another.

240
00:30:19,560 --> 00:30:26,340
When it is 82 minus three one, we are conditioning of this to separate this park.

241
00:30:26,940 --> 00:30:35,800
We're separating these two. So that was the key idea. Now from Bangalore the probability.

242
00:30:36,250 --> 00:30:39,320
So this is our ability to generate to our.

243
00:30:41,140 --> 00:30:46,480
Q. I'll keep shipping.

244
00:30:49,250 --> 00:30:57,140
You're right. I think P2P is defined as probability of.

245
00:31:01,550 --> 00:31:12,740
40 plus. Or key plus even fewer team goals.

246
00:31:13,820 --> 00:31:17,660
I think this is how it's defined. Okay.

247
00:31:18,560 --> 00:31:26,800
But you can define this way also as a probability of of P plus one.

248
00:31:26,810 --> 00:31:35,660
So this means that all the observation after time T So this is a from T plus one, T plus two and so on.

249
00:31:36,320 --> 00:31:47,130
So you can write this as a team, plus the one I will keep plus one plus, which means that this is basically 40 plus two, 40 plus three and so on.

250
00:31:47,150 --> 00:31:51,590
Right on until until the last observation.

251
00:31:52,000 --> 00:31:57,200
Okay. And so this is what they is the same thing, right?

252
00:31:58,040 --> 00:32:01,339
And here we're going to do the basically the same thing.

253
00:32:01,340 --> 00:32:13,430
So we're going to introduce another random wave of two plus one and then make a summation, including plus simple as one can separate these two part.

254
00:32:13,670 --> 00:32:21,620
Okay. So if you have a T plus one, this particular observation and all the rest of observation can be independent.

255
00:32:21,620 --> 00:32:29,510
So that's the best. That's the part we're going to use for the back or the probability notation.

256
00:32:30,110 --> 00:32:35,960
Okay. So here Beta Pi is written in this way.

257
00:32:36,230 --> 00:32:41,340
Okay. And this is a condition that key.

258
00:32:41,440 --> 00:32:50,890
Right. We are adding a new variable to keep plus one and make make a summation that there should be nothing that should change.

259
00:32:52,120 --> 00:33:02,050
And then what we have is that once once you make this as a so now this part, I'm separating this part first.

260
00:33:02,530 --> 00:33:09,100
Okay? Because that's that's how you can make is everything conditioned on the key plus one.

261
00:33:09,940 --> 00:33:16,630
So once you take this out like this, then Q 250 plus one can be conditioned each of them,

262
00:33:17,080 --> 00:33:24,640
then these are two of the ratio is one and this one can be modeled independently like this.

263
00:33:24,880 --> 00:33:27,430
Okay, then what do you have?

264
00:33:27,880 --> 00:33:40,000
Okay, you have this part is is basically it is this part is still theta of T plus one of g and this part is a transition probability.

265
00:33:40,090 --> 00:33:46,640
So A of it. Right. And this part is emission probability, right?

266
00:33:46,750 --> 00:33:57,130
So given, given the given, given the state of Q Uh, you know that this part, okay,

267
00:33:57,190 --> 00:34:05,650
there was a typo that this has to be cubic plus, this has to be so sorry for the people.

268
00:34:06,370 --> 00:34:17,949
This is one has to be of t plus one given to keep plus one equal j not right.

269
00:34:17,950 --> 00:34:22,570
So sorry about that. So this has to be equal to j.

270
00:34:22,600 --> 00:34:30,909
So this part is basically B of because the state is j p of j and of t plus one.

271
00:34:30,910 --> 00:34:34,959
So this one is equivalent to to this and sorry for that.

272
00:34:34,960 --> 00:34:39,220
This part should have equal g after the.

273
00:34:42,040 --> 00:34:55,780
Okay. So so this this is a now it's a backward probability because you need to start from the time a capital T the end the at the end and go backward.

274
00:34:56,290 --> 00:35:00,639
In this case, if you have T equal kept a T,

275
00:35:00,640 --> 00:35:09,070
there's no observations that actually you need to use a null observation given certain state, which means the probability is just one.

276
00:35:09,070 --> 00:35:17,520
So probability is one. Okay.

277
00:35:17,610 --> 00:35:21,300
So now you have this RFI in beta, both of them.

278
00:35:21,990 --> 00:35:32,610
And what did we say? If you have this RFI beat up can be if you can can get this calculated, then you can calculate its value in linear time.

279
00:35:32,700 --> 00:35:34,890
That's what you are going to do at the end.

280
00:35:34,920 --> 00:35:43,950
So what I need to calculate is this value of Kiev to equal I given all the observations and you can calculate this.

281
00:35:44,160 --> 00:35:51,570
Okay. So this calculator's self calculation itself is linear time.

282
00:35:52,660 --> 00:35:59,170
What is the what is the problem? What is the complexity to calculate this individual summation?

283
00:35:59,830 --> 00:36:08,290
Individual summation you can calculate this individual summation is order and linear time, but you need to do this for each of the states separately.

284
00:36:08,290 --> 00:36:14,410
Right? So for the first state to use, you do the summation for the second state, you do the summation and so on.

285
00:36:14,920 --> 00:36:19,510
So this is the end the the quadratic time for each of them.

286
00:36:19,720 --> 00:36:29,680
Okay. And so the total time complexities and squared times t because a you need to do this for all the all the time t.

287
00:36:33,940 --> 00:36:37,659
Okay. So this is the end of the fourth week.

288
00:36:37,660 --> 00:36:42,160
What I'm going to. Any questions?

289
00:36:44,190 --> 00:36:49,120
So it's a little hard to follow. But if especially if you're looking at the situation first time.

290
00:36:49,120 --> 00:36:55,210
But this is a very good. Example of using the graphical network.

291
00:36:55,220 --> 00:36:59,710
So I encourage you to do that.

292
00:37:02,040 --> 00:37:07,970
Okay. So, uh.

293
00:37:10,470 --> 00:37:17,550
So let's move on to the next problem, which is a finding the most likely trajectory of a hidden space.

294
00:37:17,790 --> 00:37:23,080
Okay. So let's say we have a series of observations.

295
00:37:23,230 --> 00:37:33,120
Okay. So series of observations in this case and previously in these cases, I have these observations.

296
00:37:33,210 --> 00:37:35,230
So it's sunny, sunny, cloudy, rainy, rainy.

297
00:37:35,920 --> 00:37:45,399
Instead of saying that I'm I want to understand the particular hidden variable, can I say, oh, what is the most likely trajectory?

298
00:37:45,400 --> 00:37:51,820
What is the most like? What what is the best guess of the atmospheric pressure in each day?

299
00:37:52,280 --> 00:37:59,230
Okay. So they want with a five. So can you do that. Okay, so what, what among all possible.

300
00:38:00,940 --> 00:38:05,769
So you, you can, you have a exponentially many possibility of this.

301
00:38:05,770 --> 00:38:15,459
Q Right. And among these all plausible combination within states, what's the best state that gives the maximum probability?

302
00:38:15,460 --> 00:38:19,030
So this is kind of maximum likely estimation of this hidden state.

303
00:38:20,080 --> 00:38:24,910
Okay. So. And then how do we do it?

304
00:38:25,180 --> 00:38:34,270
Okay. So this is an interesting problem that has a connection with the military's problem.

305
00:38:34,450 --> 00:38:37,510
So we're going to make a connection with that. Okay.

306
00:38:37,600 --> 00:38:39,730
This is called arbitrary algorithm. Okay.

307
00:38:40,780 --> 00:38:49,620
So what we are what we can do, basically, is that, oh, you know, I need to calculate this maximum probability.

308
00:38:49,640 --> 00:38:58,150
So let's say, you know, let's calculate this as let's quantify this of of delta, of T,

309
00:38:58,150 --> 00:39:09,100
of AI and let's use dynamic programing language M to find this most likely path without paying for the exponential calculation penalty.

310
00:39:09,710 --> 00:39:15,550
Okay. So. So how do we do it?

311
00:39:15,680 --> 00:39:20,740
Okay. So, well, this is called B2B identifies the most likely path.

312
00:39:22,420 --> 00:39:26,650
So initialize states the first cost.

313
00:39:26,830 --> 00:39:30,100
And after that we are using some recursive formula.

314
00:39:30,390 --> 00:39:34,930
Okay. So we will use this information.

315
00:39:35,100 --> 00:39:38,309
So I'll get get into this. Why?

316
00:39:38,310 --> 00:39:45,130
Why do we have this? And we're going to also keep the keep the best choice.

317
00:39:45,480 --> 00:39:52,270
Okay. So among among all these. So this is just getting the maximum.

318
00:39:52,870 --> 00:39:56,760
And this is a which which actually pat resulted the maximum.

319
00:39:56,770 --> 00:40:00,790
So it's very actually close to the minute and tourist problem.

320
00:40:01,220 --> 00:40:10,510
Okay. So and when we reach the at the end, we just we call you de and that that that's it.

321
00:40:10,720 --> 00:40:18,270
Okay. So, well, this looks a little bit abstract, so let's try to look at the example.

322
00:40:18,340 --> 00:40:21,850
So the very similar example, but slightly different here.

323
00:40:22,520 --> 00:40:25,660
Hidden state in this case is a rainy and sunny.

324
00:40:25,840 --> 00:40:31,930
By the way, this is a kind of standard way to represent some kind of Markov model.

325
00:40:31,930 --> 00:40:36,880
So you have your starting with it and you have a hidden state here and these observations.

326
00:40:36,890 --> 00:40:47,620
So in this case, observation is of observation is what what you do, you either walk on the day or shop or clean.

327
00:40:48,150 --> 00:40:52,510
Okay. And if it's a rainy day and sunny day, what you are doing is different.

328
00:40:52,510 --> 00:40:56,410
And I think it's pretty obvious what what this person will do.

329
00:40:58,050 --> 00:41:02,370
And but in this case, we are we are only observing the ocean.

330
00:41:02,770 --> 00:41:08,099
So so we are showing that we are only observing the behavior of this person.

331
00:41:08,100 --> 00:41:14,720
But we don't know the weather of this part that this particular person is experiencing.

332
00:41:15,270 --> 00:41:18,910
Then we can try to infer the weather, basically.

333
00:41:18,930 --> 00:41:27,150
What is the this person, you know, had a first the first four days they walked and the last they cleaned.

334
00:41:27,300 --> 00:41:34,560
And what is the the likely what what what what did the weather look like?

335
00:41:34,590 --> 00:41:41,550
What is the most likely combination of sequences of weathers that that that's the question.

336
00:41:41,750 --> 00:41:53,740
Okay. So. So I'm going to give up any sort of an intuitive way to connect this problem with the Manhattan tourist problem.

337
00:41:53,930 --> 00:41:57,040
Okay, so let's think about these three, just three days.

338
00:41:57,160 --> 00:42:04,660
Okay. And when you have these three days, let's say you have three days and observation work, workshop, clean.

339
00:42:04,870 --> 00:42:14,110
Okay, then. So let's say the first day this person logged, the second day this person shot, this third day this person has cleaned.

340
00:42:15,540 --> 00:42:30,440
And. What you can do is that, well, in the first day, you know, you have you can you can calculate the probability of being rainy and sunny.

341
00:42:30,500 --> 00:42:35,600
Right. A being what? The probability of being rainy. Rainy is a 60%.

342
00:42:35,600 --> 00:42:40,010
It's sunny is 40%. Right. 60% to 40, 40%.

343
00:42:40,670 --> 00:42:52,790
But first day this person walked. Right. So if if the first day was a rainy and probably so rainy and what is a probably the first day is rainy.

344
00:42:53,060 --> 00:43:04,190
And this person walked and the joint probability is basically probability of the rainy times, probable to walk, even rainy, which is a 10% here.

345
00:43:04,220 --> 00:43:09,290
So you have a 60% times 10%, which is 6% here.

346
00:43:10,580 --> 00:43:13,640
If it's a there is a 40% chance to be sunny.

347
00:43:14,150 --> 00:43:18,860
But the prob given given sunny, the probability is a 60%.

348
00:43:18,870 --> 00:43:23,810
So multiplying is a 24%. Okay. So that's that's where you start.

349
00:43:24,050 --> 00:43:27,920
Okay. And. So.

350
00:43:29,510 --> 00:43:33,100
Then the second day could be rainy or sunny, too.

351
00:43:33,420 --> 00:43:38,600
Thursday could be rainy or sunny too. Right? But we already know their behaviors, right?

352
00:43:38,900 --> 00:43:43,490
Shop second day. This person shop. Third day this person cleaned.

353
00:43:43,730 --> 00:43:47,690
Right. Then what you can do is that.

354
00:43:48,150 --> 00:43:52,100
Well, then. Because. Because these are only so.

355
00:43:52,100 --> 00:43:55,670
I already have the probability of these.

356
00:43:55,910 --> 00:44:03,530
These two, probably. What does this probability means? This probably is a maximum probability that.

357
00:44:05,290 --> 00:44:08,500
This person has rain at the.

358
00:44:08,530 --> 00:44:14,030
It rained and it rained in this particular day and.

359
00:44:17,260 --> 00:44:20,660
And this person walked in the first day. And this is the maximum.

360
00:44:21,160 --> 00:44:25,390
Well, this this is not really maximum because it's only one observation, but still maximum.

361
00:44:28,470 --> 00:44:33,150
Probability that the first day, Sunny, and this person has walked.

362
00:44:33,490 --> 00:44:37,440
Okay. And this one. Is that what you're trying to ask?

363
00:44:37,440 --> 00:44:43,830
What is the maximum probability? The second day is rainy and the first.

364
00:44:45,900 --> 00:44:49,560
4 seconds, 8 seconds. Second person is Rainey.

365
00:44:49,980 --> 00:44:55,770
3 seconds, Rainey. And it is person shot. Okay, then there's a two possible path here.

366
00:44:56,030 --> 00:45:01,410
Okay, you could. It could be Rainey, and the person could be shopping.

367
00:45:01,650 --> 00:45:05,150
Right. So then what is the probability? So here.

368
00:45:05,160 --> 00:45:15,060
Here. We need some confirmation. Okay. So your proposal passes here.

369
00:45:15,240 --> 00:45:22,010
Okay. So I have. So I know he's pretty sharp, didn't it?

370
00:45:22,840 --> 00:45:25,989
You know, let's let's assume that this date was rainy.

371
00:45:25,990 --> 00:45:30,730
I don't know what the what's actual weather is rain.

372
00:45:31,630 --> 00:45:35,290
But the previous day could have been rainy. Okay.

373
00:45:36,130 --> 00:45:42,340
Previously, could it be a sunny? Okay. I know that is probably 24%.

374
00:45:42,340 --> 00:45:50,980
This is a 6%, too. So to to get there, you need to what's the what's the price to pay for it?

375
00:45:51,250 --> 00:45:56,500
That is 70%. Okay, 70% probability.

376
00:45:56,800 --> 00:46:02,710
Okay. The rate since the if the previous day is rainy, it's a it's still rainy.

377
00:46:04,090 --> 00:46:07,540
And because this person shop there is a 40% of.

378
00:46:09,280 --> 00:46:21,249
So this is a transition probability and uh, emission, emission probability is a 40% probability because you assume that that date is rainy.

379
00:46:21,250 --> 00:46:24,910
There's a 40% of this person is shopping, right?

380
00:46:26,010 --> 00:46:31,920
So. And in this case, you have a transient probability of.

381
00:46:33,980 --> 00:46:38,870
Sunny. Sunny. So previous day, what is rainy about the next day?

382
00:46:38,900 --> 00:46:45,920
Sonny is a 30%. So there's 30% of probability and mission probabilities.

383
00:46:46,190 --> 00:46:51,980
Well, if it was Sonny, there's 30% chance that this person will kill the 30%.

384
00:46:53,090 --> 00:46:59,149
So basically what you're doing is that you either want imply 0.09 from here or

385
00:46:59,150 --> 00:47:06,410
you multiply 0.28 from here and trying to decide which pad is more likely.

386
00:47:07,390 --> 00:47:11,160
So it's a kind of similar to the Manhattan Forest problem. Okay.

387
00:47:11,700 --> 00:47:14,939
So you're truly treating the smallest cost.

388
00:47:14,940 --> 00:47:18,690
But in American Tourist, probably you you're adding the cost.

389
00:47:19,050 --> 00:47:22,530
In this case, you are actually multiplying the probability.

390
00:47:22,890 --> 00:47:27,300
Right. So in the low space, it's basically a like a just addition, basically.

391
00:47:29,070 --> 00:47:35,130
So and if you try to compare these two values, these values are slightly higher.

392
00:47:35,940 --> 00:47:40,349
Okay. You can to a point if you don't believe it.

393
00:47:40,350 --> 00:47:45,390
So. 2163.

394
00:47:45,630 --> 00:47:54,190
And this is. 0.188801881.

395
00:47:55,430 --> 00:47:58,860
You know, to think. One two, six three.

396
00:47:59,210 --> 00:48:05,150
So this is slightly higher. Because every day they do it wrong.

397
00:48:07,040 --> 00:48:10,700
Because it says a 0.03 A for what's happening.

398
00:48:13,020 --> 00:48:22,730
Uh. The the the the.

399
00:48:23,450 --> 00:48:26,750
Sorry about this. I oh, you know what?

400
00:48:28,510 --> 00:48:35,760
I may be wrong. Sorry about that. So actually, the the second day is rainy.

401
00:48:35,760 --> 00:48:40,680
So I it's a torrential poverty that 40%, 40%.

402
00:48:40,770 --> 00:48:49,860
The previous day was sunny and the next day it's raining. I'm sorry. Okay, so percentage of problem is 40% and emission properties 30%.

403
00:48:50,220 --> 00:48:58,860
So this is, you know, point. Emission, probably no emission, probably the still ranges of 30, 40%.

404
00:49:00,120 --> 00:49:09,120
Because of your your current date so your current the days rainy right still so it is still 40% so you know .16.

405
00:49:09,390 --> 00:49:14,600
Okay so you don't point. You don't have to be for something like this.

406
00:49:15,060 --> 00:49:19,350
Okay. So. Yeah.

407
00:49:19,420 --> 00:49:27,460
So. So you have. So this person is more likely if this state was raining, we can do the same thing here.

408
00:49:27,490 --> 00:49:36,100
If they. If they do a sunny day, then you can you can decide if this this path is more likely and this person is more likely.

409
00:49:36,100 --> 00:49:39,280
You can compare to. I think this person is more likely.

410
00:49:39,690 --> 00:49:47,590
You know, you can you can as you can compute is probably Timothy is prone to becomes this okay.

411
00:49:48,980 --> 00:49:53,960
And third date. So now you have a you have a problem with people.

412
00:49:54,050 --> 00:49:57,240
This problem is basically the problem is that.

413
00:49:58,130 --> 00:50:15,920
So this is the problem. This is the problem of who want equal study, who want to equal any and all, want equal or equal walk in order to equal share.

414
00:50:16,340 --> 00:50:19,550
So this is the problem we have. Right.

415
00:50:20,360 --> 00:50:24,019
And why? Why do we have. Why do we have this particular sequence?

416
00:50:24,020 --> 00:50:27,259
Because this particular sequence gives the maximum probability.

417
00:50:27,260 --> 00:50:36,830
So. So what you care about is that we want to have a second state to be rainy, and we want to collect the maximum probability to reach there.

418
00:50:37,040 --> 00:50:42,890
Okay. So do the same thing here. So rainy and sunny.

419
00:50:43,240 --> 00:50:49,820
Can you then it's a basically you will have a you want the territory to be a a state.

420
00:50:50,000 --> 00:50:57,770
You want to get three, two, one, two, two, two, three and two, three is basically raining and Q and kid,

421
00:50:57,770 --> 00:51:00,970
I don't care which state that gives the maximum probability, right.

422
00:51:01,580 --> 00:51:09,860
And all or two or three. So this, this is the probability you can good if you choose the maximum between these.

423
00:51:10,040 --> 00:51:21,530
Okay. So and this probability becomes 0.012, three, four, four and this probability becomes 0.0.

424
00:51:23,940 --> 00:51:33,660
0259. Okay. So this probability wins at the end so that this is the this is a best.

425
00:51:35,530 --> 00:51:38,760
This gives the maximum likelihood. So I want the background. Okay.

426
00:51:39,010 --> 00:51:42,820
So. Well, if you backtrack. First day was rainy.

427
00:51:43,510 --> 00:51:46,690
Sorry. Thursday was rainy. Second day was rainy.

428
00:51:46,690 --> 00:51:56,240
And first day was sunny. Okay. So that is the. That is the most likely path.

429
00:51:56,450 --> 00:52:04,520
So that difference from the Manhattan tourist problem, if you if you try to visualize the light graph, it is no longer like green.

430
00:52:04,610 --> 00:52:10,250
It's like very wide road with only 22 to 2 passes.

431
00:52:10,880 --> 00:52:17,360
And instead of having a specific addition cost, this is a multiplication cost.

432
00:52:17,900 --> 00:52:21,140
Multiplying smaller number gives a more penalty. Okay.

433
00:52:23,010 --> 00:52:27,930
So basically this is the visual illustration of that equation.

434
00:52:28,050 --> 00:52:34,320
You basically need to implement this into a similar, I would assume, and this is Diebold.

435
00:52:34,620 --> 00:52:41,970
Okay. So this is a very similar to the Manhattan tourist are to except that I'm taking the max.

436
00:52:42,150 --> 00:52:46,590
Okay. So there could be multiple different way.

437
00:52:46,770 --> 00:52:51,509
So in this case, there are only two. Two possible states previously.

438
00:52:51,510 --> 00:52:54,780
But there could be a ten different states. Whatever states it gives.

439
00:52:54,810 --> 00:53:01,440
I'm going to take a max of them. So that's. That's this delta towards this particular probability.

440
00:53:02,520 --> 00:53:07,400
Okay. And this fee of t just stores that.

441
00:53:07,410 --> 00:53:11,219
Oh. Which way was the optimal. Right. So which, which way?

442
00:53:11,220 --> 00:53:14,460
Gives the maximum probability so that I can backtrack.

443
00:53:15,640 --> 00:53:21,850
The path. Okay.

444
00:53:22,300 --> 00:53:30,490
So that's that. And let's try to now implement this algorithm and see whether whether it works or not.

445
00:53:32,080 --> 00:53:35,680
Okay. So we're going to use the class once more.

446
00:53:35,740 --> 00:53:43,360
You don't have to use the class, but this is a good way to to try.

447
00:53:43,390 --> 00:53:49,049
So let's see. Okay. So a good way to organize the information.

448
00:53:49,050 --> 00:53:54,300
So I said. Class name is H.M. 615.

449
00:53:54,570 --> 00:53:59,190
Okay. And we need to store a bunch of parameters.

450
00:53:59,190 --> 00:54:02,580
So number of states get number of observations.

451
00:54:02,700 --> 00:54:07,290
So the number of states is just how many states do you have?

452
00:54:07,530 --> 00:54:11,100
You could have two states, three states and so on for each of the time.

453
00:54:11,760 --> 00:54:15,659
Number of observations is basically the number of possible outcomes.

454
00:54:15,660 --> 00:54:24,360
So if it's a sunny and rainy, there's two states, but the observations are sharp and walk and, you know, clean.

455
00:54:24,360 --> 00:54:27,780
Those are three, three observations. So those are a number of possible outcomes.

456
00:54:28,470 --> 00:54:36,570
And end times are how many different times we we have an obvious is a vector is

457
00:54:36,570 --> 00:54:42,850
observe data and trends p is a matrix of trends a matrix a state by state and an

458
00:54:42,900 --> 00:54:49,110
image of matrix of state by number of possible observation matrix and IV beta is

459
00:54:49,110 --> 00:54:54,890
the matrix that we need to store to to calculate the for the backward probability.

460
00:54:55,620 --> 00:54:59,729
And again, Mars is just the multiplication between alpha and beta.

461
00:54:59,730 --> 00:55:05,940
So I would explain that Delta is the beta B probability that was defined here.

462
00:55:05,940 --> 00:55:12,330
So this delta is this value we're going to use for the calculating the beta you pass,

463
00:55:13,080 --> 00:55:23,969
and the phase is just the integer storing integer to store the information of the for the backtracking and pies is the initial probability.

464
00:55:23,970 --> 00:55:31,410
And this path is a bit of a path we're going to reconstruct from this delta in fees.

465
00:55:31,590 --> 00:55:34,940
Okay. So. So.

466
00:55:35,900 --> 00:55:42,060
So this this one has. This one is about four different cells.

467
00:55:42,290 --> 00:55:46,370
I'm going to explain. So the first one is just initialization.

468
00:55:46,970 --> 00:55:51,920
Second one is A for Darwinism. Third one is a backwards algorithm.

469
00:55:51,920 --> 00:55:59,540
And this one is just combining this forward and backward probabilities of this for the for the back with algorithm.

470
00:56:00,290 --> 00:56:04,850
And this is beta, the algorithm. So let me let me go through each of them.

471
00:56:05,150 --> 00:56:14,180
Okay. So when you initialize, it's basically I'm going to just you're going to be given transition matrix,

472
00:56:14,180 --> 00:56:17,940
the emission matrix and the initial probabilities and observe data.

473
00:56:17,950 --> 00:56:22,029
So this is a transition transfer matrix.

474
00:56:22,030 --> 00:56:25,179
You can get the number of states, number of rows.

475
00:56:25,180 --> 00:56:31,479
And I usually use this kind of thing to assert that, you know, the dimensions match stub,

476
00:56:31,480 --> 00:56:36,130
if not means that I'm going to stop it if this condition is not met.

477
00:56:37,730 --> 00:56:41,180
And the number of times is just the length of observed data.

478
00:56:41,630 --> 00:56:50,140
And you basically you're just storing the emission trends and emission matrix and observed data and the initial probability that say,

479
00:56:50,300 --> 00:56:59,860
okay, the for the probability, we're just going to use the formula we just had here.

480
00:56:59,870 --> 00:57:09,290
So it, it looks very simple, but it is actually quite simple at the end, although the mathematical representation looks a little tricky.

481
00:57:09,300 --> 00:57:17,570
So we're just trying to implement this. So if you think about this, this is just the matrix multiplication.

482
00:57:17,600 --> 00:57:26,390
So you can you can represent these operations by oh, I'm I'm going to multiply this in this matrix, right?

483
00:57:26,400 --> 00:57:37,970
So that's what exactly does. So you have a threat, you have a transient probability and a you sorry are so yet you have a.

484
00:57:40,130 --> 00:57:48,950
So what you're doing is that this is are emission problem that is always constant because of the P of I or t is all.

485
00:57:49,250 --> 00:57:55,969
So if it's a I always I this is this is this is just constant in this summation perspective.

486
00:57:55,970 --> 00:58:03,430
So this part is just, you know, you can multiply later and this part is basically matrix matrix multiplication.

487
00:58:03,440 --> 00:58:14,330
You can make it so matrix transient properties, you just multiply it and after the scale by the emission probability and this is, this is after.

488
00:58:14,510 --> 00:58:18,770
And the first element can be written in this way.

489
00:58:19,910 --> 00:58:26,630
So pretty much the same thing can happen for the fact that probably tobacco probably can be written written this way.

490
00:58:27,470 --> 00:58:33,140
The difference is that, well, in this case, this is not always constant because this is j and this is high.

491
00:58:33,620 --> 00:58:36,710
So I need to multiply beta and B first.

492
00:58:37,010 --> 00:58:51,020
Okay. So what I'm doing is and I'm multiplying beta and emission property first and multiplying the tension, probably the one matrix multiplication.

493
00:58:51,020 --> 00:58:55,010
And this is element. Why is multiplication happening here?

494
00:58:55,430 --> 00:59:02,790
Okay. So. So that's, uh, that's the backwards implementation.

495
00:59:02,790 --> 00:59:06,810
Back with Ivan. You can always, you know, implement these in the nested loop.

496
00:59:06,960 --> 00:59:12,450
This way is a slightly it's much faster actually than using the nested loop.

497
00:59:14,580 --> 00:59:18,320
So let me just. Notice.

498
00:59:25,720 --> 00:59:33,250
Okay. So. And for the back, what our wisdom is, it's a it's very simple.

499
00:59:33,610 --> 00:59:41,680
So you run for that wisdom. You run back with wisdom. After that, what what I want to do is just, you know, normalize these value.

500
00:59:41,830 --> 00:59:51,640
Right. Multiply value, calculate the multiplication A and be out by beta and divide them by alpha and beta here.

501
00:59:51,850 --> 00:59:56,830
So divide, divide by some summation of them. So gamma is a matrix.

502
00:59:56,950 --> 01:00:06,790
Okay, so you calculate the columns column sum and divide divided by each of divided by the column sum and that that's what you can do here.

503
01:00:06,910 --> 01:00:12,970
Okay. So do you think this is a good implementation or bad implementation?

504
01:00:14,260 --> 01:00:23,920
So it is part of what I would. Well, there are good aspects, but there are there are obviously bad aspects about this.

505
01:00:23,940 --> 01:00:32,130
Do you do you get. So if you try to use these are wisdom in real hidden Markov model problems.

506
01:00:32,520 --> 01:00:36,990
There are cases this doesn't work. Can you can you guess what what the what that is.

507
01:00:38,610 --> 01:00:42,540
What's wrong with this? The way we calculate the for them back with the problem.

508
01:00:57,340 --> 01:01:03,600
So let's say you have like. 10,000 states is a 10,000 number of time.

509
01:01:03,600 --> 01:01:07,740
It's 10,000. You keep calculating this. What, you think it's going to happen?

510
01:01:12,550 --> 01:01:16,690
This is a multiplying sum values that is less than one.

511
01:01:17,230 --> 01:01:21,880
You keep multiplying. Okay. Eventually this will go into the flow.

512
01:01:22,660 --> 01:01:31,390
Okay. So these are egotism has a rate. Can be only used in a specific case where you are you know that its own go on the flow.

513
01:01:32,260 --> 01:01:40,270
If you are worried about it, you need to calculate this using the log transformation.

514
01:01:40,270 --> 01:01:47,670
So we I am not doing this here, but better to a better way to implement this is using the log transformation.

515
01:01:47,680 --> 01:01:53,950
So if there is another homework, I could have asked you to modify this using the log transformation.

516
01:01:53,950 --> 01:01:57,490
But there is no additional homework which fortunately.

517
01:01:59,150 --> 01:02:02,450
Okay. So there's one thing I just wanted to mention.

518
01:02:02,810 --> 01:02:09,510
Okay. So. I just didn't do it because a transformation makes things a little harder to understand.

519
01:02:09,510 --> 01:02:13,290
It's not that I can. We cannot do it. Okay.

520
01:02:14,690 --> 01:02:19,280
So Peter, where I've written Peter verbatim is extremely similar to the minute and with.

521
01:02:19,400 --> 01:02:22,970
So you calculate the delta fees.

522
01:02:23,450 --> 01:02:32,480
Okay. And pad here. Okay. So and calculate the first delta using this same formula.

523
01:02:33,290 --> 01:02:35,260
And after that, the.

524
01:02:35,450 --> 01:02:45,020
I know this looks a little bit strange about what it does is basically we are trying to implement this article region just using the matrix operation.

525
01:02:45,030 --> 01:02:49,340
So we're trying to we're trying to get a max of this part, this probability.

526
01:02:50,000 --> 01:02:55,880
So what I'm doing here is that I'm expected expanding those deltas for the previous.

527
01:02:57,650 --> 01:03:00,320
Previous data is an NBA matrix. Okay.

528
01:03:00,950 --> 01:03:10,280
And multiply the trend transition probabilities and multiply multiply the emission probability just to calculate.

529
01:03:11,480 --> 01:03:15,710
Calculate this quantity at once as a matrix.

530
01:03:15,980 --> 01:03:19,610
So note that there is no it's not a matrix of multiplication.

531
01:03:19,610 --> 01:03:23,419
It's just a multiplication. Right? So element wise multiplication.

532
01:03:23,420 --> 01:03:35,540
So I'm a a. So this a matrix will just have a state by state calculation of all these quantities.

533
01:03:36,050 --> 01:03:43,850
And I'm going to calculate the maximum value for, for each of rows using this way.

534
01:03:44,390 --> 01:03:48,620
And I'm using the which that max to, to store the backtrack information.

535
01:03:48,860 --> 01:03:55,549
Okay. So this is a, you know, some some some skill, some computing skill to use.

536
01:03:55,550 --> 01:04:03,340
The fact that Factorization Operation will make the paintings faster rather than using using this double or triple loop.

537
01:04:03,350 --> 01:04:07,780
Is that good? And after that.

538
01:04:08,170 --> 01:04:11,379
So this is just the this is the B2B algorithm, actually.

539
01:04:11,380 --> 01:04:13,750
The rest of them are just the doing the backtracking.

540
01:04:13,750 --> 01:04:22,180
So what I'm doing is that, oh, I look at the all the problem with that last and figure out which one gives the maximum probability first.

541
01:04:22,480 --> 01:04:26,830
So I need to choose the which one gives that makes you a parameter.

542
01:04:27,190 --> 01:04:31,050
In this case, you don't have a single destination, you have a multiple,

543
01:04:31,510 --> 01:04:37,640
you have a multiple possible destination and figure out which destination gives the largest probability.

544
01:04:38,200 --> 01:04:46,540
And after that, you're backtracking from the from the end to start to figure out which one should be the the

545
01:04:46,540 --> 01:04:52,540
previous node that should reach to the optimal point because we already stored this information.

546
01:04:53,200 --> 01:05:02,010
So after seeing this, I think it'll be it'll be a great exercise if you have a time to implement it yourself.

547
01:05:02,040 --> 01:05:16,270
I, I understand you have very stringent time constraint, but when, when you have ever have to use the implement the your own hidden Markov model,

548
01:05:16,780 --> 01:05:23,100
trying to pick up the pick up this example and try to try to just remind yourself and

549
01:05:23,410 --> 01:05:29,230
implement this would be a great starting point to make your own hidden backup model later on.

550
01:05:31,210 --> 01:05:34,210
Okay, so we did the implementation.

551
01:05:34,220 --> 01:05:37,480
Well, okay, that's all good. But how do I use it?

552
01:05:37,480 --> 01:05:45,070
I know which problem am I going to use it? So let's try to set up a small example problem here.

553
01:05:46,180 --> 01:05:49,479
So the problem we are going to work on is okay Jan based coin.

554
01:05:49,480 --> 01:06:04,120
So we're just in case they were in the casino and where we are detective to figure out is this casino is uh, is a cheating or not in a specific way.

555
01:06:04,300 --> 01:06:12,840
So the way how we how to it is that, that they have a station that does, uh,

556
01:06:12,940 --> 01:06:21,040
doing the coin toss and it should give, you know, the equal probability of being head and tail.

557
01:06:21,190 --> 01:06:27,399
Right. So, but sometimes they can, you know, the, the coin has some, some device inside.

558
01:06:27,400 --> 01:06:34,720
So you can, you can have a very different probability of being an had if that device turns on.

559
01:06:35,500 --> 01:06:40,180
So, I mean, that's my that's our suspicion that the data they like this way.

560
01:06:40,300 --> 01:06:47,230
Okay. So they have two mode so hidden states that they have fair state in the biased state.

561
01:06:47,470 --> 01:06:56,770
Okay. And in the in the bear state, the emission probability is a 50 head and tail is a 50%, 50%.

562
01:06:57,370 --> 01:07:02,200
But in the biased mode, there's much more chance to have a head and tail.

563
01:07:02,380 --> 01:07:06,550
Okay. And there is a change in probability.

564
01:07:06,550 --> 01:07:15,640
We you know, we assume that we know that 90, 95% of cases is just the stays, the fair, you know, if it was fair.

565
01:07:15,640 --> 01:07:19,660
But there is a 5% chance that it could turn into the biased mode.

566
01:07:20,200 --> 01:07:26,780
And if it was in bias mode, then there's a 20% chance that it comes back to the firm.

567
01:07:27,070 --> 01:07:39,350
Okay, so and I have a series of coin tosses, I'm just trying to detect or estimate whether they have a time that there is a cheating happened or not.

568
01:07:39,790 --> 01:07:50,710
Okay. So question can be, oh, you know, given to coin toss observations, what is the probability of each state okay for each of the state?

569
01:07:51,190 --> 01:07:54,500
Is it is it fair or biased for each of the states?

570
01:07:54,550 --> 01:07:58,959
Because that's a marginal sort of a marginal conditional probabilities.

571
01:07:58,960 --> 01:08:08,290
So a conditional probability of each of those are states in a the other ways that, oh, I don't care about the the state for each of the time.

572
01:08:08,290 --> 01:08:15,470
I just wanted to know what's the best guess scenario of each of the states that appear to be paired.

573
01:08:15,580 --> 01:08:20,530
QUESTION So, so this is a for the this can be solved with the for the backward algorithm.

574
01:08:20,530 --> 01:08:25,810
This can be solved through the Bitcoin liquid. Okay. So that's the problem we're going to work on.

575
01:08:26,440 --> 01:08:33,149
Okay. So so we're going to setting up the problem.

576
01:08:33,150 --> 01:08:40,320
So here we have a transition matrix as shown in the lecture note.

577
01:08:41,460 --> 01:08:49,470
Here we have observation. So observation two means tail and one is had said, let me see.

578
01:08:50,790 --> 01:08:58,260
Uh. Actually no to in in this example.

579
01:08:58,280 --> 01:09:01,520
So I actually flipped this to. Okay. So.

580
01:09:02,490 --> 01:09:07,069
Well, uh. Well, I mean, you can't.

581
01:09:07,070 --> 01:09:15,070
You can say one. Which one is a head or a tail? But in this case, I'll just I'll just still say that one is head and two is tail.

582
01:09:15,080 --> 01:09:18,580
But there are cases that there's a lot of tails here.

583
01:09:18,600 --> 01:09:25,730
Right. So and when when there is a biased or so, I can probably show what, what this looks like.

584
01:09:26,510 --> 01:09:30,830
So, uh, well, actually, I cannot because.

585
01:09:31,120 --> 01:09:38,570
Because this is, this is this is what it is. All right, so, uh, but I can show the transition matrix at least.

586
01:09:38,780 --> 01:09:47,270
So there is a matrix that looks like this, and the emission matrix looks like this.

587
01:09:47,630 --> 01:09:52,510
Okay, so this. Okay.

588
01:09:53,830 --> 01:10:00,310
So there is a in the biased mode, there is a lot more chance that this is a two.

589
01:10:00,550 --> 01:10:06,129
Okay. So you can close it. You can cause a twist head or twist tail doesn't matter.

590
01:10:06,130 --> 01:10:13,300
But in this case, because you're a switch, it just make sure that you don't get confused.

591
01:10:14,640 --> 01:10:17,650
Uh, I should modify the election later.

592
01:10:17,980 --> 01:10:26,020
Okay. So. And what we can do here is this.

593
01:10:26,200 --> 01:10:32,320
Okay. So what I'm going to do is I'm going to run both for the back with our wisdom and B-to-B algorithm.

594
01:10:32,680 --> 01:10:39,910
Okay. After that, I'm going to just show them how how the output looks like.

595
01:10:40,270 --> 01:10:43,540
Okay. Here. Okay. So this is a vote for the back.

596
01:10:43,540 --> 01:10:47,350
What I what is in here of outcome from the vote for the back without words.

597
01:10:47,650 --> 01:10:54,340
Okay. So you have this probability, you know, that that has.

598
01:10:56,780 --> 01:11:00,580
So there's one and two. Right. So you have an A.

599
01:11:00,590 --> 01:11:05,870
This is observation. You have a two, one, two, one. Pretty much. That's pretty much, uh.

600
01:11:06,830 --> 01:11:11,540
Yeah, the pretty much even at some point, you have a lot of ques here.

601
01:11:11,690 --> 01:11:24,049
Right. So four from here. Right. So then a B2B algorithm says that, oh, this, the coin was unbiased or the one is a fair state,

602
01:11:24,050 --> 01:11:29,900
the rest of coin is unbiased from until here and it became biased here.

603
01:11:29,910 --> 01:11:38,960
So that's the maximum likelihood estimation. But for the backwards algorithm, say that, well, there is a there is a higher chance of being biased.

604
01:11:39,000 --> 01:11:43,550
We cannot say for sure for each of the case because attention, probabilities are pretty high.

605
01:11:44,600 --> 01:11:49,639
So you can you can change the number and see how it looks like.

606
01:11:49,640 --> 01:12:01,320
Well, why what? What happens if I make a tangent probability much smaller, like 0.05 and let's say 0.02 and point 90?

607
01:12:01,620 --> 01:12:05,300
Okay. And in a rerun the same way.

608
01:12:05,480 --> 01:12:10,100
Okay. So well then then what's going to happen?

609
01:12:11,180 --> 01:12:18,050
So in this case well, in this case, the maximum likely pass says, well, this is all biased.

610
01:12:18,590 --> 01:12:22,460
That's more likely because a transition happens very rarely.

611
01:12:23,060 --> 01:12:26,810
Okay. And now it it gives a much more higher chance.

612
01:12:27,050 --> 01:12:32,120
Higher the inference that this is all biased. Okay. And if you change this.

613
01:12:32,120 --> 01:12:37,760
Ah, well, what if I give a more, more of to 1 to 1, so on.

614
01:12:38,040 --> 01:12:52,909
Okay. So then this is the more likely to happen in the, in the fifth set fair the state then if you do this then now it says that,

615
01:12:52,910 --> 01:13:00,590
oh if you, if you have a two and a lot twos and ones, then it is, it has been a fair mode.

616
01:13:00,590 --> 01:13:04,340
At some point when you have a lot of twos, it's a likely bias.

617
01:13:04,430 --> 01:13:14,320
So it does it does it does give a reasonable inference at the end, but it's highly dependent on what the parameter setting was.

618
01:13:14,750 --> 01:13:20,510
Can. Okay.

619
01:13:22,830 --> 01:13:29,640
So, uh, that's all I have regarding these kids Marco model.

620
01:13:30,270 --> 01:13:38,069
But he, the Marco model is used in many different contexts in the genetics is very popular are wisdom that are

621
01:13:38,070 --> 01:13:47,070
that are that are very useful to model the how the inheritance works because a bit basically genetic.

622
01:13:47,760 --> 01:13:53,520
So genetic genetic in terms is actually is a mosaic type copy of the parental chromosomes.

623
01:13:53,520 --> 01:14:00,120
So it's a very natural way to use the hidden Markov model to model the genetic variation.

624
01:14:00,120 --> 01:14:05,250
So it's very useful. There are many other cases where they become very useful way,

625
01:14:05,670 --> 01:14:16,410
especially speech recognition and in other kind of sequential way to model the languages and and any other those kind of this,

626
01:14:16,530 --> 01:14:20,790
if you have a sequence of observations in them, is a great way to model.

627
01:14:22,410 --> 01:14:29,700
Okay, then let's move on to the last lecture, unless there's a question.

628
01:14:31,970 --> 01:14:37,250
Yeah. So this content is quite dense.

629
01:14:37,580 --> 01:14:41,720
Okay. On the 16 slice, I'm pretty sure that we can finish.

630
01:14:42,230 --> 01:14:51,470
It's a matter of how we can how how much we can understand that the core part of it.

631
01:14:52,580 --> 01:14:58,280
So how many of people how many here learned of heard about F of T?

632
01:14:59,030 --> 01:15:03,020
I don't know what that is. I'm not I'm not going to ask you whether you really know about it.

633
01:15:03,030 --> 01:15:06,080
But I at some point I heard about that 50.

634
01:15:07,820 --> 01:15:21,709
Okay. So some some people knew it. Okay. So F.T. is a really famous algorithm, although you may not have used it in in your actual research,

635
01:15:21,710 --> 01:15:25,670
but, you know, it's, it's it's it's used in everywhere.

636
01:15:25,670 --> 01:15:34,010
So and I think there are really good YouTube videos about empathy in explaining how this works,

637
01:15:34,010 --> 01:15:42,709
although so I'll, I'll probably give a reference to those YouTube videos in the, in the next lecture.

638
01:15:42,710 --> 01:15:51,650
Next lecture. But those two, those videos are made because their photos are so popular.

639
01:15:52,160 --> 01:15:55,940
Our algorithm and those that are that are useful in many different ways.

640
01:15:56,210 --> 01:16:02,900
Okay. So and it is related to a lot of the homework problem you have done.

641
01:16:03,080 --> 01:16:06,200
So that's the T that's a little bit of spoiler. Okay.

642
01:16:06,200 --> 01:16:11,420
And we have 4 minutes. So I'm going to just explain very basic of it.

643
01:16:11,630 --> 01:16:25,100
Okay. So basically what we can what we are trying to do is that you have a you know, we have a way to,

644
01:16:25,760 --> 01:16:33,770
you know, represent the polynomial using the coefficient representation which is this.

645
01:16:33,920 --> 01:16:38,090
Okay, so degree of n minus one polynomial, we can represent this way.

646
01:16:38,270 --> 01:16:46,940
Right. So we already know this and we, we talk about how to, you know, solve.

647
01:16:48,830 --> 01:16:59,899
So the equations using bendable matrix or some other other equations to solve equations once does you have coefficients, right.

648
01:16:59,900 --> 01:17:03,470
So that's, that's the problem we have done. Okay.

649
01:17:04,220 --> 01:17:06,910
And, but a lot of cases,

650
01:17:06,920 --> 01:17:14,870
what we care about is the multiplication of the polynomial you have to polynomial and you want to multiply these two polynomial.

651
01:17:15,140 --> 01:17:18,709
Okay. Well how hard that, that could be.

652
01:17:18,710 --> 01:17:21,830
So it is, it is pretty straightforward,

653
01:17:22,550 --> 01:17:30,560
but if you are thinking about a polynomial with thousands of degrees or tens of thousands of degrees, it can be very, very slow.

654
01:17:30,920 --> 01:17:36,139
Okay. So in a lot of cases, we are dealing with a polynomial.

655
01:17:36,140 --> 01:17:38,380
So in the clearest plain language we are,

656
01:17:38,390 --> 01:17:47,690
we were dealing with the polynomial at the time and there are many different cases you have to do the polynomial multiplication to.

657
01:17:47,750 --> 01:17:57,829
You need to calculate the polynomial multiplication to do to come up with a with a different representation.

658
01:17:57,830 --> 01:18:01,490
You input data and that that's what we are trying to do.

659
01:18:02,150 --> 01:18:11,500
So but here what, what this slide says is that just you can represent the polynomial as is just a list of the position,

660
01:18:11,660 --> 01:18:15,080
the vector coefficient and values. So you can do this. Right.

661
01:18:16,250 --> 01:18:20,090
So then how do you evaluate the polynomial?

662
01:18:20,090 --> 01:18:39,739
Well you can evaluate the polynomial using the end and square time complexity and you you can have so if you use the initial inefficient way.

663
01:18:39,740 --> 01:18:55,010
So if you just use this notation for calculating each of a term, you have a of j multiplied by j to the j to the power of j.

664
01:18:55,010 --> 01:19:01,820
So you net that you need to multiply x0j times and you multiply a of j.

665
01:19:02,270 --> 01:19:07,909
So it is because at the end this will be just multiplying and and different times,

666
01:19:07,910 --> 01:19:17,239
which are basically of the quadratic time complexity, but you don't have to do this.

667
01:19:17,240 --> 01:19:21,319
So this we already learned about this Horner's rule here.

668
01:19:21,320 --> 01:19:26,870
So you can reduce the number of operations if you use this kind of recursive

669
01:19:26,870 --> 01:19:33,940
formula to calculate the theta when this is actually numerically more stable too,

670
01:19:34,280 --> 01:19:41,090
then these are what can be implemented in in a linear time way.

671
01:19:41,420 --> 01:19:48,170
Okay. So and I'm not going to go into this slide,

672
01:19:48,170 --> 01:19:56,030
but basically we are going to talk about how we can calculate this multiplication

673
01:19:56,420 --> 01:20:03,380
between the two polynomial in a very efficient way without having to pay for the,

674
01:20:05,540 --> 01:20:14,570
you know, the, the quadratic time. And that's what we are going to do in the in Wednesday.

675
01:20:14,930 --> 01:20:18,200
Okay. Okay. Thank you for your attention.

676
01:20:18,200 --> 01:20:21,163
And let's see on Wednesday that that's the.

