1
00:00:03,100 --> 00:00:12,200
Happy Halloween, everybody. Let's just take a quick look at where we are in the course before we get to work.

2
00:00:14,290 --> 00:00:23,770
So we are here. So we are very close to finishing up our unit on modeling the survival data or sensor time to event data.

3
00:00:24,670 --> 00:00:28,210
And so we will get very far today. We may.

4
00:00:29,420 --> 00:00:36,080
Overlap a little bit next time with handout 14, but we'll get very far today.

5
00:00:37,450 --> 00:00:43,810
We have in terms of assignments homework for is due November 9th.

6
00:00:44,020 --> 00:00:55,599
And I just wanted to give you a heads up that I've posted homework five and it is not due for quite some time November 22nd.

7
00:00:55,600 --> 00:01:01,360
But if you want to get a jump on it, you're almost at the point now where you can really tackle it.

8
00:01:03,070 --> 00:01:12,820
And so, you know, if you want to leave for Thanksgiving break with a clean conscience, you know, go ahead and get working on that early.

9
00:01:17,230 --> 00:01:26,640
All right. And actually, let's just open this up very quickly just to see what's in there, because I do think that it'll help you.

10
00:01:27,740 --> 00:01:31,530
See where to focus since we're talking about some of this stuff today.

11
00:01:31,550 --> 00:01:35,150
So the data set comes from an end stage renal disease.

12
00:01:36,300 --> 00:01:41,640
And so the outcomes are time until death or sensory.

13
00:01:42,980 --> 00:01:50,480
And there's a censoring indicator for death. But there's also a time until graft failure, death or censoring,

14
00:01:50,480 --> 00:02:02,240
which is a bit of a combined endpoint with an indicator for that's one if the the end of follow up ended with either a graft failure or death.

15
00:02:03,420 --> 00:02:09,329
And then there's several risk factors here. And I'm going to this is basically this assignment is taking you through an analysis

16
00:02:09,330 --> 00:02:14,190
of this data that would lead up to a manuscript results kind of paragraph.

17
00:02:15,060 --> 00:02:23,520
The main variable of interest is this variable called S T, which is that the donor organ.

18
00:02:24,650 --> 00:02:28,460
Whether it meet expanded criteria, donor status or not.

19
00:02:28,580 --> 00:02:39,880
And so there's a little bit of background here about why this variables of interest and it's basically you know that.

20
00:02:41,110 --> 00:02:46,180
Because of the organ shortage for kidneys, for transplant, they wanted to explore.

21
00:02:47,350 --> 00:02:56,450
Whether an expansion of what would be considered OC organs to transplant would make a difference in bad outcomes or not.

22
00:02:56,470 --> 00:03:01,630
So they wanted to. They already had a criteria for what kidneys were good enough to transplant,

23
00:03:02,260 --> 00:03:08,480
but people were still dying and having bad events because they couldn't get a transplant.

24
00:03:08,980 --> 00:03:14,080
And so they wanted to see, well, if we broaden the criteria for what we deem an acceptable organ to transplant.

25
00:03:15,640 --> 00:03:26,500
Is this is this a good idea or a bad idea? So you'll be going through that for your homework and playing with the Cox proportional hazards model.

26
00:03:26,830 --> 00:03:29,830
And the first problem I think you'll be able to tackle.

27
00:03:31,290 --> 00:03:41,480
By the end of today, you may already be able to tackle it, but it's going through looking at univariate analysis for each predictor by itself.

28
00:03:41,880 --> 00:03:50,400
And I have some specific instructions for the reference group for binary and categorical risk factors should be the group that is zero.

29
00:03:50,400 --> 00:03:59,100
So that affects male diabetes and the co-morbid variable which has a zero.

30
00:03:59,100 --> 00:04:04,049
And in you're going to be looking at it both as a categorical variable and as an

31
00:04:04,050 --> 00:04:07,470
ordinal variable and making a choice of which one you want to go forward with.

32
00:04:09,060 --> 00:04:19,799
For age. I also have a condition that I want the hazard ratio to correspond to a ten year increase in age, not a one year increase in age.

33
00:04:19,800 --> 00:04:23,790
And so you'll have to figure out how to report the hazard ratio on that scale.

34
00:04:26,610 --> 00:04:28,350
Which is something that's quite easy to do.

35
00:04:28,380 --> 00:04:40,080
You can either do it with some kind of command within your program, or you can just divide age by ten and report the results from that variable.

36
00:04:40,230 --> 00:04:47,100
So there's different ways you can go that go about that. So after the univariate analysis.

37
00:04:48,330 --> 00:04:56,399
We're going to look at some proportional hazards assumptions with respect to the male variable.

38
00:04:56,400 --> 00:05:06,240
And part A, you can do this is looking at the log minus log survival plot and seeing if there's a constant distance apart between male and female.

39
00:05:07,140 --> 00:05:12,630
But parts B and on, we make it to that today.

40
00:05:12,780 --> 00:05:21,990
I'm not certain we'll finish it today. So it's going to be the handout 13 material that's covered there.

41
00:05:22,990 --> 00:05:27,810
And so we'll just sort of see how far we get.

42
00:05:27,820 --> 00:05:32,590
But I do think problem one you could tackle if you wanted to get ahead.

43
00:05:35,310 --> 00:05:38,730
Or you could wait because there's time. All right.

44
00:05:39,790 --> 00:05:46,809
So last time. We were in Handout 12 and we ended around 526.

45
00:05:46,810 --> 00:05:57,790
And so just a brief recap. This handout was looking at two different ways that you could adjust for categorical predictor.

46
00:05:58,710 --> 00:06:06,720
And one of the ways to adjust for a categorical predictor with these Cox models is to do what you've always done.

47
00:06:06,750 --> 00:06:15,210
Put the categorical predictor in the model statement. And and see how the parameters your interest in you know how they they change.

48
00:06:15,990 --> 00:06:20,250
But there was the new way that we talked about adjusting for categorical predictor.

49
00:06:20,250 --> 00:06:30,300
That hasn't been an option for you before. And that was to use that as a stratifying variable that you could actually put in a strata statement.

50
00:06:31,550 --> 00:06:35,060
Into your south or in or there's a way to do it, too.

51
00:06:35,600 --> 00:06:48,620
And it would estimate a separate survival baseline or hazard baseline curve for the different levels of the covariate on either of those ways.

52
00:06:48,830 --> 00:06:54,800
Last time we showed were a way to adjust for that covariate in interpreting your main effect.

53
00:06:55,250 --> 00:06:59,000
So we're going to have examples in this handout as well.

54
00:06:59,000 --> 00:07:03,950
But I just wanted to remind you there were those two different ways. I think we're going to be looking at site.

55
00:07:05,910 --> 00:07:08,280
In this particular data set and see, you know,

56
00:07:08,280 --> 00:07:13,530
if we just fought by putting site in the model or if we adjust for it by putting into the street a statement, what does it do?

57
00:07:16,110 --> 00:07:21,839
So the data set, we'd also just briefly introduced before we entered last time.

58
00:07:21,840 --> 00:07:25,950
So the outcome is time to drug use relapse.

59
00:07:26,730 --> 00:07:32,460
And it came from a randomized trial of two inpatient treatment courses for drug addiction.

60
00:07:33,240 --> 00:07:36,629
And so time to drug use relapse was the outcome.

61
00:07:36,630 --> 00:07:41,130
So shorter times are bad, you know, that means they started using drugs more quickly.

62
00:07:42,210 --> 00:07:44,880
There's the data has a censoring variable as well.

63
00:07:45,920 --> 00:07:56,090
And the randomization groups were either a short or long treatment plan and we want to know, you know, is one better than the other.

64
00:07:56,990 --> 00:08:02,450
And then there were other variables, age and years site and a few others that we want to focus on for now.

65
00:08:04,180 --> 00:08:12,940
And so the variables that we are focusing on in the data set are RL underscore days that that the X variable for us.

66
00:08:14,370 --> 00:08:20,040
The sensor variable, the delta variable is called sensor itself returned a drug used when it was.

67
00:08:20,040 --> 00:08:23,369
Yes. So that's the outcome that we're modeling.

68
00:08:23,370 --> 00:08:27,300
Again, the treatment group is long underscore treatment.

69
00:08:27,660 --> 00:08:35,400
So it's one of its long zero otherwise ages in years there's a verbal name and then there's two treatment sites just coded zero and one.

70
00:08:39,640 --> 00:08:44,920
And so just reading it into SAS and taking a quick look at the data, this is what the data looks like.

71
00:08:44,930 --> 00:08:48,370
This is the X variable, this is the delta variable.

72
00:08:49,360 --> 00:08:53,079
We're really interested in this long treatment variable and how it works.

73
00:08:53,080 --> 00:08:55,720
But we've got confounders. We've got age, we've got site.

74
00:08:58,000 --> 00:09:06,219
So the first thing we do with almost any situation is to plot the data and the big plot for a sense of survival date is the Kaplan-meier plot.

75
00:09:06,220 --> 00:09:13,090
That's the first plot we go to. It doesn't use any covert information other than what you put in the strata commands.

76
00:09:13,090 --> 00:09:16,110
So it's going to do one curve for every level of the strata.

77
00:09:16,690 --> 00:09:23,200
So here we have if we're doing strata with the treatment group, we have two treatment groups, long or short.

78
00:09:25,240 --> 00:09:31,899
And it looks like, you know, the long duration group is the group on top.

79
00:09:31,900 --> 00:09:40,540
So they actually have a. Looks like a slightly longer time to drug relapse based on this plot.

80
00:09:41,500 --> 00:09:44,440
Compared to the short duration crew, which is on the bottom.

81
00:09:45,310 --> 00:09:52,510
And one of the things I've kind of talked to you about is, you know, thinking about the the proportional hazards assumption.

82
00:09:52,510 --> 00:10:02,140
And one of the things I mentioned was if the curves touch again towards the end, you know, that might be a proportional hazards violation here.

83
00:10:02,710 --> 00:10:05,800
They're touching at the very end, but there's very little data.

84
00:10:06,760 --> 00:10:12,100
So it's it's sort of there's sort of a question of whether this is appropriate or not.

85
00:10:12,100 --> 00:10:16,600
But when the curves touch at the very end and there's very little data, it might be okay.

86
00:10:20,880 --> 00:10:27,060
Just because there's not a lot of statistical information out here to to corrupt the results.

87
00:10:28,630 --> 00:10:38,350
So this is the raw data plot with the KAPLAN-MEIER and here's comparable R code reading in the data,

88
00:10:39,130 --> 00:10:43,000
setting up the formula or the only cover it is lung underscore treatment.

89
00:10:44,410 --> 00:10:46,630
And then plotting the kaplan-meier.

90
00:10:47,260 --> 00:10:55,060
And, you know, these plots are kind of nice because you can choose line types that are different dashes for black and white.

91
00:10:55,270 --> 00:11:08,649
They've got like nice options here. So you can actually do plots based on the cap, the costs, proportional hazards model as well.

92
00:11:08,650 --> 00:11:17,320
We've done it before and the trick is to set up a little mini data set of the risk profiles you want to plot curves for.

93
00:11:18,010 --> 00:11:23,440
And so we're going to look at comparing treatment groups adjusting for age and output

94
00:11:23,440 --> 00:11:28,000
survival estimates for the My Career Risk Profiles and to a new dataset called Fit Val.

95
00:11:28,630 --> 00:11:35,080
So I if we're going to adjust for age, we're going to have both the treatment and the age in our Cox model.

96
00:11:36,310 --> 00:11:40,660
And if we want to print out survival curves, we have to pick an age now.

97
00:11:41,570 --> 00:11:44,060
And so I've just arbitrarily picked 32.

98
00:11:45,770 --> 00:11:54,080
So this little mini data set my career is has the same variables that you put in your model statement over here.

99
00:11:54,380 --> 00:12:00,410
Right. So that matches this. I for some, I don't even know why I switched the order, but that part doesn't matter.

100
00:12:01,480 --> 00:12:09,340
And I'm putting in for each row, I'm putting in a risk profile that I want to have plotted.

101
00:12:09,350 --> 00:12:20,319
So the first thing I want to print, the time to drag relapse curve for a 32 year old who's on the long treatment and the second row is thing.

102
00:12:20,320 --> 00:12:26,680
I want to plot a curve for the risk profile that corresponds to a 32 year old on the short duration treatment.

103
00:12:27,820 --> 00:12:36,639
And so I can put as many roads as I want here. They will all be saved into this fit val data set.

104
00:12:36,640 --> 00:12:42,000
And here's where the the my career data set shows up in drag.

105
00:12:42,340 --> 00:12:47,200
So here so just backing up a second, here is the drag at the data set.

106
00:12:48,040 --> 00:12:57,850
I'm not printing out all possible output with the no summary in the model statement is the x variable asterisk, the delta variable.

107
00:12:58,330 --> 00:13:03,750
And then inside the parentheses is what is the censoring number that was used.

108
00:13:03,760 --> 00:13:09,010
So we had it was a zero if they were lost to follow up or censored.

109
00:13:10,400 --> 00:13:16,070
And then here are the covariates. This is asking for hazard ratios and confidence intervals.

110
00:13:16,640 --> 00:13:21,830
And now this is where the action is if we want to plot the survival curve based on the Cox model assumptions.

111
00:13:21,830 --> 00:13:26,120
So we saved we're saving the data into fit Val and we're saying,

112
00:13:26,120 --> 00:13:33,650
I want to save all the survival data for those risk profiles that I put in this my career data set.

113
00:13:33,920 --> 00:13:36,080
And there's something comparable we can do in R.

114
00:13:37,700 --> 00:13:46,790
And I want a plausible, viable and I'm not even sure if we'll look at this log minus logs arrival, but we definitely want to look at survival.

115
00:13:48,990 --> 00:13:52,650
So here is some of the output from the Cox model.

116
00:13:53,190 --> 00:14:03,000
So here's the two covariates we put in, and it has the usual stuff like parameter estimate, standard error test statistic, p value.

117
00:14:03,420 --> 00:14:10,559
This is the P value column. And then because we put in risk limits, it'll give us the hazard ratio and the confidence interval for the hazard ratios.

118
00:14:10,560 --> 00:14:14,910
This hazard ratio is basically e to the parameter estimate.

119
00:14:16,020 --> 00:14:20,510
And the hazard ratio confidence limits are calculated for you. All right.

120
00:14:21,080 --> 00:14:29,780
And so just as a perk up moment for us, what did we learn about hazard ratios that were less than one?

121
00:14:29,790 --> 00:14:34,180
So this hazard ratio for treatment is 0.8. So what?

122
00:14:34,390 --> 00:14:39,130
What does that mean in terms of interpreting?

123
00:14:40,050 --> 00:14:46,700
Long versus short treatment duration and we're, you know, relapsing into drug use.

124
00:14:46,710 --> 00:14:53,670
What does this 0.8 mean? All right, I'll make it a yes.

125
00:14:53,670 --> 00:15:00,090
No question. So you can, like, give me the hands up or something along those lines.

126
00:15:00,090 --> 00:15:07,540
So I. Is long duration therapy.

127
00:15:09,320 --> 00:15:23,070
Good or bad. Compared to short duration therapy at prolonging time to starting up drug use so long as long treatment helpful in this scenario,

128
00:15:23,070 --> 00:15:29,160
a prolonged prolonging time to drug use. Okay, I've got a lot of nodding heads.

129
00:15:29,160 --> 00:15:33,180
That's correct. So when you see a hazard ratio that it's less than one.

130
00:15:34,450 --> 00:15:40,630
That means that the cover that is one unit higher is protective.

131
00:15:42,630 --> 00:15:48,720
For the outcome happening in so long treatment. We coated it as a one short treatment with zero.

132
00:15:48,720 --> 00:15:55,960
So when one unit increase. Would be comparing long treatment on the top versus short treatment on the bottom.

133
00:15:56,290 --> 00:15:59,950
And a hazard ratio less than one is protective for that event happening.

134
00:16:00,220 --> 00:16:05,580
And the event was time to drug relapse. The bad thing? All right.

135
00:16:05,580 --> 00:16:08,940
So long treatment helps prolong.

136
00:16:10,120 --> 00:16:13,540
Time to drug relapse compared to short treatment.

137
00:16:13,960 --> 00:16:17,650
So good job, guys. Now, here is the plot.

138
00:16:18,040 --> 00:16:20,290
That's assuming the proportional hazards assumption.

139
00:16:20,300 --> 00:16:27,160
So this is the based on the survival model for treatment groups adjusted for age, evaluated a 30, 32 year old.

140
00:16:28,120 --> 00:16:31,240
And so all I'm doing is taking that data set.

141
00:16:32,900 --> 00:16:36,620
And plotting it. And by my group.

142
00:16:37,220 --> 00:16:40,700
And so this is not exactly what the raw data looked like.

143
00:16:40,700 --> 00:16:46,040
Right? The raw data is sort of detached towards the end when there was very little data left.

144
00:16:47,480 --> 00:16:50,420
The direction is okay. The long duration was on top.

145
00:16:50,420 --> 00:16:56,660
The short duration was a bottom, but the proportional hazards assumption is sort of forced these estimates to be apart.

146
00:16:56,690 --> 00:16:59,870
So this is trying to obey proportional hazards.

147
00:16:59,870 --> 00:17:03,170
It's assuming proportional hazards and making these plots.

148
00:17:04,850 --> 00:17:08,059
And it's also both curves are going down in all the event time.

149
00:17:08,060 --> 00:17:14,750
So you don't really see the censoring. You know that the short duration group had so much censoring at the end.

150
00:17:19,120 --> 00:17:27,430
And here's the R code doing the same thing. So this is setting up the formula with the long treatment and age and there.

151
00:17:28,620 --> 00:17:36,000
And. Setting up getting the Cox proportional hazards output.

152
00:17:37,190 --> 00:17:41,150
Summarizing the results of the model and then the the curves.

153
00:17:41,840 --> 00:17:49,999
The trick for my career and ah is to kind of save the profiles in a matrix where the first row is the first profile,

154
00:17:50,000 --> 00:17:52,190
the second rows, the second profile.

155
00:17:52,190 --> 00:18:01,130
So that's the same this expand our grid is basically taking the the first column of zero and one for the long treatment.

156
00:18:01,990 --> 00:18:05,410
And it's just doing a ditto for the age.

157
00:18:05,410 --> 00:18:10,510
So the expand grade is just sort of making their age copy down to be a matrix.

158
00:18:10,510 --> 00:18:16,420
That's all that's doing. And they were plotting survival using those two risk profiles again.

159
00:18:16,430 --> 00:18:23,750
So it's very similar and this is kind of what it ends up looking like. And here is the output from Cox.

160
00:18:24,290 --> 00:18:28,520
So very, very similar output. The coefficients.

161
00:18:28,910 --> 00:18:33,800
This is the hazard ratio. You're the the p values over here.

162
00:18:34,610 --> 00:18:39,200
And again, they have the hazard ratio in the confidence limits for the hazard ratio over here.

163
00:18:39,590 --> 00:18:40,760
And if it's handy,

164
00:18:40,760 --> 00:18:47,089
they give you a one over the hazard ratio in case that's better for your manuscript and you can think about whether you want to use it.

165
00:18:47,090 --> 00:18:52,750
It just sort of shows that to you. Okay.

166
00:18:52,800 --> 00:18:56,820
So we need a little bit more practice. We're thinking about interactions.

167
00:18:58,380 --> 00:19:06,300
And so here is kind of just looking at an interaction between treatment and age.

168
00:19:06,300 --> 00:19:13,920
And so the research question here would be, you know, does the treatment work better depending on age or not?

169
00:19:14,220 --> 00:19:23,220
Right. So you could imagine maybe older people are so responsible and the treatment will work wonderfully better on them or may be the reverse.

170
00:19:23,220 --> 00:19:29,180
But you want to sort of see if there's an interaction. Based on how effective the treatment is.

171
00:19:29,190 --> 00:19:31,560
So here's putting in the interaction term.

172
00:19:32,530 --> 00:19:41,530
And the output that comes along with that now says it's actually got something smart here in the output in that it knows when

173
00:19:41,530 --> 00:19:48,310
you have an interaction term not to fill in these hazard ratio confidence limit things because it knows the hazard ratios.

174
00:19:49,540 --> 00:19:54,390
Might not involve just one parameter. So it leaves all those blank.

175
00:19:54,660 --> 00:20:04,830
Ah. Will give the E to the parameter estimate to you and you have to know not to interpret it as a single hazard ratio, but says at least for this.

176
00:20:05,610 --> 00:20:13,530
Draghi, we will not fill these in for you as a heads up that your hazard ratios are going to be more complicated with an interaction.

177
00:20:13,530 --> 00:20:18,569
Your model the it turns out that this is not statistically significant.

178
00:20:18,570 --> 00:20:27,150
Here's our P value column. And the world test for the interaction term is not statistically significant with P equals 0.11.

179
00:20:28,500 --> 00:20:34,170
So this is a bit of an academic exercise and they want to sort of see how this works for the model.

180
00:20:36,750 --> 00:20:42,000
It looks like it also stole some statistical signal from the other two variables in the model.

181
00:20:42,570 --> 00:20:46,920
There's some quitting already here, and you often see this when you add an interaction term in.

182
00:20:47,490 --> 00:20:52,740
If everything in the model loses significance, it's because they're all struggling for the same statistical signal.

183
00:20:53,400 --> 00:20:55,590
And so it looks like that might be happening here.

184
00:20:57,090 --> 00:21:04,000
A check of the partial likelihood test also says that, you know, the interaction is not statistically significant.

185
00:21:04,020 --> 00:21:13,140
So just as a reminder, you to do the likelihood ratio test in SAS, you would look at this row here with covariates.

186
00:21:14,190 --> 00:21:18,120
So 0.5854.183 is this number here?

187
00:21:18,900 --> 00:21:24,840
And then you do the same thing for the model without the interaction which was on a previous slide.

188
00:21:26,010 --> 00:21:32,129
The model without the interaction. That same term was over here. And so that also fails to reject.

189
00:21:32,130 --> 00:21:37,740
And I think in the footnote here, I'm like, oh, am I not even in slide? I'm not even in the British House.

190
00:21:37,740 --> 00:21:45,840
But to say in the footnote things sort of switch the AIC switches things again.

191
00:21:45,840 --> 00:21:50,879
Do you know that doesn't happen very often. But it was like we bumped into this a couple times.

192
00:21:50,880 --> 00:22:01,800
Now in this class, this P values for the like pass the likelihood ratio test is getting close to .05 and the AC switches a little bit.

193
00:22:01,800 --> 00:22:06,000
So there's a little bit of ambiguity between those two recommendations.

194
00:22:06,000 --> 00:22:14,729
And unless there's a strong recommendation from your collaborators that the interaction is absolutely of scientific interest and should be capped.

195
00:22:14,730 --> 00:22:20,130
I mean, we usually go with the likelihood ratio test recommendation, not always, but.

196
00:22:23,050 --> 00:22:26,070
It does have the stronger statistical umph to it.

197
00:22:27,380 --> 00:22:31,460
All right. Actually, I'm going to change the slideshow. I didn't even realize I wasn't doing the slideshow.

198
00:22:31,880 --> 00:22:37,850
All right. So this is going to be easier to see now. And.

199
00:22:39,240 --> 00:22:43,170
Yes, we did all that. Okay. And then the same thing in our code.

200
00:22:44,790 --> 00:22:48,030
This is the model without the interaction.

201
00:22:50,520 --> 00:22:53,840
And then this is the model with the interaction over here.

202
00:22:54,420 --> 00:23:05,100
The syntax is very similar. And in ah it's very easy to get the likelihood ratio test.

203
00:23:05,100 --> 00:23:11,759
You just put this command ANOVA with the two models that you're fitted, it will do the test for you, figure out the p value.

204
00:23:11,760 --> 00:23:20,310
Everything is very nice. And so here is the output from the ANOVA command and here's your p value for that like good ratio test.

205
00:23:23,360 --> 00:23:26,840
And here's the output from the fossil hazards model.

206
00:23:27,200 --> 00:23:33,020
So again, it has the coefficient E to the coefficient standard error P value,

207
00:23:33,890 --> 00:23:38,450
and it'll give you this each of the coefficient and the the confidence limits.

208
00:23:39,700 --> 00:23:48,050
It doesn't label this hazard ratio. So technically it's not mislead you, but there's nothing useful about either the coefficient.

209
00:23:49,010 --> 00:23:50,870
When you've got an interaction term in here,

210
00:23:50,870 --> 00:23:55,460
you're going to have to deal with the fact that your hazard ratios are going to involve more than one parameter.

211
00:23:56,760 --> 00:24:02,340
So it doesn't give you a big clue here that that's the case in or in states that just wouldn't show you the results.

212
00:24:02,700 --> 00:24:07,830
An hour and I'll show you whatever you want. You have to know what's correct to interpret and not.

213
00:24:11,100 --> 00:24:18,839
All right. So if we want to estimate the hazard ratio for long versus short duration treatment with this interaction,

214
00:24:18,840 --> 00:24:23,810
the model, we have to pick an age that goes along with that hazard ratio.

215
00:24:23,820 --> 00:24:28,770
Or we could do a plot if we wanted to change, do you know, get the hazard ratios for all possible ages.

216
00:24:28,770 --> 00:24:34,260
We could do a plot as well. So in this particular estimate statement.

217
00:24:35,540 --> 00:24:38,990
I'm putting in age because 32, again, just picked it out of a hat.

218
00:24:40,930 --> 00:24:46,620
And let's think about how this estimate statement came about.

219
00:24:46,630 --> 00:24:52,450
So I want to estimate the hazard ratio for long versus short duration for a 32 year old.

220
00:24:52,870 --> 00:24:55,870
So 32 year old is going to be plugged in for age years.

221
00:24:55,870 --> 00:24:57,249
Everywhere in the formula,

222
00:24:57,250 --> 00:25:05,020
whether I'm talking about the hazard on the top for the long duration treatment or the hazard on the bottom for short duration treatment.

223
00:25:05,350 --> 00:25:08,500
Everywhere age years shows up. I'm plugging in 32.

224
00:25:09,790 --> 00:25:16,990
All right. In the top, the hazard ratio for long treatment is going to plug a one for the log treatment times its coefficient.

225
00:25:18,350 --> 00:25:26,920
Got a 32 times it's coefficient for age. And then over here again for long I've got a one times, 32 times that coefficient.

226
00:25:27,830 --> 00:25:31,610
All right. And on the bottom, long treatment is zero.

227
00:25:31,620 --> 00:25:40,480
So when it's a short duration therapy for the hazard on the bottom, all the terms that have long treatment go away.

228
00:25:40,490 --> 00:25:44,660
So this is going to be a zero. This is interaction. Her results are going to be a zero.

229
00:25:45,290 --> 00:25:50,930
Age is still in there, but it's going to cancel out with the age from the top.

230
00:25:52,250 --> 00:25:55,900
Of the hazard ratio. All right.

231
00:25:56,140 --> 00:26:01,629
So what's a quick way to remember this algebra if you don't want to do it from scratch every single time?

232
00:26:01,630 --> 00:26:04,150
Although I recommend you do it from scratch every single time.

233
00:26:05,140 --> 00:26:13,350
The trick to remember is, you know, all the terms that involve the thing you're changing here.

234
00:26:13,360 --> 00:26:17,770
Treatment long versus short, all of the terms that are involved, that are in the formula, they're not going to go away.

235
00:26:17,780 --> 00:26:26,370
Those are the terms that don't cancel. Because it'll be a one on the top for all the terms and a zero on the bottom for all the terms.

236
00:26:27,480 --> 00:26:33,150
Right. Those are the terms that aren't going to cancel. There's going to be two terms that have to have some number in your formula.

237
00:26:35,520 --> 00:26:38,550
And anything that doesn't have.

238
00:26:40,330 --> 00:26:44,620
That treatment variable involved is going to cancel out in the top and the bottom.

239
00:26:44,620 --> 00:26:51,749
It'll be the same no matter what it is. So eight years was the same.

240
00:26:51,750 --> 00:26:54,809
Whether you're talking about the long treatment hazard or the short term hazard,

241
00:26:54,810 --> 00:26:59,130
it appeared in both hazards and it cancels as a result when you take the ratio.

242
00:27:01,020 --> 00:27:05,850
Another thing to remember for the Cox model is that there's no intercept term for this model ever.

243
00:27:07,120 --> 00:27:12,880
Instead of an intercept term like a beta not you have a hole reference curve the baseline hazard.

244
00:27:14,340 --> 00:27:20,320
And so there's not going to be any. Formulas that involve an intercept here.

245
00:27:20,330 --> 00:27:32,420
So we don't actually have an easy way to estimate the hazard at time t without the baseline hazard being given to us that whole curve.

246
00:27:35,150 --> 00:27:38,570
So that's not going to be something you can just stick in an estimate statement.

247
00:27:40,090 --> 00:27:44,780
So we can only really deal with hazard ratios in our estimate statement.

248
00:27:44,800 --> 00:27:50,170
We can't really get hazard because we don't have a nice, easy peasy bait and not a stick in there.

249
00:27:51,520 --> 00:27:58,989
We have to have the whole we have to find that the output for the baseline hazard and figure out what time little t to pull off.

250
00:27:58,990 --> 00:28:04,120
If we want to do that, it's not so it's a little bit trickier for survival models.

251
00:28:05,430 --> 00:28:05,730
All right.

252
00:28:05,740 --> 00:28:12,780
So when we finally get to our estimate statement and we're looking at the hazard ratio for long versus short duration treatment for a 32 year old.

253
00:28:14,820 --> 00:28:22,110
This is the formula. So this says that I need a beta that goes along with the treatment variable.

254
00:28:23,340 --> 00:28:32,460
And I think any bait and that goes along with the interaction times the filled in number four age that we have here that was 32.

255
00:28:35,550 --> 00:28:43,740
All right. And then I put Slash to get some exponentially rated version of these with confidence limits.

256
00:28:44,130 --> 00:28:48,330
And here is the hazard ratio for a 32 year old.

257
00:28:49,930 --> 00:28:54,750
With the confidence limits. Okay.

258
00:29:01,320 --> 00:29:04,830
All right. And then in order to do the same kind of.

259
00:29:05,970 --> 00:29:10,800
Estimate statement type of thing. You you do this library comp, you've kind of done this before.

260
00:29:12,080 --> 00:29:15,260
Here's the model with the interaction term in their.

261
00:29:16,820 --> 00:29:20,930
And again, doing the same formula.

262
00:29:21,500 --> 00:29:25,489
We don't have an intercept term anymore. Right. There's no for this model.

263
00:29:25,490 --> 00:29:31,940
There's no intercept for this model. It's not a possibility. So long treatment is one in the top hazard.

264
00:29:34,890 --> 00:29:39,900
And age years is 32 everywhere we plug in, 32 everywhere here.

265
00:29:40,410 --> 00:29:44,880
And then long treatment is zero for the bottom hazard.

266
00:29:45,570 --> 00:29:48,870
So that means that this term goes away.

267
00:29:48,870 --> 00:29:54,000
We still have the 32 times that parameter, but it cancels out with the top, right?

268
00:29:55,720 --> 00:29:58,840
And then this is zero as well for the bottom.

269
00:30:00,280 --> 00:30:04,420
So we have the same formula. Of course. I'm just saying. I'm just giving I'm just repeating myself.

270
00:30:04,610 --> 00:30:15,729
So you get more chances to hear that, and then you're putting the contrast matrix together for ah, there's no intercept terms.

271
00:30:15,730 --> 00:30:23,170
This one corresponds to long treatment's parameter zero corresponds to how many of the h years parameters you need.

272
00:30:23,170 --> 00:30:29,350
You have to have a number for everything in the model in R, you can't pick and choose the way we did here.

273
00:30:30,250 --> 00:30:40,660
And then 32 is the number we need for this interaction term that had a one and a 32 filled in in the top of that hazard ratio that didn't cancel out.

274
00:30:43,250 --> 00:30:50,870
And then you get your. I have some code here to get your results with the hazard ratio and the confidence interval looks just like the SAS.

275
00:30:51,960 --> 00:30:56,010
Maybe with a slight difference in significant digits at the end.

276
00:30:57,710 --> 00:31:00,170
All right. So now we're going to.

277
00:31:01,220 --> 00:31:07,760
Go back to the model that doesn't have an interaction term that was are just playing around with how to deal with interaction terms in your models.

278
00:31:07,760 --> 00:31:13,170
And we're going to add insight. And think about how to adjust for site.

279
00:31:13,180 --> 00:31:18,810
So in this particular code, we're adjusting for sight by putting it right in the model.

280
00:31:18,840 --> 00:31:21,990
So this site had two levels, zero and one putting it right in the model.

281
00:31:22,470 --> 00:31:30,390
And so what this is doing is assuming that for any risk profile, whether you're in site zero or one,

282
00:31:30,390 --> 00:31:35,760
you know, you've got proportional hazards, every possible combination of treatment, age and site.

283
00:31:36,870 --> 00:31:44,219
Is assuming proportional hazards. And we don't have interaction terms again.

284
00:31:44,220 --> 00:31:47,890
So we've got hazard ratio columns and confidence limits.

285
00:31:47,910 --> 00:31:58,030
That's the thing. It's good to go. And the site variable looks like it's you know, I would call this marginally significant.

286
00:31:58,040 --> 00:32:03,859
So there is something going on with the site and it looks like site one has slightly

287
00:32:03,860 --> 00:32:09,890
better performance in site zero in terms of delaying time to drug relapse.

288
00:32:12,280 --> 00:32:16,200
All right. The hazard ratio hasn't really moved that much.

289
00:32:16,210 --> 00:32:22,140
It's always kind of been right around 0.8 for all of our models so far.

290
00:32:22,150 --> 00:32:25,780
So even though we've adjusted for sight here, the hazard ratio hasn't budged very much.

291
00:32:26,940 --> 00:32:30,960
And age. We never did really look at age when we're interpreting it. What does it mean for this?

292
00:32:31,920 --> 00:32:37,200
This is this is now the hazard ratio for a single year increase in age.

293
00:32:37,210 --> 00:32:43,640
So what is this point nine, eight, six mean? Do older people relapse quicker?

294
00:32:49,850 --> 00:32:55,550
Or do older people tend to have longer times to drug relapse?

295
00:32:56,330 --> 00:33:01,070
All right. The nods are happening now. So you didn't fall for my little first guess there.

296
00:33:01,430 --> 00:33:10,970
So, yeah, the older people, it it's less than one. So it's a protective it's a protective hazard ratio as you increase by one unit of that variable.

297
00:33:11,330 --> 00:33:22,970
So if you increase by one year of age, you, you know, you have a hazard that's .986 of the hazard for the people who were one year younger.

298
00:33:24,000 --> 00:33:28,030
Right. All right.

299
00:33:28,990 --> 00:33:32,730
FORSYTH There's the the likelihood ratio test has a similar result.

300
00:33:32,740 --> 00:33:36,550
There's sort of it's straddling just outside of statistical significance.

301
00:33:37,090 --> 00:33:43,240
And so we've adjusted for site in this model, but we've leaned on this proportional hazards assumption.

302
00:33:45,640 --> 00:33:50,700
Here's the same code in our. Again, just adding site in.

303
00:33:52,160 --> 00:33:56,989
Doing our quick little like ratio test just with the ANOVA command comes up.

304
00:33:56,990 --> 00:34:03,860
Here is the p value for the liquid ratio test. Here is the same output for the model.

305
00:34:05,980 --> 00:34:09,370
Very similar results for the hazard ratios in the confidence limits.

306
00:34:12,770 --> 00:34:22,090
All right. So the other way we could have adjusted for sight is by stratifying the hazards and having a whole different shape of the hazards,

307
00:34:22,100 --> 00:34:28,190
the baseline hazard for site zero and a whole different baseline hazard estimated for site one.

308
00:34:28,700 --> 00:34:38,840
And so you can't have site in both the straight line and in the model statement that is not allowed.

309
00:34:40,090 --> 00:34:43,920
Okay. So if you adjust for sight this way, it only appears in the strata.

310
00:34:44,620 --> 00:34:49,450
So we're not going to get a data to interpret for a site from the model because we stuck it over here.

311
00:34:53,500 --> 00:34:56,870
But our analysis of treatment will be adjusted for site.

312
00:34:56,890 --> 00:35:01,560
By doing this, it's only possible to do this with categorical variables.

313
00:35:01,570 --> 00:35:06,790
So that's kind of a trick that we can't use for continuous variables unless we turn

314
00:35:06,790 --> 00:35:11,470
them into categories with enough data in each category to really do some fitting.

315
00:35:14,780 --> 00:35:20,839
So here is the here's the long treatment variable again and again, the hazard ratio hasn't moved very much.

316
00:35:20,840 --> 00:35:24,650
It's still just right around 0.8. But the confidence limits.

317
00:35:25,960 --> 00:35:30,430
We have the same or even the hazard ratio for age hasn't changed much either.

318
00:35:34,750 --> 00:35:40,860
But because we have sight as a straight A variable, there's no p value for assessing site.

319
00:35:41,830 --> 00:35:45,310
It's not one that would appear in your paper if you leaned on this model.

320
00:35:50,420 --> 00:35:54,320
And the partial lock would raise your taxes. Also not appropriate.

321
00:35:55,330 --> 00:35:58,810
To compare this model to the model without stratified site.

322
00:35:59,320 --> 00:36:04,900
The once you mess with the baseline hazard and how it's modeled, you can't compare the models anymore.

323
00:36:05,410 --> 00:36:09,729
So the model that had set in as a parameter in the model statement cannot be

324
00:36:09,730 --> 00:36:14,890
compared with a model that switched up the baseline hazard estimation with site.

325
00:36:15,250 --> 00:36:24,670
So you just you can't choose based on that test and you can't choose based on I see between these two methods of adjusting either.

326
00:36:30,160 --> 00:36:42,030
So. What can you do? So you can sort of look to see, you know, are there diagnostics for assessing that proportional hazards assumption for site?

327
00:36:42,040 --> 00:36:46,859
And the only one we've learned so far is this plot of log minus log survival.

328
00:36:46,860 --> 00:36:50,670
So here's some SAS code for producing that plot.

329
00:36:52,450 --> 00:36:59,290
And so treatment site zero the blue and treatment site one is the is the red.

330
00:36:59,290 --> 00:37:04,479
And what you're supposed to do with this plot is sort of if they're a constant difference,

331
00:37:04,480 --> 00:37:08,590
apart for vertical lines, you know, you're supposed to visualize vertical lines.

332
00:37:08,950 --> 00:37:15,730
And if they're a constant distance apart, then that means proportional hazards is okay.

333
00:37:16,870 --> 00:37:21,940
I will tell you that you might be requested to make these plots.

334
00:37:22,540 --> 00:37:26,500
I detest these plots because it's a psychology test.

335
00:37:27,160 --> 00:37:34,000
This is the range of the data that we saw, the curves touching, and there wasn't much data here.

336
00:37:35,200 --> 00:37:42,040
And so if you want to see proportional hazards based on the majority of the data here, you're going to see proportional hazards.

337
00:37:42,040 --> 00:37:45,160
And if you want to see hazards are crossing, you're going to see hazards of crossing.

338
00:37:45,550 --> 00:37:53,160
I just find this. A not terribly useful plot because you'll see what you want to see.

339
00:37:54,000 --> 00:37:59,580
So what do you do? Well, you. And this is just the same code.

340
00:38:01,140 --> 00:38:07,620
So what do you do? So one important thing is that it didn't matter which way we adjusted.

341
00:38:07,650 --> 00:38:15,820
The hazard ratio was the same. So both methods of adjusting for site gave you very similar hazard ratios.

342
00:38:15,820 --> 00:38:25,740
That's how I decide if the science is affected. Then I am going to go with the method of adjustment that makes fewer assumptions.

343
00:38:25,770 --> 00:38:29,010
That's the one where you put side in as a straight A variable.

344
00:38:30,260 --> 00:38:37,850
If the science is very similar, regardless of how you do the adjustment, I'm going to go with the one where I can have a nice p value ratio for side.

345
00:38:39,690 --> 00:38:47,430
So for me, the science is everything. If the science isn't moved, regardless of how you adjust, I go with the model that's easier to write about.

346
00:38:49,820 --> 00:38:56,630
So I'm going to show you other diagnostics, including some that are quite useful in the next handout for proportional hazards.

347
00:38:57,080 --> 00:38:58,309
So we're going to expand on this.

348
00:38:58,310 --> 00:39:06,230
But based on this, based on the stuff we've seen so far, I mean, that plot, if you have really crazy like Big X patterns,

349
00:39:06,230 --> 00:39:10,820
then yeah, that's going to be definitive, but otherwise I just find them not very convincing.

350
00:39:12,830 --> 00:39:17,540
So the main script were these tenets that you might write in. It's the same regardless of which model.

351
00:39:17,780 --> 00:39:25,400
These numbers didn't change. So after adjusting for age and site, the longer treatment plan significantly extended time to drug use relapse.

352
00:39:25,820 --> 00:39:34,790
And then parenthetically, I had the hazard ratio comparing long versus short duration of 0.79 and the confidence interval in the P value.

353
00:39:35,240 --> 00:39:41,840
And that was the same whether we adjusted for site via stratification or via indicator variables.

354
00:39:44,020 --> 00:39:49,180
And that, more than anything else says, you know, I've got this science salad.

355
00:39:51,650 --> 00:39:56,080
So the proportional hazards assumption for a site had minimal impact on interpretation here.

356
00:39:56,090 --> 00:39:59,850
That's kind of the bottom line. All right.

357
00:39:59,850 --> 00:40:04,820
So. It's a little early to take a break.

358
00:40:06,250 --> 00:40:10,190
So. Should I take a break?

359
00:40:10,940 --> 00:40:14,180
Okay, so let's take it let's take a five minute break because it's so early.

360
00:40:14,210 --> 00:40:18,770
Maybe it will end early. So 5 minutes and then we'll start the next handout.

361
00:40:20,060 --> 00:41:44,610
So. 846. Hi.

362
00:41:46,350 --> 00:41:51,950
I had a question on the homework. Yeah, go ahead. And then you can put your you can just so put that wherever you want.

363
00:41:54,100 --> 00:41:59,200
I don't know. I could get an error message for this one, and I'm not exactly sure why.

364
00:41:59,200 --> 00:42:02,410
Because I feel it's from the.

365
00:42:21,070 --> 00:42:30,890
So. I want to say that the OutServe usually follows the time command.

366
00:42:32,050 --> 00:42:35,410
So do you have this slide that you were working from this one?

367
00:42:38,500 --> 00:42:43,370
Oh, it was the same. All right, let's look at your code again.

368
00:42:43,780 --> 00:42:46,810
Now, I'm just looking for any. Okay.

369
00:42:47,510 --> 00:42:52,560
It was this one. Yes. Okay. Time.

370
00:42:59,950 --> 00:43:09,830
Good luck, Malcolm. First character and printable.

371
00:43:16,970 --> 00:43:20,550
Can look at your data set. Is it the anemia one?

372
00:43:35,370 --> 00:43:39,070
Okay. All right. Do you mind if I touch you?

373
00:43:40,890 --> 00:43:44,010
There's a disinfecting wipes over there. You want to grab one of your.

374
00:43:45,210 --> 00:43:49,620
I'm just looking here. So age group really is all of this stuff really is in there.

375
00:44:02,930 --> 00:44:21,170
So I was really in there to. I'm terrible with Max.

376
00:44:21,180 --> 00:44:25,610
I will tell you. I just. Uh.

377
00:44:44,710 --> 00:44:55,070
Well, how about this? I mean. It didn't happen here and it also happened there.

378
00:44:55,100 --> 00:45:02,760
Okay. Can we just try? Getting rid of the at risk.

379
00:45:04,360 --> 00:45:10,980
And seeing if it runs, then just. Out of curiosity, would that do it?

380
00:45:19,460 --> 00:45:34,900
Well, that wasn't it. So we can control through that one. Yeah.

381
00:45:43,260 --> 00:45:47,520
I'm looking for semicolons. I'm looking for.

382
00:45:48,840 --> 00:45:57,510
Quotes. Uh.

383
00:46:03,300 --> 00:46:13,030
You look at the slide again. All right, I'm going to try something else.

384
00:46:13,320 --> 00:46:18,880
I'll get rid of the odious graphics on and off. Just, like, come into that with an asterix in the front.

385
00:46:19,680 --> 00:46:25,760
If you just put an extra asterix in the front, you can keep it without really distorting the code in the office world.

386
00:46:26,780 --> 00:46:29,930
I'm just trying random stuff now. Run it and see how it goes.

387
00:46:38,130 --> 00:46:51,210
No, that wasn't it either. And it was really called age group in your.

388
00:47:01,860 --> 00:47:07,340
Can we just verify the age group really? Did we already do that, that the age group really did get created correctly?

389
00:47:07,350 --> 00:47:17,100
I mean, I can't imagine it wouldn't. How about we just.

390
00:47:17,700 --> 00:47:23,030
Comment how? This line and see if it's the problem.

391
00:47:28,490 --> 00:47:33,900
Semicolon here. All right. So now the only thing is saving it to that data.

392
00:47:34,380 --> 00:47:40,200
And let's just see if that's what you were suspecting was the problem the whole time.

393
00:47:40,200 --> 00:47:47,799
Right. They have, like, you know.

394
00:47:47,800 --> 00:47:51,430
So it wasn't that which is good and bad, right?

395
00:47:51,640 --> 00:47:58,600
You know. Okay. What is it that we're not seeing?

396
00:48:06,830 --> 00:48:10,310
All right. We're going to we're going to put the Asterix right here.

397
00:48:13,580 --> 00:48:19,580
I was wondering is with this one, do I have to add a new variable to it?

398
00:48:22,930 --> 00:48:32,660
I remember because. You. I don't know if that is think it's just the name of the data set that you want to say.

399
00:48:33,020 --> 00:48:36,340
Right. Let's just see.

400
00:48:38,770 --> 00:48:42,070
We're going to take out one command at a time here.

401
00:48:44,560 --> 00:48:50,670
Is it that? It's not that either.

402
00:48:57,820 --> 00:49:06,960
So it has to be. It has to be the time.

403
00:49:07,630 --> 00:49:14,830
That's all that's left is the time. Is the Ph.D. is that really a01 variable with a value of zero?

404
00:49:15,280 --> 00:49:20,440
I think I'm out of time. Yeah, there's only one thing left.

405
00:49:21,280 --> 00:49:25,059
It has to be there. Yeah. Oh, you know what it is.

406
00:49:25,060 --> 00:49:29,080
I bet I know what it is. Oh, my God. You're going to die.

407
00:49:30,250 --> 00:49:39,690
It's the font of the semicolon. The font if you copy it from another file and the semicolon or something else is in a weird font.

408
00:49:40,560 --> 00:49:43,610
It will choke. Oh, really? Yeah.

409
00:49:44,150 --> 00:49:47,210
It's crazy. I look for things like that with quotes, too.

410
00:49:48,350 --> 00:49:54,380
It has to be that. Did I just print? Did I did it? Oh, no, it didn't work.

411
00:49:54,920 --> 00:49:58,470
Well, something to play with is like typing with semicolon.

412
00:49:58,490 --> 00:50:02,510
Okay. I don't know. I don't see it either. I can at least assure you I don't see it.

413
00:50:02,510 --> 00:50:08,410
But come back after. We'll work tomorrow. Okay? All right.

414
00:50:08,440 --> 00:50:14,600
I might have let the break go a little longer, then said, let's get back to work.

415
00:50:15,290 --> 00:50:18,380
So this is a this is a nice.

416
00:50:20,260 --> 00:50:30,370
Handout that that really kind of goes over model selection and looking at the various assumptions so.

417
00:50:32,590 --> 00:50:38,169
Some of this is are some of these things I'm going to go over tricks you've seen in other models already and is well known,

418
00:50:38,170 --> 00:50:45,150
but I like it to be all in one place. I think I can skip the notation for censored survival data.

419
00:50:45,450 --> 00:50:51,770
Except let me just pause right here. Up until now, we haven't done a lot with little tea.

420
00:50:52,730 --> 00:50:54,469
This is a it's not a random variable.

421
00:50:54,470 --> 00:51:03,770
It's just the length of time little t that you followed the you know, that you've that's in the study time of the curves.

422
00:51:04,430 --> 00:51:10,999
And so so far it's appeared in our hazards like you'll have hazard at little

423
00:51:11,000 --> 00:51:15,500
time T And then some model where the baseline hazard also has a little time.

424
00:51:15,500 --> 00:51:24,020
T And you know that that's just supposed to be like the horizontal axis for a plot that you would do for, for survival or whatnot.

425
00:51:26,090 --> 00:51:30,950
It's not the same as capital T, the random variable that you're interested in,

426
00:51:31,850 --> 00:51:37,850
and it's definitely not the same as side the value that you have in your data set.

427
00:51:38,960 --> 00:51:42,560
That's the observation time. Okay.

428
00:51:42,730 --> 00:51:46,990
But it and this is a perk up moment in this handout.

429
00:51:48,770 --> 00:52:03,260
You will see that SAS. And ah as well will use the same variable that you have recorded for x to manipulate things relating to little T and that is.

430
00:52:04,570 --> 00:52:09,490
Can be very confusing for a student or anybody learning how to deal with the code.

431
00:52:09,820 --> 00:52:13,149
So I want you to be aware when I say perk up,

432
00:52:13,150 --> 00:52:19,960
we need to figure out what's going on with little T versus X that's coming in this handout because we will be playing with Little T,

433
00:52:20,260 --> 00:52:25,030
but it'll be using the variable name for X, which can be quite confusing.

434
00:52:25,540 --> 00:52:28,990
So there will be a heads up moment about that in this handout.

435
00:52:30,550 --> 00:52:34,810
All right. All the other stuff is the same we've seen before.

436
00:52:35,740 --> 00:52:41,860
The key assumption, again, for the Cox model is that the event time that you're interested in modeling is independent of the

437
00:52:42,010 --> 00:52:47,560
censoring time for all individuals given covariance that you're going to put in your Cox model.

438
00:52:49,710 --> 00:52:55,760
Okay. So let's talk about building a model and thinking about the functional form of continuous growth.

439
00:52:55,770 --> 00:53:00,149
This is something that you've been doing all of your statistical career,

440
00:53:00,150 --> 00:53:03,630
but we're just going to break it down and all in one place, all the tricks we know.

441
00:53:04,290 --> 00:53:09,839
So here's the cuts. Moral hazard at time, little t baseline hazard.

442
00:53:09,840 --> 00:53:13,860
And then this is the part of your model that your you have covariates in.

443
00:53:15,750 --> 00:53:18,600
So as usual, it's worth exploring the form of continuous cover.

444
00:53:18,600 --> 00:53:24,330
It's in your model, and this is the kind of plot that I would see when I was a baby little student.

445
00:53:24,960 --> 00:53:31,420
This is the kind of plot that we would look at when we were thinking about how to model continuous coverage.

446
00:53:31,440 --> 00:53:38,399
So you would break coverage into categories and then fit the model with those categorical variables,

447
00:53:38,400 --> 00:53:47,340
like with the class statement and then plot the parameter estimates against the respective category specific midpoints.

448
00:53:47,370 --> 00:53:52,110
So here I've got a potential cover at age that's continuous,

449
00:53:52,920 --> 00:54:03,900
but I've broken it up into four different categories and I'm the vertical axis is the beta estimates and the horizontal axis is age and years.

450
00:54:04,560 --> 00:54:09,810
And what we're these are the betas for the midpoints of the age categories I made.

451
00:54:10,170 --> 00:54:15,480
And so what you're supposed to do with this particular diagnostic is sort of say, is this a straight line?

452
00:54:15,510 --> 00:54:23,430
You know, if it's a straight line, then it probably is going to be a linear version of age that you put in your model.

453
00:54:23,760 --> 00:54:31,739
You know, this sort of kind of goes along with that. If there was a weird bend, you might think about maybe having a spline term, maybe it's not.

454
00:54:31,740 --> 00:54:37,880
If it's not a straight line and you need a bend, maybe you put a line term where the bend happens here it looks kind of straight,

455
00:54:38,640 --> 00:54:44,130
but you could sort of do these plots to get an idea of the functional form visibly.

456
00:54:46,060 --> 00:54:49,270
And of course, you can check your AC.

457
00:54:49,420 --> 00:54:57,560
We can't really do like good ratio tests comparing a continuous covariate to categorical covariates.

458
00:54:58,810 --> 00:55:01,810
We can't do that with the likelihood ratio test.

459
00:55:01,810 --> 00:55:08,200
We can only do ordinal variables versus categorical variables, not continuous variables versus categorical variables.

460
00:55:09,340 --> 00:55:17,860
But we can check the AC to sort of see if one version of the the age variable is better than the other.

461
00:55:20,700 --> 00:55:26,879
So consider the use of linear spline terms. And then also maybe not for this example with age,

462
00:55:26,880 --> 00:55:34,740
but for any continuous variable you want to consider of going beyond some threshold captures mortality risk better than a linear term.

463
00:55:35,340 --> 00:55:43,559
So maybe the beta is zero until you get to some threshold level where the variable, whatever it is, starts making a difference.

464
00:55:43,560 --> 00:55:51,690
On mortality. Just so you can think of any normal biomarker value, you would have some blood test and elevated levels.

465
00:55:51,690 --> 00:55:57,299
You have to start paying attention to how that affects mortality. So all of these things are things that you should be thinking of when you have

466
00:55:57,300 --> 00:56:05,010
a continuous variable and by biomarkers are often threshold oriented variables.

467
00:56:08,020 --> 00:56:12,340
When you have when you're thinking about categorical covariates in the functional form,

468
00:56:13,000 --> 00:56:16,299
one thing that I like to do is actively choose the reference group.

469
00:56:16,300 --> 00:56:21,400
And for SAS, you can do that in the class statement by having whatever the variable name is

470
00:56:21,400 --> 00:56:26,400
and putting the reference group you want with this kind of syntax and an R,

471
00:56:26,980 --> 00:56:31,050
there's a way to do it as well. Prior to setting up the formula that you're going to use in your model,

472
00:56:31,060 --> 00:56:42,070
you can use this command where you have your variable name and then you're re leveling it as a categorical variable with this reference group.

473
00:56:42,520 --> 00:56:47,980
And then forever after when you put that in a in a model, it will assume that zero is your reference group.

474
00:56:50,890 --> 00:56:58,720
If a category is nearly empty, consider consolidating it in to another group if the combined interpretation remain sensible.

475
00:57:02,070 --> 00:57:05,700
Consider if the natural ordering of a categorical predictor allows for or no

476
00:57:05,700 --> 00:57:10,059
relationships in the model and potentially higher power to detect signals.

477
00:57:10,060 --> 00:57:16,830
So again and again, we've kind of seen, you know, if there is a linear relationship between level 012,

478
00:57:17,340 --> 00:57:20,370
you're going to get a better statistical handle on what it's doing,

479
00:57:20,790 --> 00:57:29,190
using it as a linear ordinal term, as opposed to using the class statement with categorical predictors.

480
00:57:31,360 --> 00:57:38,530
That's one situation where you can do a like that ratio test and comparing ordinal versus categorical versions of a predictor in the model,

481
00:57:39,070 --> 00:57:48,860
all else unchanged. So one thing that has changed a lot since I was a little baby student is automated model selection.

482
00:57:48,860 --> 00:57:52,010
We used to have to try all these different models by hand and it was terrible.

483
00:57:52,490 --> 00:57:59,990
Automated model selection is the best. And so in case you haven't played with this a lot, you know, here's just a quick review.

484
00:58:00,140 --> 00:58:04,459
We did look at it with logistic regression and just like with logistic regression,

485
00:58:04,460 --> 00:58:09,020
porcelain hazards, regression software has automated model selection features with similar coding.

486
00:58:09,440 --> 00:58:13,800
And so my personal favorites for automated model selection are forward selection.

487
00:58:13,820 --> 00:58:19,700
That's a big, big one. I like it building up the model from the most significant variable first and

488
00:58:19,700 --> 00:58:23,870
then trying all the other variables that could possibly be the second variable,

489
00:58:24,230 --> 00:58:29,180
picking the most significant one of it and going on and building your model from the ground up.

490
00:58:30,410 --> 00:58:37,700
So SAS builds the model by adding the most significant term in each round of checks until it reaches zero significance level,

491
00:58:37,700 --> 00:58:39,799
which I think is by default is 0.05.

492
00:58:39,800 --> 00:58:52,010
So it will stop adding in terms if no other terms reach .05 significance level R has a slightly different model selection algorithm.

493
00:58:52,010 --> 00:58:56,090
It adds in variables based on AIC going down.

494
00:58:56,240 --> 00:59:02,570
So it will start with the variable that lowers the AIC the most rather than P value,

495
00:59:02,930 --> 00:59:07,220
and it will keep on adding variables as long as something will lower the AIC.

496
00:59:07,610 --> 00:59:16,370
And so what happens, and this may come up on your homework that if you were a SAS user versus an R user,

497
00:59:16,370 --> 00:59:24,920
you could get different models that are recommended from these automated model selection algorithms because you're using different tools.

498
00:59:29,740 --> 00:59:36,720
Another favorite option is that you can enforce inclusion of confounders that are required for face validity.

499
00:59:36,730 --> 00:59:43,299
So it's almost always the case that age and gender are forced into models,

500
00:59:43,300 --> 00:59:48,130
even if they don't reach statistical significance because people expect those things to be adjusted for.

501
00:59:48,610 --> 00:59:51,940
And these automated model selection tools do allow you to do that.

502
00:59:52,630 --> 01:00:00,830
So in SAS, there are include statements that you can use where you whatever your number is that you use for your included statement.

503
01:00:00,850 --> 01:00:08,680
We'll have examples in a minute. The first how many covariates that number is those are forced to be included in your model.

504
01:00:08,830 --> 01:00:12,640
And model selection also takes place with respect to the ones after those.

505
01:00:14,400 --> 01:00:20,639
There is in ah a way to do it by specifying a lower and an upper model that you're comparing

506
01:00:20,640 --> 01:00:25,530
the lower model being the one that you've got your forced variables that you want to keep in.

507
01:00:27,840 --> 01:00:35,650
So we're going to return to this multiple myeloma example. And we're going to play with more of the coverage.

508
01:00:35,660 --> 01:00:40,760
I think we've only really played with platelet up until now, but so are x variable this time.

509
01:00:40,910 --> 01:00:48,620
Time from diagnosis to death or censoring in 65 multiple myeloma patients and our censoring variable delta is called status.

510
01:00:48,620 --> 01:00:53,149
And so it's zero if they were still alive when you stopped watching them.

511
01:00:53,150 --> 01:00:57,650
So this is the censoring number and one if they had the observed death.

512
01:00:59,400 --> 01:01:02,910
And then we have all these variables now that we're going to play with.

513
01:01:02,910 --> 01:01:07,130
And this is a lot to analyze if you're doing everything by hand.

514
01:01:07,140 --> 01:01:14,100
So we're going to take advantage of automated model selection. I will say that for this particular dataset.

515
01:01:15,920 --> 01:01:23,510
The units were frustratingly not described. So log blood, urea, nitrogen and hemoglobin.

516
01:01:23,540 --> 01:01:27,680
If you're a scientist, maybe you know where the units are for these things are not.

517
01:01:28,010 --> 01:01:32,780
I'm a statistician. I always rely on my medical colleagues to tell me what the units are.

518
01:01:33,140 --> 01:01:39,140
And a statistician wrote this paper and they didn't tell us units in the paper.

519
01:01:39,170 --> 01:01:44,959
I did. Look. What I will say is that for this log, blood, urea, nitrogen,

520
01:01:44,960 --> 01:01:52,880
a one unit change after doing histogram on one unit change in that variable is substantial across the distribution of that variable.

521
01:01:53,360 --> 01:02:01,340
And so as a as a statistician who recognizes that a one unit change is going almost from the beginning to the end,

522
01:02:01,520 --> 01:02:07,040
the distribution of that variable, we need to really think about that variable a little more carefully.

523
01:02:09,080 --> 01:02:14,020
Okay. Here's his reading in the data.

524
01:02:14,020 --> 01:02:16,030
Four stars will do some similar similar code.

525
01:02:16,030 --> 01:02:23,469
And ah, so this is the, the stuff in yellow, that's the automated model selection that we're going to put in place.

526
01:02:23,470 --> 01:02:27,670
So all I have here is include equals one.

527
01:02:28,270 --> 01:02:35,500
So in SAS that means that I'm forcing this first variable in the list to be in the model no matter what, whether it's significant or not.

528
01:02:35,890 --> 01:02:39,130
So age is going to be in every one of the models that's considered,

529
01:02:39,940 --> 01:02:47,140
and otherwise I'm going to do forward selection to see what stays in the model at the significance level of 0.05,

530
01:02:47,620 --> 01:02:53,559
where this force selection algorithm will find the most significant variable with the smallest P-value first and put it in

531
01:02:53,560 --> 01:02:59,050
and then it will go sift through all the remaining covariates that are in the model yet find the most significant of those.

532
01:02:59,380 --> 01:03:05,890
Stop it in the model until it runs out of significant at the point of five level predictors.

533
01:03:07,280 --> 01:03:15,349
So I have a dialog blood unit, urea, nitrogen, hemoglobin, platelet, all this other stuff.

534
01:03:15,350 --> 01:03:21,010
And it's going to find what's statistically useful in this model for me.

535
01:03:22,210 --> 01:03:24,310
And this is the end result.

536
01:03:24,310 --> 01:03:32,230
So age I forced it to keep it doesn't have a p value, but it's going to be something you want to adjust for as a potential confounder.

537
01:03:32,830 --> 01:03:38,489
And then it picked this log blood, urea, nitrogen with this unit, I have no idea in this hemoglobin.

538
01:03:38,490 --> 01:03:49,110
And again, with a unit, I have no idea. Except that I know that logged blood you reunited in a one unit increase in that variable is huge and

539
01:03:50,070 --> 01:03:57,299
the hazard ratio is also huge because it's basically going from the very lowest range to one unit.

540
01:03:57,300 --> 01:04:02,670
Higher is almost the top of the range. So it's like almost completely different from the people at the bottom of range.

541
01:04:03,830 --> 01:04:17,960
Okay. So it looks like higher log blood, urea, nitrogen is is bad in terms of mortality, but having a one unit higher hemoglobin is good.

542
01:04:18,350 --> 01:04:22,240
It's protective. Because this hazard ratio is less than one.

543
01:04:27,100 --> 01:04:31,360
Or and so we haven't checked any assumptions or anything. So that's certainly going to be part of the exercise.

544
01:04:31,360 --> 01:04:37,959
That's our first pass, our code, doing the same kind of model selection kind of goes like this.

545
01:04:37,960 --> 01:04:42,780
I'm loading in all these libraries with cool codes I need. In art.

546
01:04:43,260 --> 01:04:47,670
The formula now is going to have a tilde with the with all the covers.

547
01:04:47,680 --> 01:04:50,700
I want to try. All right. That's everything.

548
01:04:50,710 --> 01:04:57,750
That's form one. And I fix. I fit the Cox model with everything in the model that I'm curious about.

549
01:05:00,600 --> 01:05:07,770
And then I have this model I'm calling include that's going to be the model that I'm forcing in age.

550
01:05:08,920 --> 01:05:25,090
And in ah the selection goes, you know, I'm just saving all the output and forwards and you have this uh, model that has just the include age model.

551
01:05:26,630 --> 01:05:35,900
And this lower command is saying force everything and that include model to stay in there don't you know keep age in that model no matter what.

552
01:05:36,290 --> 01:05:40,850
And then the upper is everything else that you want to try that was saved and fit one.

553
01:05:42,230 --> 01:05:45,560
And direction equals forward and then what it comes up with.

554
01:05:46,960 --> 01:05:54,130
In nice, pretty formatting. Well, actually, I think this is going to show you what happens in a few steps.

555
01:05:54,130 --> 01:06:03,910
It'll give you a lot of output. So here is the first step where you forced an age and the model selections based on AIC in R.

556
01:06:04,420 --> 01:06:08,050
So it's showing you for every variable that you might add age.

557
01:06:08,230 --> 01:06:10,140
What happens to the AIC?

558
01:06:10,570 --> 01:06:22,120
This non row is if you just left age alone in the model and so it is going to pick the variable that reduces the AIC the most compared to the non row.

559
01:06:22,450 --> 01:06:28,660
And that's so it's going to pick luck blood know blood, urea, nitrogen for the first pass here.

560
01:06:29,870 --> 01:06:37,429
And so now both of those are in the model. And so if you didn't add anything else, this is the AIC actually what we saw just over here.

561
01:06:37,430 --> 01:06:41,899
So that's the same and it's going to pick the variable that reduces the AIC the

562
01:06:41,900 --> 01:06:45,500
most compared to the non row and that's going to be the hemoglobin variable.

563
01:06:46,750 --> 01:06:55,330
So that's the variable here. And if you just stuck with that, this would be your ROIC is seeing if there's any other variable that can reduce that.

564
01:06:55,390 --> 01:07:02,920
I see. And this is where R is picking a different model from SAS because it sees that this s calc

565
01:07:02,920 --> 01:07:08,470
variable reduces it just a smidgen and it's going to pick it for its model because of that.

566
01:07:08,480 --> 01:07:17,090
So this is the final model. That it will end up picking no other variables added to this model with s calc in there,

567
01:07:17,900 --> 01:07:21,310
none of them reduce the AIC anymore, so it's going to stop there.

568
01:07:23,250 --> 01:07:26,340
And it just changed it very, very slightly.

569
01:07:27,450 --> 01:07:38,559
So. Here's the nice output from the model selection and you can sort of see it put in as calc, even though it has a p value that's greater than 0.05.

570
01:07:38,560 --> 01:07:44,650
So it says didn't pick this variable, but are will based on AIC.

571
01:07:45,250 --> 01:07:51,639
And so you're only going to see the model that you're either a SAS or an R user.

572
01:07:51,640 --> 01:07:56,680
Generally, you don't fit every model you're ever going to want to look at in both packages.

573
01:07:57,340 --> 01:08:03,399
But if you get this result, you might want to look to see, you know, how important is this variable?

574
01:08:03,400 --> 01:08:06,850
It changed the AIC very little doesn't have a significant world test.

575
01:08:08,500 --> 01:08:18,460
So what I suggest leaving it out, maybe you can do a likelihood ratio test to compare the model with as count to the model without s calc.

576
01:08:21,870 --> 01:08:28,410
And do your liquid Rorschach test here. And the liquid ratio test also kind of gives you a p value that says maybe you don't need s calc.

577
01:08:30,080 --> 01:08:33,110
So looking at this data,

578
01:08:33,110 --> 01:08:41,630
I might leave out a scowl unless there's a strong argument that that is just absolutely the most scientific variable ever and that we should,

579
01:08:42,470 --> 01:08:46,720
you know, consider at least describing it in a sentence.

580
01:08:46,730 --> 01:08:54,260
But does the statistical information is a little on the weak side, it just barely decreased AIC.

581
01:08:54,770 --> 01:08:58,460
So I think this is probably the model to move forward with.

582
01:08:59,900 --> 01:09:09,260
And all of these are in the model, assuming a linear form. We didn't do any exploration at all about the form of any of these covariates in the model.

583
01:09:09,260 --> 01:09:17,360
We just took them as is. And so what we can do is take advantage of Ford selection and the include statement

584
01:09:17,360 --> 01:09:20,990
again to check on the functional form of these variables with linear lines.

585
01:09:22,040 --> 01:09:26,450
So this is again a trick I love. I can check for a lot of lines at the same time.

586
01:09:28,760 --> 01:09:33,829
And there might be points that are already in the literature they can use.

587
01:09:33,830 --> 01:09:39,890
But in the absence of knowing anything about the possible cut points for applying terms, I just looked at proc univariate.

588
01:09:40,760 --> 01:09:43,700
Again, I don't know what the units are over these guys, so I had no idea about that.

589
01:09:43,700 --> 01:09:49,459
So I did proc univariate and looked at the summary statistics for those three predictors.

590
01:09:49,460 --> 01:09:58,370
So all the numbers in parentheses after these three bullets are the minimum, the first quartile, the median, this 75th.

591
01:09:59,210 --> 01:10:03,550
Percentile and the maximum. And so you just kind of look at the range of the data.

592
01:10:03,550 --> 01:10:07,940
I remember I said log blood, urine, nitrogen, a one unit change was a huge thing.

593
01:10:08,780 --> 01:10:12,980
The minimum is 0.78, the maximum is 2.24. So one unit change is huge.

594
01:10:14,990 --> 01:10:22,130
So just looking at these variables, you don't have to pick the exact quintiles by any means.

595
01:10:22,250 --> 01:10:29,180
For me, it looks like if I picked about eight, ten and 12 for hemoglobin, that would probably work.

596
01:10:30,890 --> 01:10:34,400
And for log blood, urea, nitrogen, you know.

597
01:10:37,140 --> 01:10:40,200
Some something near, but maybe a little bit prettier than these.

598
01:10:41,180 --> 01:10:45,860
Would work. I can't remember exactly how I did it, but it'll be on the next page.

599
01:10:45,860 --> 01:10:52,670
And similarly, 50, 60, 74 age seems close enough to just test for applying for explained terms.

600
01:10:53,150 --> 01:10:56,780
So here's where I've created all those blind terms looks like for lit log blood.

601
01:10:56,780 --> 01:11:05,390
You're in nitrogen. I made a spleen at one, at 1.3 and 1.6, age 50, 60, 70, hemoglobin at eight, ten and 12.

602
01:11:05,900 --> 01:11:11,660
And just based on being kind of pretty numbers that were roughly within the spread of the data.

603
01:11:13,460 --> 01:11:18,500
And so to do a quick assessment of if there are any interesting spelling terms,

604
01:11:19,040 --> 01:11:27,080
I took the three variables that were significant, the first forward selection and put them into my include statement.

605
01:11:27,090 --> 01:11:32,239
So what's the first three variables is what I'm saying. Force those in and then all the supplied terms.

606
01:11:32,240 --> 01:11:35,390
I just stuck in there and said do forward selection.

607
01:11:36,080 --> 01:11:39,980
And so it will do all the work for me to see if any of those playing terms are interesting.

608
01:11:41,610 --> 01:11:49,350
And one was so this log blood, urine, nitrogen or the spleen was done at.

609
01:11:51,750 --> 01:11:59,840
What was that? 1.3. You know, that one ended up being statistically significant.

610
01:11:59,850 --> 01:12:03,260
So as we go through this data set and we're learning more about it,

611
01:12:03,590 --> 01:12:10,879
we have one that's potentially we just picked this fly out of a hat, but we have one spline term that's potentially interesting.

612
01:12:10,880 --> 01:12:18,080
And we're going to learn a few different ways to to narrow down what the functional form of this verb might be.

613
01:12:23,420 --> 01:12:28,400
So is blind term allowing a bend near the median log blood you're in nitrogen is statistically significant.

614
01:12:29,340 --> 01:12:39,270
And so one question that you might ask is, you know, the main effect for Blalock blood, urea, nitrogen ended up losing significance.

615
01:12:40,390 --> 01:12:48,160
And so you kind of this is where having a scientific collaborator can be very helpful because as a statistician, I would want to say,

616
01:12:48,160 --> 01:12:58,000
well, you know, does that mean that the hazard ratio is one until you get to the median and then suddenly this is, you know.

617
01:12:59,080 --> 01:13:03,370
Going to affect like the hazard a lot, you know?

618
01:13:03,370 --> 01:13:08,370
So should I be? Taking out log blood, urine,

619
01:13:08,370 --> 01:13:15,600
nitrogen and saying that it only changes the mortality hazard once you hit about the median and then it goes up from there.

620
01:13:19,110 --> 01:13:23,970
So we can certainly look at that. Here's the model without log blood, urine, nitrogen.

621
01:13:24,930 --> 01:13:33,839
So here's with here's without and the model statistics and just looking quickly at the I see the eye sees a little

622
01:13:33,840 --> 01:13:40,260
bit smaller when you take the main effect of log burn out and just say that the hazard kicks in at the median.

623
01:13:45,170 --> 01:13:50,010
The likelihood ratio test. You would look at this number here.

624
01:13:50,340 --> 01:13:56,370
It's always in the column with cover. So it's this number here for the model with log, blood, urine, nitrogen.

625
01:13:56,730 --> 01:13:58,680
And here's four without it.

626
01:13:59,750 --> 01:14:08,210
And that like good ratio test also fails to reject saying that maybe mortality doesn't really kick in for this variable until around 1.3.

627
01:14:11,650 --> 01:14:16,030
So everything is sort of from a statisticians point of view saying hazard ratio

628
01:14:16,030 --> 01:14:20,170
of one until it hits the threshold and then something's affecting mortality.

629
01:14:20,520 --> 01:14:26,919
Again, since I'm not someone who works in this area, I would need to check with my collaborators.

630
01:14:26,920 --> 01:14:30,280
Is that something that's sensible that you would expect from this variable?

631
01:14:32,610 --> 01:14:36,750
So at this point, I'd be wise to consult with the research team to check face validity of this threshold

632
01:14:37,200 --> 01:14:40,230
as opposed maybe to others that might have been mentioned in the literature.

633
01:14:40,260 --> 01:14:46,260
So maybe for all I know, the point of 1.2 has always been used historically,

634
01:14:46,260 --> 01:14:49,409
and it's just because I don't work in this area that I'm not aware of that threshold.

635
01:14:49,410 --> 01:14:54,930
But it's what gets flagged as having a terrible level of this whenever docs look at it.

636
01:14:55,020 --> 01:15:01,020
So do your Google homework or have your collaborators do Google homework to see if there's

637
01:15:01,020 --> 01:15:07,110
already a threshold that people use generally rather than someone we pulled out of a hat.

638
01:15:07,990 --> 01:15:22,629
Okay. So. So this slide is I've never gone over what you know, it's so much here what a one unit increase in a variable is.

639
01:15:22,630 --> 01:15:27,820
But for this one variable, a one unit increase was most of the range of the data.

640
01:15:29,110 --> 01:15:31,930
And so usually when we have a spline term,

641
01:15:32,860 --> 01:15:40,419
we just talk about what a one unit increase is if you're below this blind term and what a one unit increases when you're above this blind term.

642
01:15:40,420 --> 01:15:46,969
And we've done that. In in homeworks and things before and when a one unit change is a small thing.

643
01:15:46,970 --> 01:15:52,950
That's all we do, and that's fine. But in this case, it's a huge range of the data.

644
01:15:52,960 --> 01:15:58,870
So we need to actually think a little bit more carefully about what this hazard ratio does.

645
01:16:00,700 --> 01:16:07,840
When the top part of the hazard is on one side of the spline term and the bottom of the hazard is on the other.

646
01:16:09,290 --> 01:16:17,569
All right. So here's the formula for hazard ratio for a one unit increase in log blood, urea, nitrogen.

647
01:16:17,570 --> 01:16:25,879
So let's just look at this. So first of all, I want you to notice that for that spline term, I've written out the algebra of what went into the term.

648
01:16:25,880 --> 01:16:36,110
I'm not using a variable name here. A very common error is to just put the variable name in your formula and add one to the variable name.

649
01:16:37,560 --> 01:16:46,620
But you were trying to compare the hazard for not the variable name plus one, but increasing lung blood, urinary nitrogen by one.

650
01:16:47,040 --> 01:16:52,020
And that part is inside the algebra that makes up the variable name.

651
01:16:52,030 --> 01:16:58,950
So you will actually get really weird and incorrect answers if you don't recall that log.

652
01:16:58,950 --> 01:17:04,049
Blood, urea, nitrogen is inside this formula in a couple of different places.

653
01:17:04,050 --> 01:17:08,640
It's not you can just you can't just add one to this variable name and think you've gotten it done.

654
01:17:10,020 --> 01:17:20,190
So that's per moment. Number one is when you've got spline terms or quadratic terms or whatever interaction terms you

655
01:17:20,190 --> 01:17:26,800
need to pay attention to where the variable is that you're increasing by one inside that algebra.

656
01:17:26,820 --> 01:17:32,120
Don't assume that it's just something you can add to the variable name. All right.

657
01:17:32,480 --> 01:17:41,680
So on the top. I've got one unit increase for log blood, urine, nitrogen in this part of this blind term and in this part of this blind term.

658
01:17:42,070 --> 01:17:47,770
And everything in the hazard ratio in the bottom is the same except to have an added one to log blood.

659
01:17:47,770 --> 01:17:51,860
Urea. Nitrogen. Either location. All right.

660
01:17:52,340 --> 01:18:00,220
And so there's some cases like below the spleen term and above the spleen term where it's still easy to do the algebra.

661
01:18:00,230 --> 01:18:09,740
So we're going to go through this kind of slowly. So the first special case is if log, blood, urine, nitrogen is greater than 1.3.

662
01:18:11,270 --> 01:18:22,130
All right. So if lug lug blood you're injured is greater than 1.3, then this indicator over here is a one, and so is this one.

663
01:18:22,160 --> 01:18:23,840
If log blood, log blood,

664
01:18:23,840 --> 01:18:31,879
your nitrogen is greater within 1.3 than making it even bigger by one is also going to be so the indicator isn't doing any weird switching.

665
01:18:31,880 --> 01:18:41,590
They're both one in this case. And so the hazard ratio is going to have things like age canceling in both the top and the bottom.

666
01:18:41,980 --> 01:18:45,070
Hemoglobin is canceling in both the top and the bottom.

667
01:18:46,090 --> 01:18:54,190
And these are these indicator functions are ones that we have to look at what's happening with the beta three and the log burn will cancel.

668
01:18:55,770 --> 01:19:01,290
And the -1.3 part will cancel, but will have a beta three times one that does not cancel.

669
01:19:01,290 --> 01:19:06,270
So that has a ratio. It's going to be either the beta three, after all, cancellations for this case.

670
01:19:08,950 --> 01:19:16,209
And so the other special case that's a little easier to deal with is if when you add one to large blood,

671
01:19:16,210 --> 01:19:20,100
urine, nitrogen, that it is still less than 1.3.

672
01:19:20,110 --> 01:19:25,840
So it's this top part. Is going to be.

673
01:19:27,390 --> 01:19:35,400
What this top part is going to be a zero because log blood your nitrogen plus one is not graded anyways less.

674
01:19:36,780 --> 01:19:42,540
And if it's less than the version of it that has one smaller number is also going to be less.

675
01:19:42,570 --> 01:19:46,350
So in this special case, the indicator functions are both zero.

676
01:19:48,440 --> 01:20:01,690
Right. And so everything involving log blood, urea, nitrogen, varnishes, we don't have the main effect.

677
01:20:01,700 --> 01:20:08,440
We don't have the main effect of lock blood or your nitrogen. So that's not in this hazard ratio.

678
01:20:08,470 --> 01:20:15,340
The only place log blood your inaction shows up is going to cancel both in the top and the bottom because these will both be zeros.

679
01:20:16,000 --> 01:20:21,850
So the hazard ratio is one all the way up through this.

680
01:20:23,530 --> 01:20:27,500
Point in time, we're log blood, urea, nitrogen plus one is less than 1.3.

681
01:20:28,120 --> 01:20:34,300
And after you get above 1.3, the hazard ratios of the beta three.

682
01:20:34,570 --> 01:20:38,350
But there's something in the middle here that we need to figure out still.

683
01:20:39,250 --> 01:20:44,410
So what about cases where log blood, urine, nitrogen is between 0.3 and 1.3?

684
01:20:44,830 --> 01:20:50,979
That's the part that we've never focused on before, because a one unit change has been meaningless.

685
01:20:50,980 --> 01:20:55,400
And every time we've seen this blind term up till now and now it's not meaningless.

686
01:20:55,420 --> 01:21:01,180
So. So what do we do here? So in the numerator, if you're in this range.

687
01:21:02,870 --> 01:21:06,049
Log blood your year log. Blood.

688
01:21:06,050 --> 01:21:10,120
Urea. Nitrogen plus one. In the top.

689
01:21:11,460 --> 01:21:17,090
That's going to be one. Right. When you're in this range, it doesn't matter.

690
01:21:17,100 --> 01:21:22,559
Even if I add the smallest number of point three, I'm still greater than 1.3.

691
01:21:22,560 --> 01:21:25,650
So that's going to be one in the numerator of this.

692
01:21:25,800 --> 01:21:30,180
This is the general formula for the hazard ratio. This is going to be a one indicator in the top.

693
01:21:32,750 --> 01:21:44,579
In the bottom? No. What's so jarring at the bottom, though, when you look at this indicator of log blood, urine, nitrogen greater than 1.3,

694
01:21:44,580 --> 01:21:59,490
that's going to be zero because even if I have the highest value of 1.3 here, you know, it's it's basically well, maybe right at that exact value.

695
01:22:00,860 --> 01:22:04,309
Um. No, even then, it's not going to be greater than 1.3.

696
01:22:04,310 --> 01:22:09,200
It'll be equal to 1.3. So that is going to be zero in the denominator as well.

697
01:22:10,710 --> 01:22:14,490
So this is where the formula is now.

698
01:22:15,180 --> 01:22:21,780
Interesting because the top formula will still have this beta three.

699
01:22:23,000 --> 01:22:28,340
Times log blood urination plus one -1.3 in the bottom won't have that term at all.

700
01:22:29,540 --> 01:22:38,330
So in this case, the hazard ratio every the age cancels, the hemoglobin cancels, but that top part still has each of the beta three.

701
01:22:38,900 --> 01:22:44,750
And then I've just sort of done the math for plus one -1.32 out of -0.3 here.

702
01:22:45,170 --> 01:22:52,970
So this is now a formula for the hazard ratio that depends on where your blood urea, nitrogen log is.

703
01:22:55,430 --> 01:23:01,249
So when there's a one unit change that small relative to the range of data values, it's not very exciting to report.

704
01:23:01,250 --> 01:23:08,870
This is around the table and I usually don't even show it, but in this case it's a big thing within the range of the data.

705
01:23:10,160 --> 01:23:18,049
So, you know, this is now a plot if if this variable is of scientific interest and you want to focus on it in a paragraph of the paper,

706
01:23:18,050 --> 01:23:25,120
this is now a plot. All right, so I.

707
01:23:27,940 --> 01:23:35,530
I guess this is another time for perk up moment. I know you guys are tired, but this is a new tool.

708
01:23:35,560 --> 01:23:40,840
MARTIN Go residuals or a new tool? You've never seen martingale residuals for any other model before.

709
01:23:41,050 --> 01:23:46,690
It only exists with censored survival data, and it's actually a very cool tool.

710
01:23:46,690 --> 01:23:51,550
But I'm going to convince you that it can help you figure out the functional form of covariates.

711
01:23:51,940 --> 01:23:58,370
And no other residuals really helped you do this as well as a morning go residuals.

712
01:23:58,370 --> 01:24:05,829
So just as a little bit of background, you know, you've seen residuals and linear regression and it's easy to define residuals.

713
01:24:05,830 --> 01:24:09,610
You've just looked at the observed minus the expected values in linear regression.

714
01:24:11,200 --> 01:24:16,630
It's a bit problematic to have that kind of thing for censored outcomes.

715
01:24:16,900 --> 01:24:22,240
If you observed all of the event times, you could do T minus its expected value.

716
01:24:23,110 --> 01:24:29,110
But you don't observe T for everybody. You have excise and sometimes excise related to a censored person.

717
01:24:29,440 --> 01:24:36,459
So t need not be observed and the expected value of T might not be something that

718
01:24:36,460 --> 01:24:40,000
you can estimate if you don't have enough follow up to see everybody's event.

719
01:24:40,930 --> 01:24:44,040
You can maybe do a restricted mean but you can't do the mean of t.

720
01:24:45,720 --> 01:24:51,690
So somebody came up with this idea of looking at martingale residuals.

721
01:24:51,690 --> 01:24:54,680
And I don't want you to get too bogged down in the actual formula.

722
01:24:55,250 --> 01:25:00,540
I have it here just so that you see it and you don't feel like it's some mysterious, black, boxy thing.

723
01:25:01,140 --> 01:25:06,570
I'm going to mainly focused on how to use them. So here's the formula.

724
01:25:06,580 --> 01:25:11,260
There's a baseline, cumulative hazard function that I really haven't talked much about.

725
01:25:12,160 --> 01:25:15,700
The Delta II is in here in the model that if it isn't here.

726
01:25:16,950 --> 01:25:23,250
But again, I don't want you to get bogged down on the formula. I want to really teach you how to use it to do data analysis.

727
01:25:24,120 --> 01:25:33,660
So one thing that is sometimes helpful to know is if it's a positive morning, your residual survival for that person was overestimated.

728
01:25:34,650 --> 01:25:40,020
And if it's a negative. MARTIN Gowers. The Jordan survival is underestimated for that person.

729
01:25:40,950 --> 01:25:45,180
So there's still something like not quite. If it's zero, it was perfectly fit, you know.

730
01:25:45,690 --> 01:25:49,049
But otherwise, it's positive is overestimated.

731
01:25:49,050 --> 01:25:57,209
Negative is underestimated. It does have this feel of, you know, observed minus expected values tend to sum to zero.

732
01:25:57,210 --> 01:26:01,290
So two of these martingale residuals. So.

733
01:26:01,290 --> 01:26:12,689
But this is how you use it. So. If we want to figure out the functional form of a covariate like our continuous covariates,

734
01:26:12,690 --> 01:26:20,190
are a lot of work to figure out the correct functional form. So if you want to figure out how to do that, you can do that with more to go residuals.

735
01:26:20,190 --> 01:26:27,780
So step one is that you have a model without any covariates in it and you calculate the morning go residuals.

736
01:26:28,200 --> 01:26:31,410
So often the null model is used here. That's what I tend to use.

737
01:26:31,860 --> 01:26:37,349
But you are calculating the morning of residuals without that covariate that you're trying to model,

738
01:26:37,350 --> 01:26:41,489
and maybe I just go with the null model most of the time that has no variables in it because

739
01:26:41,490 --> 01:26:45,870
then I can use this morning go residual to figure out functional forms of many covariates.

740
01:26:47,320 --> 01:26:52,690
Then there's the plot that we look at where the cover you want to model is plotted

741
01:26:52,690 --> 01:26:56,440
as the horizontal scale and the martingale residuals are the vertical scale.

742
01:26:56,530 --> 01:27:02,230
And you look at that plot and I'll show you examples in a moment of what that looks like and how you use it.

743
01:27:02,740 --> 01:27:06,399
Then the third thing is that you want a lowest line add to the plot,

744
01:27:06,400 --> 01:27:12,850
and this is helpful to spot the patterns that are suggestive of a good functional form of the covariate.

745
01:27:15,640 --> 01:27:19,460
All of this stuff the software will do for you. This is just the steps.

746
01:27:20,170 --> 01:27:27,280
Then to check to see whether the form of the covered is fine the way you already have it.

747
01:27:27,280 --> 01:27:31,480
You can calculate from a new model that has the coverage in it.

748
01:27:32,080 --> 01:27:36,190
In whatever functional form you decided you liked it, you calculate the margin,

749
01:27:36,190 --> 01:27:44,139
go residuals from that model and you put the lowest line on it and you take a look.

750
01:27:44,140 --> 01:27:51,490
And if the line with the version of the cover that you liked is looks kind of flat, then that's a good functional form.

751
01:27:52,360 --> 01:28:00,339
So the new plot. That is based on the model that had the in it in the functional form you thought was correct.

752
01:28:00,340 --> 01:28:04,630
You know, if you do that plot against the Mardi Gras residuals from that model,

753
01:28:04,930 --> 01:28:12,490
that should resemble random scatter about zero with a flat lowest curve if the covered has been modeled with a suitable functional form.

754
01:28:13,540 --> 01:28:21,700
So a lot of this is there's a lot to unpack here. So I think it's going to be useful to just see how this goes and what we learn from it.

755
01:28:23,420 --> 01:28:34,650
So when south. When you want to look at morning go residuals you save into some data said I'm calling it out P here.

756
01:28:36,580 --> 01:28:41,319
This stands for martingale residuals residuals martingale.

757
01:28:41,320 --> 01:28:44,740
Not like ari you're so smart, but residuals.

758
01:28:44,740 --> 01:28:47,770
Morning, Joe. And so I'm just saving them in this variable name, Mark.

759
01:28:48,430 --> 01:28:56,680
And this is the model with no covariates in it. So this is going to be my base model to sort of see what's going on.

760
01:28:57,280 --> 01:29:05,499
And I can plot these martingale residuals against any variable that I'm interested in and figuring out the functional form of.

761
01:29:05,500 --> 01:29:10,420
So here are two plot commands I decided not to show for age.

762
01:29:10,630 --> 01:29:12,880
I did do it, but I just didn't want to show it.

763
01:29:13,330 --> 01:29:19,930
I'm going to show you what it looks like when you plot the morning go residuals against the bloat log blood, urea, nitrogen variable.

764
01:29:20,500 --> 01:29:30,220
This is the one where a spline at 1.2 showed up or 1.31.3 showed up for us earlier when we did our forward model selection.

765
01:29:31,360 --> 01:29:43,380
And then here is another one against hemoglobin. And just to to remind us where we were before.

766
01:29:43,950 --> 01:29:51,830
You know, we had modeled this log blood, urine, nitrogen has a spleen that only pops in after 1.3.

767
01:29:51,840 --> 01:29:57,330
And we didn't put in any term for blood, urine, nitrogen, less than 1.3 in the model.

768
01:29:57,600 --> 01:30:04,200
So we would have been assuming the hazard ratio was one for one unit increase in this variable until 1.3 when it took off.

769
01:30:04,920 --> 01:30:12,690
And that's what we did just by, you know, looking at models, selections, plan, terms, tossed in and seeing what happened.

770
01:30:13,750 --> 01:30:20,140
And so we're going to plot the martingale residual for that choice as well and just see what it looks like.

771
01:30:20,770 --> 01:30:27,040
And we're going to look at the morning kills to draw with just hemoglobin in just as a linear term and see what it looks like.

772
01:30:30,040 --> 01:30:38,859
So it starting kind of the easier of the two is hemoglobin this one none of our supply in terms that we picked stuck when we did

773
01:30:38,860 --> 01:30:47,020
this before but this is the model without predictors plotted against hemoglobin and there's that it looks like there could be,

774
01:30:47,460 --> 01:30:48,910
you know, some bends here.

775
01:30:48,910 --> 01:30:57,400
So it's not clear whether you we should be trying to fit a straight line all the way through here or if we should check spline terms here in here.

776
01:30:57,970 --> 01:31:01,720
But that's how you look at these plots for things that you might want to check.

777
01:31:02,530 --> 01:31:08,800
And so maybe spline terms at ten or 12 or a linear shape.

778
01:31:10,460 --> 01:31:17,210
And so behind the scenes, I did check blind terms at 1012 and they were not statistically significant.

779
01:31:17,750 --> 01:31:25,610
So to see whether just hemoglobin by itself as a linear term without any lines is okay.

780
01:31:26,480 --> 01:31:28,940
I'm going to show that morning your plot in a minute.

781
01:31:32,300 --> 01:31:41,240
And so here is the after fitting the model that had all the predictors in it, including a linear hemoglobin variable, the lowest curve.

782
01:31:41,240 --> 01:31:45,110
It still has a little bit of a thing here, but it looks almost flat.

783
01:31:46,280 --> 01:31:56,149
So it you know, for me, the fact that this flattened out almost all the way suggests that linear hemoglobin term probably works well.

784
01:31:56,150 --> 01:32:00,710
And I checked the only other version that was suggested by the plot, and it wasn't significant.

785
01:32:04,940 --> 01:32:07,670
So here's the log. Blood, urea, nitrogen.

786
01:32:08,630 --> 01:32:16,370
And this is from the model without predictors and plotting the morning air as it was against let blood log blood urea nitrogen.

787
01:32:17,000 --> 01:32:20,310
And there's you know there's a little bit of a shape here, too.

788
01:32:20,360 --> 01:32:25,579
So you look at this shape and you say, well, what if I was modeling this particular shape?

789
01:32:25,580 --> 01:32:28,880
What would I use? That's how you're looking at these residual plots.

790
01:32:29,510 --> 01:32:39,620
And so maybe a quadratic term should be checked because it looks kind of like maybe it's a quadratic or maybe it's just a bend.

791
01:32:40,860 --> 01:32:44,909
And it's just a slope here and a slope here. That's certainly how we did it before.

792
01:32:44,910 --> 01:32:48,270
We had a bend at 1.3, which would be around here.

793
01:32:50,400 --> 01:32:54,320
And but there's a lot of ambiguity of where that ban would be.

794
01:32:54,330 --> 01:32:57,590
So, I mean, maybe the ban should be at 1.2.

795
01:32:57,600 --> 01:33:01,310
You know, it's really hard to say. But there's.

796
01:33:01,580 --> 01:33:06,860
So those are the things that when I look at the plot, I, I say try a quadratic,

797
01:33:06,860 --> 01:33:11,480
maybe try a slightly different bend point than the 1.3 we just stumbled upon.

798
01:33:13,690 --> 01:33:18,550
So maybe there's a possible split at one point to or maybe there's a quadratic form of this variable.

799
01:33:19,550 --> 01:33:30,080
So remember we'd found a significant spline term at 1.3, but now we're going to look at 1.2 maybe as a better choice and looking at quadratic terms.

800
01:33:30,080 --> 01:33:33,889
And so here is just for reference.

801
01:33:33,890 --> 01:33:43,040
This is the morning gill residual plot when we put in the log blood, urea, nitrogen with the spleen at 1.3, the one we stumbled across.

802
01:33:43,790 --> 01:33:48,559
And so the lowest curve still has a little bit of curvature here.

803
01:33:48,560 --> 01:33:53,450
I mean, maybe it's okay, but there might still be some improvement we can do.

804
01:33:54,780 --> 01:34:01,380
So let's see what the other. It suggested choices do for us.

805
01:34:02,490 --> 01:34:07,170
All right. So this is a big bunch of code here, but the important parts are in yellow.

806
01:34:07,590 --> 01:34:12,300
So I'm creating a spleen term that bends at 1.2 instead of 1.3.

807
01:34:12,330 --> 01:34:18,630
We're going to look at that. And then I'm creating a quadratic term for log blood, nitrogen, and I'm going to look at that.

808
01:34:19,260 --> 01:34:23,880
And so this is, you know, several different models.

809
01:34:24,960 --> 01:34:32,100
This is one where I use a term for log blood, urine, oxygen smaller than 1.2.

810
01:34:32,100 --> 01:34:40,050
And then the spline term here is a version of the model where I just have this blind term, but not this main log band term.

811
01:34:40,860 --> 01:34:46,590
And here is a version of the model where I have the linear in the quadratic terms both in there.

812
01:34:47,560 --> 01:34:54,240
All right. So these are all choices that could have been suggested by that morning, gale residual shape.

813
01:34:56,540 --> 01:34:59,000
And so here's kind of a summary of what happened.

814
01:34:59,450 --> 01:35:09,470
I didn't put all the output here, but the check of the spline term for LaGuardia in action at 1.2 instead of 1.3 did not improve model fit.

815
01:35:11,270 --> 01:35:21,679
Or the martingale residual plot. So the comparison of those models showed that the AIC for 1.3,

816
01:35:21,680 --> 01:35:26,450
the one we just stumbled across, was even a little bit lower than the AIC when we used 1.2.

817
01:35:26,960 --> 01:35:31,430
And I didn't bother showing the Martinsville residual plot just because it was very similar to the one we already saw.

818
01:35:32,090 --> 01:35:36,430
So that move, just moving this line term around didn't help.

819
01:35:38,210 --> 01:35:41,840
The check out the quadratic form a block blood you're engaged in did show some

820
01:35:41,840 --> 01:35:49,130
minor improvement in AIC compared to that version where we used 1.3 as our spline.

821
01:35:49,460 --> 01:35:53,720
So it just goes down the slightest bit compared to this other model.

822
01:35:53,990 --> 01:35:57,080
So we might as well go and see what that looks like.

823
01:35:57,080 --> 01:36:03,710
So here is the model with the quadratic term added in to the linear term for log blood, urine, nitrogen.

824
01:36:05,570 --> 01:36:10,190
You've got some interesting p values here. The leaf looks very attractive.

825
01:36:10,760 --> 01:36:15,890
They both are telling the story that it's bad to increase, you know.

826
01:36:17,150 --> 01:36:26,560
And here is the. The lowest curve for the model where you had age, hemoglobin and log blood here nitrogen and the quadratic term for that.

827
01:36:28,080 --> 01:36:31,960
And the lowest curve is a beautiful flat looking thing here.

828
01:36:31,980 --> 01:36:38,160
This suggests we've really stumbled across a pretty good version of this predictor in the model.

829
01:36:41,520 --> 01:36:45,900
And here's our code for all the similar kind of stuff that we have.

830
01:36:47,580 --> 01:36:53,100
So for four, are you want to have this type equals?

831
01:36:53,100 --> 01:37:02,310
Martin Gill When you are using this residual command, so you do the usual Cox model, you save everything and in this null dot form.

832
01:37:04,000 --> 01:37:09,970
Sorry. You save everything in this nanobot fit based on this equation you use for the formula for the no.

833
01:37:11,300 --> 01:37:16,130
And then you use this residuals function and with typical morning goal to get your martingale residuals.

834
01:37:18,310 --> 01:37:26,860
And here I'm doing just various plots based on, you know, the various martingale residuals.

835
01:37:27,840 --> 01:37:33,590
Here's with Lord. But you're a nitrogen. And here is with hemoglobin.

836
01:37:34,960 --> 01:37:41,650
The line's part is putting the lowest line on there. And I, I don't generally change any of the options.

837
01:37:41,650 --> 01:37:44,200
This is a smoothing parameter. I just leave it as it is.

838
01:37:45,130 --> 01:37:52,090
This AB line is creating a straight line at zero just so we can see how close the lowest line is to two zero.

839
01:37:53,260 --> 01:38:03,300
And here is a plot. Where I've put in now the recovery with the spine at 13, just like we did in the south.

840
01:38:03,870 --> 01:38:08,430
And doing that morning go residual plod here this one with.

841
01:38:12,350 --> 01:38:17,149
Oh, this was just fitting. The mall here is doing the plot, kind of all of this stuff.

842
01:38:17,150 --> 01:38:19,790
If you go through, it's mimicking what we did in South.

843
01:38:19,820 --> 01:38:29,120
Here is the plot of hemoglobin when we're comparing it against the Mardi Gras residuals that used all these covariates over here.

844
01:38:30,770 --> 01:38:38,330
And in are sometimes these morning our residual plots look a little bit different just because the smoothing algorithm is a little bit different.

845
01:38:38,360 --> 01:38:46,490
So again, when you're working on your homework, depending on if you're using SAS or are the morning, a residual story might look slightly different.

846
01:38:46,640 --> 01:38:49,970
It shouldn't change dramatically, but sometimes it looks different.

847
01:38:51,400 --> 01:38:57,670
We're having the same pattern here with hemoglobin of maybe a spleen at ten and 12 that we see here.

848
01:38:58,840 --> 01:39:03,050
And that when you put in linear hemoglobin, it's more or less a flat.

849
01:39:03,070 --> 01:39:09,160
So this is pretty close to what we saw in South. Here's looking at blood, urine, nitrogen,

850
01:39:09,160 --> 01:39:19,540
and that may be quadratic may maybe blinding the shape where you see a band is slightly looking different in are but not totally different.

851
01:39:20,320 --> 01:39:25,330
And this is you know it flattens out a little bit when you put in the spine at 1.3.

852
01:39:25,330 --> 01:39:27,580
But it's, you know, there's room for improvement.

853
01:39:29,320 --> 01:39:37,330
And then here is putting in this is creating the variable that is the quadratic term and saving that in a variable name log,

854
01:39:37,330 --> 01:39:43,990
blood, urine, nitrogen askew, putting that in the model and then doing the martingale residual plots.

855
01:39:45,420 --> 01:39:50,010
And it looked a lot nicer in Sass when we did the plot in South.

856
01:39:50,010 --> 01:39:54,050
It looks so flat, you know. But here we still have it.

857
01:39:54,100 --> 01:39:58,920
It still looks a little bendy. But still near zero.

858
01:40:00,560 --> 01:40:06,470
So. So you'd feel a lot better after doing it. And staff were saying it was flatline and ah, it's like, have I really finished here?

859
01:40:07,040 --> 01:40:10,100
And it's just the smoothing algorithm is slightly different between those two.

860
01:40:12,780 --> 01:40:24,110
Okay. So. So that is basically what I use martingale residuals for, just to figure out functional forms of continuous covariance.

861
01:40:24,620 --> 01:40:35,570
I don't use them to find outliers in this plot is kind of an example of why martingale residuals are constrained to be between minus infinity and one.

862
01:40:36,680 --> 01:40:46,870
So here's the zero way up here. And there's half of the residuals on top and half on the bottom, but they're really spread out on the bottom.

863
01:40:46,870 --> 01:40:56,590
And so it's kind of hard to spot outliers with these scales so crunched between zero and one and so spread, you know, on the bottom side,

864
01:40:57,310 --> 01:41:05,230
so hard to identify outliers versus just the natural skew that happens with the constrained range or the weird range.

865
01:41:05,770 --> 01:41:09,999
And so what people do instead is they look at deviance residuals.

866
01:41:10,000 --> 01:41:15,160
So in these sentence, survival models are going to have a lot of different residuals, not just one flavor.

867
01:41:15,640 --> 01:41:20,500
So deviants residuals are better than morning gal residuals for finding outliers.

868
01:41:20,500 --> 01:41:26,140
And so. I wanted to give you the formula just so doesn't feel like a black box to you.

869
01:41:26,150 --> 01:41:29,209
It does involve the martingale residuals in it.

870
01:41:29,210 --> 01:41:34,910
And basically it's just kind of changing the scale of the morning go residuals.

871
01:41:34,910 --> 01:41:40,430
So it looks more like a residual plot we would see for other models like linear regression.

872
01:41:41,620 --> 01:41:44,889
So the effect of, you know, I don't again, I don't want you to get too bogged down here,

873
01:41:44,890 --> 01:41:53,970
but the effect of the law is to disperse the morning go residuals close to one and pull in large negative martingale residuals whenever one is zero.

874
01:41:53,980 --> 01:41:59,049
The other residual type is also zero. So a good fit is a good fit, regardless of which one you're looking at.

875
01:41:59,050 --> 01:42:05,530
But the range is going to be shifted around when you're positive.

876
01:42:05,530 --> 01:42:08,709
Survivals overestimated, just like it was with morning your residuals.

877
01:42:08,710 --> 01:42:12,580
And when they're negative, it's underestimated. So that direction hasn't changed.

878
01:42:13,210 --> 01:42:20,110
These don't sum to zero as morning go residuals do so I mean that's a detail that's not really that interesting.

879
01:42:20,110 --> 01:42:29,110
Actually in SAS you can ask for the deviance residuals with this RC Aria's TV command

880
01:42:29,110 --> 01:42:33,399
and there's a type command for the residuals option R that we'll see in a minute.

881
01:42:33,400 --> 01:42:37,450
Oh, it's right here. So type equals deviance with the Residuals Command.

882
01:42:37,450 --> 01:42:43,090
After you've saved everything into this fit variable, we'll give you deviance residuals.

883
01:42:43,690 --> 01:42:48,280
And so here's an example of deviance residuals and how they look, you know,

884
01:42:49,180 --> 01:42:55,059
so a lot more like the spread around zero that you would see with linear regression.

885
01:42:55,060 --> 01:42:58,840
And so you can kind of ease the more easily see what?

886
01:43:00,120 --> 01:43:08,990
You know, individuals might have unusual values on the top down, all crushed up against one and on the bottom as well.

887
01:43:09,000 --> 01:43:14,700
So here's the zero, which is like really great, perfect fit.

888
01:43:15,000 --> 01:43:20,010
And then all of the individuals up on the positive side had overestimated survival by a bit,

889
01:43:20,010 --> 01:43:24,000
and all of the people on the bottom side had underestimated by a bit.

890
01:43:24,450 --> 01:43:32,370
And this is, you know, you can just sort of pick up some people and and see who were the most off from what the model predicted.

891
01:43:35,580 --> 01:43:45,959
Okay. So I'm looking here more on Cox Model Diagnostics, and I think this is a good it's a good stopping place.

892
01:43:45,960 --> 01:43:50,840
I did actually promise we'd end 5 minutes earlier, even though I ended up having a longer break than I thought.

893
01:43:51,270 --> 01:43:55,169
But let's this is a good stopping place. Let's start here next time.

894
01:43:55,170 --> 01:43:56,010
Slide 32.

