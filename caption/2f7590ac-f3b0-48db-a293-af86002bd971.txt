1
00:00:03,620 --> 00:00:10,160
Welcome to. Welcome back to the lecture to other it's topic material so.

2
00:00:12,530 --> 00:00:16,590
So these lectures are supposed to talk about other topics.

3
00:00:17,030 --> 00:00:30,349
Part two the slide which is not the part of the in-person lecture planned, but because I have to speed around some of those later parts of slide,

4
00:00:30,350 --> 00:00:37,190
I just wanted to give some more explanation before we're going to do that advanced lecture slides.

5
00:00:37,190 --> 00:00:44,839
I'm going to go through this collapse, exercise a little bit more to have a more comprehensive explanation.

6
00:00:44,840 --> 00:00:48,590
What I meant to explain.

7
00:00:48,590 --> 00:00:52,970
So this is that this is where I left from the previous.

8
00:00:55,420 --> 00:00:59,150
You. Previous slide, but let me just go through this.

9
00:00:59,540 --> 00:01:02,960
So I went through this Heidi one rubidium.

10
00:01:04,640 --> 00:01:10,330
Test itself. Well, but let me just go through quickly.

11
00:01:10,360 --> 00:01:14,550
So this is the Hollywood movie Equilibrium Test using the Chi Square test.

12
00:01:14,740 --> 00:01:24,070
Basically, you are getting the observed genotype count and expected taken to be a calculating little sequence from the.

13
00:01:25,910 --> 00:01:32,629
That, you know, I can't you can't tell frequency. And based on their frequency, you can calculate how they won't be accurate.

14
00:01:32,630 --> 00:01:38,210
Do you expect these you know the frequencies and you can calculate the chi square statistic in this way.

15
00:01:39,050 --> 00:01:50,450
And this is a this is supposed to follow the type of high security distribution with the degree of freedom one with under the null discussion.

16
00:01:50,450 --> 00:01:55,250
So there was a question about the whether this was a free freedom, one or two degrees of freedom two.

17
00:01:55,670 --> 00:02:01,819
But basically, under the no, you have you have two parameters and two at 12 frequencies.

18
00:02:01,820 --> 00:02:09,170
And the under the under the alternative hypothesis, you have a three unknown frequencies.

19
00:02:09,170 --> 00:02:18,660
So basically you have a one degrees of freedom difference. So, so if you probably need a little bit of advanced knowledge of the.

20
00:02:20,440 --> 00:02:26,709
Likelihood ratio, testing the six two staff to understand the degrees of freedom expected.

21
00:02:26,710 --> 00:02:36,520
If you didn't fully understand that point. And we went through this simulation where you simulate the genotype on the perfect value of

22
00:02:36,520 --> 00:02:42,880
utopia and the P value becomes one and chi skipping chi square value becomes exactly zero.

23
00:02:43,630 --> 00:02:52,140
But if we simulate the case where there's two, two, so you have a two population, European population,

24
00:02:52,160 --> 00:02:58,000
African population, and they assume that they have different daily frequencies but follow.

25
00:02:58,330 --> 00:03:04,810
Heidi Weinberg Exactly. But in that case, if you add the genome taken together,

26
00:03:05,110 --> 00:03:11,979
so there's a 10,000 individuals from the European, these are 5000 individuals for Africa individuals.

27
00:03:11,980 --> 00:03:21,190
If you mix them together, then those genotype count basically does not follow, does not come from the high hadaway bacterium.

28
00:03:21,460 --> 00:03:29,380
And you have some a little bit of depletion compared to the expected genotype frequency for the heterozygous

29
00:03:29,770 --> 00:03:35,950
observed genotype frequency for the heterozygous is a slightly smaller than the what you would expect.

30
00:03:36,220 --> 00:03:42,129
And that's what I wanted to go through. And in this part I really speed ran.

31
00:03:42,130 --> 00:03:48,100
So I try to go, I want to explain a little bit more comprehensively.

32
00:03:48,100 --> 00:03:54,190
So if you think you understood this part, you could skip this part.

33
00:03:55,330 --> 00:04:07,180
So we download the data from that thousand genomes that are about 44 megabits region to chromosome 19 as you see here and.

34
00:04:10,440 --> 00:04:14,570
Then we're loading the European population here.

35
00:04:14,580 --> 00:04:24,770
So if you see the data here, there, I prepared data for each of the population so you can take the African continent, the population,

36
00:04:24,810 --> 00:04:37,020
the Americans, the admixture, American or East Asian or European or South South Asian or you can use the all which is about 2500 samples together.

37
00:04:37,020 --> 00:04:40,290
We're going to go through that again.

38
00:04:41,490 --> 00:04:44,940
But so let's try to load the European data first.

39
00:04:44,940 --> 00:04:49,230
And if you look at how that data looks like, this is how the data looks like.

40
00:04:49,830 --> 00:04:54,870
What we saw for each of the individual that each genotype so encoded zero or one or

41
00:04:54,870 --> 00:05:00,120
two and we're going to use these that you don't want to include genotypes to test.

42
00:05:00,960 --> 00:05:13,740
How do you own bacteria? So what we are going to do here is that we will take these genotype data from that that are encoded zero two,

43
00:05:14,550 --> 00:05:20,440
zero one and two and take convert them into the matrix.

44
00:05:20,440 --> 00:05:23,659
So the zeros and ones in two. So these are the number of zeros number.

45
00:05:23,660 --> 00:05:26,910
The ones and twos in that matrix.

46
00:05:28,550 --> 00:05:38,450
And but the matrix itself is actually the have a 19 more than 19,000 low rows in a 503 column.

47
00:05:38,450 --> 00:05:45,140
So there are 19,000 variants and 500 individuals are lovely.

48
00:05:46,920 --> 00:05:53,190
And what we are doing is that for each of those variants and 19,000 variants, you can calculate that frequency.

49
00:05:53,580 --> 00:05:58,250
So the way you can calculate daily frequency when the genotypes are included, is as you don't.

50
00:05:58,290 --> 00:06:07,589
And until you can simply calculate the mean and that, you know, that mean will will vary between the 0 to 2 and you divide by two.

51
00:06:07,590 --> 00:06:13,020
That becomes all the frequencies and you can calculate the genotype, counseling,

52
00:06:13,020 --> 00:06:17,970
zeros and one and two for each of the variants, you can calculate the genotype count for each of the B.

53
00:06:18,600 --> 00:06:27,719
And then what this part is doing is we're making a data frame to visualize.

54
00:06:27,720 --> 00:06:35,940
So this p zero is basically the in the proportion of the homozygous genotype among all samples.

55
00:06:35,940 --> 00:06:40,169
So this is, you know, proportion of homozygous genotype.

56
00:06:40,170 --> 00:06:49,820
So the genotype frequency of one, which I use a genotype frequency of heterozygous in Jyoti, frequency of homozygous B,

57
00:06:50,090 --> 00:06:57,120
B and p one that h w e here is that because we calculate the Olympic quantities we're using,

58
00:06:57,360 --> 00:07:02,820
we're using this how this would be calibrated expectation to calculate the probability of heterozygous

59
00:07:03,390 --> 00:07:09,870
on the under the high the won't actually be so in the we're just plotting them each of them.

60
00:07:09,880 --> 00:07:18,120
So we're plotting p zero as a red red line P one as a green line and p two is a blue like the blue dots.

61
00:07:18,120 --> 00:07:26,520
I mean, but these are, these are dots. And the expectation from the hydrogen equilibrium, we're showing this in a line.

62
00:07:26,730 --> 00:07:35,010
So that's what this is doing. So then this is a visualization that you just saw in the class.

63
00:07:35,250 --> 00:07:39,899
So this is the you know, this this is a blue line.

64
00:07:39,900 --> 00:07:49,290
So this is a homogeneous pb LDL sort to tell you to actually, you know, in this case, you don't want to encoding.

65
00:07:49,830 --> 00:07:53,370
And this is a little frequency of our channel.

66
00:07:53,880 --> 00:08:02,950
Okay. And. And this this is a freak of frequency of heterozygous genotypes.

67
00:08:03,520 --> 00:08:11,700
So what is what's here? What I'm trying to show here is that mainly try to compare this green line and this black line.

68
00:08:12,070 --> 00:08:20,820
So green green is not a line. Green points are the observed frequency of heterozygous phenotype.

69
00:08:20,840 --> 00:08:29,950
So and and zxi cell frequency and Y-axis are genotype frequency of heterozygous geotag, if you look at only the green dots.

70
00:08:30,610 --> 00:08:36,760
So and what it shows is that this is a function of this frequency.

71
00:08:37,150 --> 00:08:42,400
And this black line is basically what you would expect under the headline Weinberg equilibria.

72
00:08:42,940 --> 00:08:51,070
Then and these green dots there's a follow this heading where the expectation from the Hathaway McLuhan pretty well.

73
00:08:51,340 --> 00:08:54,420
So that's what it's trying to show. Okay.

74
00:08:55,680 --> 00:09:02,420
And let me go through a little bit more because I did I wanted to go through this, too, and what you can do, he said.

75
00:09:02,430 --> 00:09:06,480
Now you have a genotype count for the oldest homozygous heterozygous in.

76
00:09:08,620 --> 00:09:17,800
Homozygous BP alleles. So you have a genotype count for each of the variants so you can test the hardy one because different for each of them.

77
00:09:18,100 --> 00:09:22,510
So this this is basically 19,000 by three matrices.

78
00:09:23,020 --> 00:09:27,129
And for each of the 19,000 bite down to 19,000 variants,

79
00:09:27,130 --> 00:09:36,430
you can run this hardy the equilibrium test and calculate the p value and just get all the p values here.

80
00:09:36,820 --> 00:09:50,100
Okay. And if you visualize the distribution of this hardware rupee value, basically what you are seeing here is that these P values are almost I mean,

81
00:09:50,130 --> 00:09:57,810
it's a it's disputed almost uniformly, but there are enrichment of the small p value.

82
00:09:57,810 --> 00:10:04,140
This means that there are some for a proportion of variance of there are about 19,000 variance in total.

83
00:10:04,470 --> 00:10:10,170
So excesses that lawfully I would say about 800 variance or something is.

84
00:10:10,860 --> 00:10:20,690
So if you assume that this is a this is a lovely far away the flat line, there's some enrichment of the significant the variance here.

85
00:10:20,700 --> 00:10:29,130
So those variance of likely the variance that are you know, deviating from highly, highly way material for various regions.

86
00:10:29,370 --> 00:10:34,230
And, you know, we talked about the possible regions in the class.

87
00:10:34,800 --> 00:10:38,100
Okay. So it may it's the data is not perfect.

88
00:10:38,100 --> 00:10:44,540
And that's why in the we do see quite a bit of actually very variance and not conforming to Hollywood with Caribbean.

89
00:10:45,330 --> 00:10:51,390
So one way to look at the P value distribution is looking at the histogram of a P values.

90
00:10:51,810 --> 00:10:57,150
But another way to do it is to show the Q plot of.

91
00:10:58,020 --> 00:11:02,590
Sorry, I need to load. She applied again here.

92
00:11:02,980 --> 00:11:10,250
So I'm coming back here. And if you show the cute couple out here.

93
00:11:10,620 --> 00:11:25,250
Okay, so this is what you see. So if you give me you if you're not familiar with the cookie plot, you can refer to the material from the 650 or 651.

94
00:11:25,730 --> 00:11:36,930
So this is the expected load and p value in the y axis, in the x axis in the way x is observed lower than p value.

95
00:11:36,950 --> 00:11:41,900
So if if the this follows this line.

96
00:11:42,050 --> 00:11:47,990
So they go on on line, then that means that the p value distribution follows the normal pretty well.

97
00:11:48,440 --> 00:11:59,900
And if you if you see the image amount like this, so of the significant p value, that means that there are some, you know.

98
00:12:01,100 --> 00:12:04,730
So. So at the end of the tale, there is some.

99
00:12:06,560 --> 00:12:12,190
In the significant deviation from from the null.

100
00:12:12,200 --> 00:12:13,610
So that's what you see.

101
00:12:13,620 --> 00:12:25,249
So in this review is more clear that there is a lot of variance, probably 10% of variance or so that that looks like a deviates from the expectation.

102
00:12:25,250 --> 00:12:33,920
But most of the variance in 90% or so variance are conforming to this expect, you know, distribution pretty well.

103
00:12:33,930 --> 00:12:43,730
So here what the both of the plus shows that maybe the majority of variance or 90% of variance, it follows the null distribution very well.

104
00:12:44,090 --> 00:12:51,350
But there are variance that that are not following the null that switch in very well that that's what this plot is trying to show.

105
00:12:51,920 --> 00:13:02,570
Okay. So that's what I wanted to review fully if I had enough time for the.

106
00:13:03,630 --> 00:13:10,260
For this part. But I wanted to do one more thing just to to do this.

107
00:13:10,770 --> 00:13:16,510
So I encourage you to try with the other population, afar, AMA and so on.

108
00:13:16,530 --> 00:13:19,980
And you're going to see many interesting patterns.

109
00:13:20,730 --> 00:13:28,590
But if you put all in, this means that we're just loading all populations to you, that this is a cosmopolitan sample,

110
00:13:28,590 --> 00:13:35,160
that it'll take quite a bit of time to load this data because there's a 2500 samples.

111
00:13:35,370 --> 00:13:40,950
So it's quite, quite a large, large number of large data and the data loading takes time.

112
00:13:41,580 --> 00:13:46,980
So but if you load this large, you know, cosmopolitan data.

113
00:13:47,520 --> 00:13:51,900
So do you expect that the genotype frequency follows the highway bacterium?

114
00:13:51,930 --> 00:13:58,799
That's what I wanted to ask. Okay. So the data looks I mean, it's a similar format.

115
00:13:58,800 --> 00:14:04,350
You now have a more variance of 26,000 variants because it's a larger number of samples.

116
00:14:06,130 --> 00:14:11,800
And we can we can redo the same procedure until we show those.

117
00:14:12,190 --> 00:14:19,740
These are the genotype frequencies, blood we have seen before with a with the green dots and so on.

118
00:14:19,750 --> 00:14:26,140
So let me let me try to load up to there so we can capture the daily frequencies.

119
00:14:28,360 --> 00:14:33,210
For for this pool data. And we can we can be through this plus.

120
00:14:33,220 --> 00:14:40,210
So remember, this is what it what it looked like in the European subset of samples.

121
00:14:40,840 --> 00:14:47,640
Now, if you see this for. Are all samples, okay?

122
00:14:47,730 --> 00:14:53,550
Of course. Across all population. This is what you observe.

123
00:14:54,390 --> 00:15:06,150
So, look, I mean, it looks similar, but what's different here is that these green dots are all below this black line,

124
00:15:06,150 --> 00:15:10,110
which is the expected expected value in the hideaway local area.

125
00:15:10,710 --> 00:15:22,410
So the heterozygous genotype frequencies are below, below, then smaller than what you would expect under the Hadley one because of you.

126
00:15:22,740 --> 00:15:27,780
And the. Why is that? It is because the random meeting assumption doesn't work.

127
00:15:27,900 --> 00:15:34,860
So this is a cosmopolitan population. So there are some inbreeding happens within within the population.

128
00:15:34,860 --> 00:15:42,790
So I mean, in the countries that have all people living in the same continent or tend to mate together and they have different daily frequencies.

129
00:15:42,810 --> 00:15:47,100
So as you as you saw actually in this example.

130
00:15:47,490 --> 00:15:56,010
So this is a related example. So as you saw in this example where, you know, if you mix multiple population together.

131
00:15:56,310 --> 00:16:07,230
Okay. Then you you do see some depletion of heterozygous genotype frequency than what's expected by the by the way, with Colombia.

132
00:16:07,260 --> 00:16:13,440
So you have a you know, this is a depletion, you know, compared to the high one weekly expectation,

133
00:16:13,440 --> 00:16:23,159
you're seeing about 4% that the depletion of depletion of the heterocyclic ali frequencies.

134
00:16:23,160 --> 00:16:29,850
And you're basically seeing the same thing. You're seeing some depletion of the heterozygous genotype across most of the variants.

135
00:16:30,180 --> 00:16:33,840
So that's why you see these green, green dots below.

136
00:16:34,890 --> 00:16:43,180
These are. These are black line, and that's called a wound effect.

137
00:16:43,660 --> 00:16:47,440
So these the next two slide are basically trying to explain that.

138
00:16:47,980 --> 00:16:55,800
So if you if you use these call up notebooks and try to generate this plot for the European population,

139
00:16:55,810 --> 00:16:59,530
African population, there are some some outliers that we can explain.

140
00:16:59,540 --> 00:17:03,580
And those are those are variance that doesn't conform to the hardware more closely.

141
00:17:04,390 --> 00:17:15,700
But you know this if you just compare with this focus on these green dots and black line, they they conform pretty well to each other.

142
00:17:15,850 --> 00:17:18,820
Okay. They they match it pretty well.

143
00:17:19,510 --> 00:17:31,620
But here, when you mix a multiple population together, you are you're going to see more depletion of heterozygous variants.

144
00:17:32,020 --> 00:17:36,790
So this is across all ancestry then than what you would expect.

145
00:17:38,260 --> 00:17:41,540
What you see per population here.

146
00:17:41,560 --> 00:17:45,760
So this is a European population, African ancestry.

147
00:17:45,760 --> 00:17:48,760
So Europe is a for a continent continental population.

148
00:17:48,760 --> 00:17:53,540
You can you can draw that. But if you pull them together, you see that.

149
00:17:53,540 --> 00:18:00,949
So this is called the Walden effect and that this is this well-known effect of the media strategy positive.

150
00:18:00,950 --> 00:18:04,340
You pull multiple populations together.

151
00:18:05,510 --> 00:18:09,950
So there is there is some you might ask a question,

152
00:18:09,950 --> 00:18:14,359
what would be the adequate way to perform Haiti when we clearly of testing of cosmopolitan

153
00:18:14,360 --> 00:18:22,820
populations and one of your reading recommended reading actually tackles this particular problem.

154
00:18:24,350 --> 00:18:27,139
Okay. And we went through this slide.

155
00:18:27,140 --> 00:18:37,100
And so I'm going to just explain very briefly so basically how the way we rubidium test is useful to distinguish whether,

156
00:18:37,670 --> 00:18:44,900
you know, the genotype calling was done very well for the snip when snip anybody genotyping in this particular case.

157
00:18:45,410 --> 00:18:48,460
So. You have.

158
00:18:50,240 --> 00:18:59,690
So. ELLIOTT So in this case, those three the proportion of those three genotypes follows conforms to how they were.

159
00:18:59,930 --> 00:19:05,030
How do you want to be clear with him? Very, very well. But in this case, if it was Miss Cold, how do you want to be clear?

160
00:19:05,030 --> 00:19:10,609
What him? It's not going to follow very well. And the same thing is going to happen in this case.

161
00:19:10,610 --> 00:19:13,850
So this is a well, well called genotype.

162
00:19:14,210 --> 00:19:19,460
So genotype frequencies should of conform to the hardware more clearly very well.

163
00:19:19,820 --> 00:19:24,490
But in this case, where there is a some calling mistake happening.

164
00:19:24,710 --> 00:19:27,770
So clustering wasn't done very well in that case.

165
00:19:28,190 --> 00:19:31,399
Hello. Could there could be some violation of the alibi.

166
00:19:31,400 --> 00:19:37,100
You could be a and that's one way to do the quality control in that, you know, it's okay.

167
00:19:38,260 --> 00:19:43,900
So that was the summary of the slide. And I just wanted to cover this part.

168
00:19:44,120 --> 00:19:53,679
You know, I, I don't think everyone has to listen to this, but if you wanted to digest the material better,

169
00:19:53,680 --> 00:19:58,600
I think I hope that this additional lectures are helpful.

170
00:20:00,060 --> 00:20:06,740
So, you know, these are the recommended reading and some of them are but part of the presentation detail.

171
00:20:06,750 --> 00:20:10,980
So you will have a chance to select some of this readings if you want.

172
00:20:12,850 --> 00:20:21,610
So now this is really the content I wanted to cover for for this additional or no lecture.

173
00:20:22,180 --> 00:20:28,180
So the reason why I wanted to do this is because I, you know, this part is more advanced than I thought,

174
00:20:28,180 --> 00:20:31,740
that we probably don't have enough time to cover this, which was actually true.

175
00:20:31,750 --> 00:20:38,660
And I actually, you know, didn't have, you know, enough time to cover the former part, you know?

176
00:20:39,720 --> 00:20:50,620
So so but this this is a this is a useful thing to learn if you're more interested in doing more other events, this stuff.

177
00:20:50,890 --> 00:20:56,469
So I'm going to occasionally create a lecture slide that that is recommended to watch.

178
00:20:56,470 --> 00:21:00,370
But, you know, you don't it's not going to part of the evaluation.

179
00:21:00,640 --> 00:21:04,030
So it's not going to be the midterm you to get. So.

180
00:21:06,570 --> 00:21:10,910
So we talked about the performing the Chi Square test in the orchestra test.

181
00:21:11,100 --> 00:21:14,219
We we said that in may not be creative.

182
00:21:14,220 --> 00:21:18,630
The simple stage is small or a frequency is very rare.

183
00:21:18,990 --> 00:21:23,400
So in that case is we can instead perform the exact test.

184
00:21:24,000 --> 00:21:30,440
So the test is that without approximating the p value, you can calculate the p value.

185
00:21:30,450 --> 00:21:34,839
Exactly. Okay. What does that mean? So Chi chi square test.

186
00:21:34,840 --> 00:21:39,419
It may not be accurate for our variance because it's relying on these asymptotic

187
00:21:39,420 --> 00:21:44,580
distribution where with which should follow the simple stage large enough,

188
00:21:44,970 --> 00:21:50,370
but for the very variants that there is some genotype that doesn't have very large count.

189
00:21:50,790 --> 00:21:55,680
So if the count, the small does, this p value may not be reliable.

190
00:21:56,340 --> 00:22:03,060
So you can try to identify the exact distribution of these each region of that configuration and the cultural these daily counts.

191
00:22:03,390 --> 00:22:16,670
How how do you do that? Basically what what you can try to do is that you can accumulate the probability of a specific genotype count observation.

192
00:22:17,040 --> 00:22:24,890
Okay. And the p value is basically what if the null hypothesis is true?

193
00:22:24,920 --> 00:22:32,930
So assuming that the high wave equilibrium is true, what's the probability to observe this data?

194
00:22:33,230 --> 00:22:36,500
Or more extreme. So that's why it's trying to do.

195
00:22:36,770 --> 00:22:45,960
So basically what you can do is you can sum all the possible configuration with equal or lesser probability than observed.

196
00:22:45,980 --> 00:22:53,060
Because if it's, you know, the extreme observation will have less probability than what's observed.

197
00:22:53,070 --> 00:23:00,500
So the if the data conforms conforms to highly one Burkinabe, that'll have a largest probability.

198
00:23:00,860 --> 00:23:09,850
And when when it goes more, you know, deviates from the Taliban by Coulibaly and that'll gradually have a smaller probability.

199
00:23:09,860 --> 00:23:19,250
So that's that's what the intuition so basically the quantity we can calculate as get a P value can be written this way.

200
00:23:19,670 --> 00:23:28,310
So let's say and a B is a number of heterozygous genotype and these is the observed heterozygous phenotype.

201
00:23:29,060 --> 00:23:32,880
And you can. So.

202
00:23:34,390 --> 00:23:45,160
Well so that this is a true observe that you know that so and a this is a true observation so it is so you have the regional take out, right?

203
00:23:45,160 --> 00:23:53,709
So APB, right. If you have them, you can using that you can calculate the little frequency.

204
00:23:53,710 --> 00:24:01,060
So we assume that daily frequency is fixed. Okay, so calculate daily count of A's of fixed and the what varies.

205
00:24:01,090 --> 00:24:11,560
Only now is heterozygous country. You can vary the number of homozygous and had those as j was count by keeping the relatively low frequency the same.

206
00:24:12,040 --> 00:24:15,249
But you know, change the genotype configuration.

207
00:24:15,250 --> 00:24:18,340
So a number of homozygous and heterozygous variants are different.

208
00:24:18,880 --> 00:24:22,390
And what so in what configuration?

209
00:24:22,570 --> 00:24:28,049
The probability of having this number heterozygous is actually smaller than what we have.

210
00:24:28,050 --> 00:24:36,490
But this is some more extreme cases. And when you have all these extreme cases, so if this condition is true, if this is true,

211
00:24:36,700 --> 00:24:45,730
I am going to add up all this possible probability, and that is the test statistic we going to calculate.

212
00:24:46,150 --> 00:24:56,830
So if you know what the features, the exact test does, this is this makes more sense if you don't have don't know that.

213
00:24:56,830 --> 00:24:59,140
And if you haven't taken six or two multiple,

214
00:24:59,350 --> 00:25:09,070
this might be a little bit too hard to understand but that's that's as best as can explain what this test is that this can mean.

215
00:25:10,670 --> 00:25:16,549
Okay. So then the basically the goal is to calculate this probability.

216
00:25:16,550 --> 00:25:21,550
But the question is that this calculation itself is a competition.

217
00:25:21,550 --> 00:25:27,330
It's not trivial. So we need some some. Are smart tricks.

218
00:25:27,600 --> 00:25:31,550
So. So. So. Too.

219
00:25:31,820 --> 00:25:40,150
Too. So we're so. So we're going to go through this, you know, this equation in the next slide.

220
00:25:40,160 --> 00:25:45,720
So this is the quantity. We're going to coach it. We're going to calculate them before that.

221
00:25:46,170 --> 00:25:50,220
Let's try to figure this out how how we get there.

222
00:25:50,550 --> 00:26:00,990
Okay. So if you think about this probability, basically you have a two things you can you can count the not count the genotypes.

223
00:26:00,990 --> 00:26:02,410
You can also count the aliens.

224
00:26:02,430 --> 00:26:12,710
So what we know is that the condition is that the we know that there is a specific number of Elliott count a let's say you have a hundred,

225
00:26:12,870 --> 00:26:17,610
so let's say you have 100 chromosomes and out of a hundred chromosome, let's say you observed,

226
00:26:17,940 --> 00:26:27,629
I don't know, 21 the count of l a and out of 21 you can you can also have a different configuration.

227
00:26:27,630 --> 00:26:33,090
You may observe just one, one heterozygous genotype with two heterozygous genotypes and so on.

228
00:26:33,420 --> 00:26:37,830
So that's what where does this the probability we're going to calculate?

229
00:26:38,610 --> 00:26:43,229
So let's forget the genotypes and let's only talk about this arranging each of our

230
00:26:43,230 --> 00:26:49,600
levels and we have a two and possible alleles because we have and different samples.

231
00:26:49,600 --> 00:26:54,959
So a number of our labels we have is the number of chromosome is two to N so

232
00:26:54,960 --> 00:27:00,930
you can the problem is that how many cases do we have to arrange these cells.

233
00:27:00,930 --> 00:27:10,049
Well to total number of cases is this basically you're just calculating two and choose and a or equivalent to two and choose and B,

234
00:27:10,050 --> 00:27:15,780
so in this example, if you assume that there are four individuals, so eight haplotypes and there's a four.

235
00:27:18,300 --> 00:27:19,860
L'Oeil for l'oeil.

236
00:27:19,860 --> 00:27:29,370
For l'oeil, then this is one possible arrangement and the total number of arrangement it should be HS four so that you can calculate.

237
00:27:30,330 --> 00:27:38,490
So among them we wanted to calculate the probability of a specific heterozygous phenotype.

238
00:27:38,500 --> 00:27:41,910
So in this case. In this case.

239
00:27:42,300 --> 00:27:50,550
So how do we do it? Well, you can you can cut this little arrangement into pair of ls.

240
00:27:50,550 --> 00:27:57,750
And in this particular case you have a one AB have a B genotypes here to another AB phenotype here.

241
00:27:58,230 --> 00:28:06,540
So you have A to a B genotype. And you know, and while you have a four for a ls here,

242
00:28:06,540 --> 00:28:12,480
so the number of haplotype is four number of individuals for number of haplotype is eight and you have.

243
00:28:14,610 --> 00:28:21,540
You know, the genetic counties, one homozygous a and two heterozygous and one with SBB.

244
00:28:22,500 --> 00:28:27,240
So what is the probability you can arrange it that way?

245
00:28:27,270 --> 00:28:30,270
Well, this is a multi nominal distribution. So you have.

246
00:28:31,490 --> 00:28:36,290
Oh, this. This is the number of.

247
00:28:38,260 --> 00:28:47,220
You know, the number of arrangement. You can get for four for this possible arrangement.

248
00:28:48,390 --> 00:28:52,640
Okay. So. So.

249
00:28:54,700 --> 00:29:03,040
Then the ratio of these two quantities is basically looking like this.

250
00:29:03,220 --> 00:29:06,220
So, well, this is a multi nominal distribution.

251
00:29:10,480 --> 00:29:14,270
Yeah. Yeah. Assuming assuming that based on this count.

252
00:29:14,290 --> 00:29:17,950
So I think I think this should be straight forward.

253
00:29:18,250 --> 00:29:26,480
Okay. So and then then you can you can quantify these values based basically by by this equation.

254
00:29:26,500 --> 00:29:35,790
So where how does it look like? So this part is if you see this part is the same as this part, except it was switched.

255
00:29:35,800 --> 00:29:40,600
So this is the denominator. So this is the condition. So this is the denominator.

256
00:29:40,870 --> 00:29:47,759
And this part in probability that you have AB is specifying number you heterozygous is more specific case.

257
00:29:47,760 --> 00:29:55,840
So this is a numerator. So this value is the probability of an ab heterozygous conditioning on that you have.

258
00:29:56,530 --> 00:29:59,680
And different individuals in the total number of elderly.

259
00:29:59,710 --> 00:30:04,350
A little observed the elite observed this anyway.

260
00:30:04,720 --> 00:30:16,980
Okay. So then the question is you just need to calculate this value and try to add them up in all possible configurations.

261
00:30:18,060 --> 00:30:30,330
But this calculation can be quite computationally intensive and demanding, so you can do this calculation efficiently in a recursive fashion.

262
00:30:30,810 --> 00:30:34,140
Okay. So that's what these.

263
00:30:36,220 --> 00:30:41,770
This equation is doing so. So.

264
00:30:43,330 --> 00:30:48,310
So what what this equation is showing is that you can.

265
00:30:49,470 --> 00:30:52,450
If you wanted to calculate this value, okay,

266
00:30:53,010 --> 00:31:04,290
you can rewrite this value recursively or using the sum in the induction like form that you can represent this as a another similar form.

267
00:31:04,770 --> 00:31:08,999
And this requires quite of the calculation.

268
00:31:09,000 --> 00:31:19,110
But basically you can just plug in the same equation by changing this and of AB as an AB plus two, then you're going to have these C creation.

269
00:31:19,320 --> 00:31:27,630
Okay. So basically to have a two more heterogeneous genotype, you need to basically have one less homozygous genotype for each of them.

270
00:31:28,590 --> 00:31:32,280
If you wanted to maintain the total number of ALS, the C.

271
00:31:32,760 --> 00:31:36,690
Okay. So then you can rewrite this equation in this way.

272
00:31:36,690 --> 00:31:42,629
This way. So at the end, you know, all the factory has a cancer that cancer.

273
00:31:42,630 --> 00:31:47,250
So then you can represent this quantity into this.

274
00:31:47,250 --> 00:31:54,920
Quite. So, so as once you have one, one of these quantity calculated the other.

275
00:31:55,430 --> 00:32:00,200
Yeah. The quantity can be easily calculate without calculating all the factory else.

276
00:32:00,210 --> 00:32:06,660
So that was the main part of these, this particular item.

277
00:32:07,140 --> 00:32:12,330
And you don't have to use this algorithm if you don't need to achieve the computational efficiency.

278
00:32:12,330 --> 00:32:19,350
But this is a treat to achieve that efficiency to to do the calculation.

279
00:32:19,830 --> 00:32:30,870
So then if you perform the exact test using this way, basically you can calculate this each of the probability.

280
00:32:30,870 --> 00:32:35,699
Exactly. Here. So this probability can be calculated using this recursion.

281
00:32:35,700 --> 00:32:43,710
Exactly. So in assume chi square, this version is just approximate this distribution into some normal distribution.

282
00:32:43,720 --> 00:32:48,360
So and try to calculate the table probability so that that is the difference.

283
00:32:48,450 --> 00:32:56,000
So obviously the, you know, if the approximation works well, that'll that'll work well.

284
00:32:56,010 --> 00:33:06,750
But if this exact calculation should work better, if this approximation didn't work very well.

285
00:33:07,170 --> 00:33:20,320
So that's the idea behind it. And there is a some particular case of this test statistic, and this is a real data example how these look like.

286
00:33:20,710 --> 00:33:24,580
But this table itself may not make sense immediately.

287
00:33:24,580 --> 00:33:28,570
So. So the last part of these.

288
00:33:31,050 --> 00:33:36,330
This column notebook is actually trying to implement these.

289
00:33:36,900 --> 00:33:42,870
This testing is actually. So, uh, so let's let me go through.

290
00:33:42,900 --> 00:33:47,580
So each test of the holy one more clearly with so.

291
00:33:48,620 --> 00:33:51,390
With that, you know, before going through the exact test,

292
00:33:51,410 --> 00:33:57,740
we're were just trying to go through the Chi Square test once more because we need to compare with a high score test.

293
00:33:58,550 --> 00:34:03,709
And this exact test, the it looks much more complicated.

294
00:34:03,710 --> 00:34:10,550
I try to keep some comment to to explain what it looks like.

295
00:34:10,910 --> 00:34:20,350
But basically what we're trying to do is that we have a specific number of oh, so in this case,

296
00:34:20,380 --> 00:34:26,750
what we're trying to do is that we assume that the number of individual and number of aliens are already known.

297
00:34:27,110 --> 00:34:30,710
And what we vary is the number of heterozygous genotype.

298
00:34:31,310 --> 00:34:40,580
So if you think about how many well, how many heterozygous heterozygous genotype is possible if there are the aliens.

299
00:34:40,700 --> 00:34:49,850
So, so so for example, let's say there's 100 individuals and number over LDL a is observed 21 times.

300
00:34:50,660 --> 00:34:55,130
Then most extreme cases, they're all 21 cases.

301
00:34:55,400 --> 00:35:05,330
You know, those are heterozygous genotype. So you can have a 21 heterozygous genotype of a genotype to the observed 2108 LDL.

302
00:35:05,360 --> 00:35:06,410
So that's one way.

303
00:35:07,250 --> 00:35:19,340
Or you can observe 19 heterozygous heterozygous genotype over AB and the one homozygous genotype of eight and so on so that there are,

304
00:35:19,640 --> 00:35:27,150
you know, so basically assume that. And any calls hundred and a equals 21 for Egypt.

305
00:35:27,150 --> 00:35:34,990
But this is an example. So then that there could be an A could be zero and a equal 21.

306
00:35:35,000 --> 00:35:40,360
This is one possible configuration or an equal one and a equal 19.

307
00:35:40,370 --> 00:35:47,749
This is another configuration and a two and a two and a at a be equal 17.

308
00:35:47,750 --> 00:35:58,069
So that's that's all possible. So configuration, you can come up with an A, so this only works in the When and A's a is a minor level.

309
00:35:58,070 --> 00:36:03,260
So that's the assumption here. Okay. So, so.

310
00:36:04,860 --> 00:36:07,910
So if the frequency is greater than 50%, this doesn't work.

311
00:36:07,940 --> 00:36:17,280
So I should have mentioned that though here the we assume that that a LDL is marginally good.

312
00:36:18,150 --> 00:36:22,200
Okay. So that's the all possible configuration.

313
00:36:22,200 --> 00:36:24,569
So this is a possible number of heterozygous genotypes.

314
00:36:24,570 --> 00:36:34,500
And then if if this number is decided, then the number of homozygous in the homozygous, a homogeneous B is determined and.

315
00:36:35,740 --> 00:36:41,740
And so what we do is that, well, let's calculate the first probability.

316
00:36:42,010 --> 00:36:47,380
Okay. So first probabilities that everything is heterozygous, there is no homozygous phenotype.

317
00:36:47,770 --> 00:36:55,629
In that case, this computation is a simple because the end of a B, so there's no homozygous genotype.

318
00:36:55,630 --> 00:37:02,260
So we, we just calculate this the same probability here in the in the in this case.

319
00:37:02,260 --> 00:37:06,120
But we don't we assume that this is just zero.

320
00:37:06,130 --> 00:37:10,240
So the creation calculation is much simpler are doing this way.

321
00:37:10,240 --> 00:37:12,100
So we do the calculation here.

322
00:37:12,880 --> 00:37:23,050
Now, after that, we use this recursive formula to calculate the rest of the probability in a recursive way using the recursion.

323
00:37:24,610 --> 00:37:29,110
So basically we you multiply this value with a certain proportion.

324
00:37:29,110 --> 00:37:33,540
So this is this recursion is basically defined in this.

325
00:37:33,550 --> 00:37:38,170
We're just applying this recursion to calculate this value.

326
00:37:38,470 --> 00:37:45,310
Okay. So then we have all the possible exact probability for each of the case.

327
00:37:45,850 --> 00:37:49,930
Then you can calculate the p value by.

328
00:37:51,490 --> 00:37:56,560
So this is basically how collating the sum,

329
00:37:57,220 --> 00:38:07,660
doing the summation of those probability when the probability is a smaller than then the observed probability.

330
00:38:07,660 --> 00:38:17,500
This may be a little bit confusing to understand and you can try to go through, but this is exactly calculating this quantity.

331
00:38:17,860 --> 00:38:20,920
Okay. So that's what it what it is supposed to do.

332
00:38:21,280 --> 00:38:30,460
If you have a question. Feel free to ask in the pets hour during the day, after the class or in the office hours.

333
00:38:31,200 --> 00:38:34,940
So and this is a high school test just to compare.

334
00:38:34,960 --> 00:38:39,310
So this is the exact test and this is Chi square test statistic.

335
00:38:39,310 --> 00:38:43,810
And let's see how it looks like. So in this example,

336
00:38:43,810 --> 00:38:48,610
what we are doing is that we are assuming there is 100 samples in the main only counties

337
00:38:48,610 --> 00:38:54,270
at 21 and the we can enumerate the all the possible number of heterozygous here.

338
00:38:54,280 --> 00:39:01,690
So as I said, that number of heterozygous could be 21 maximum and it could be as small as one.

339
00:39:01,840 --> 00:39:12,850
And if the number of homozygous genotype is ten and which which value would be probably close to the hardy one we clearly have in this case,

340
00:39:13,150 --> 00:39:18,490
because this is a pretty, you know, low frequency at 20 well, 10% here.

341
00:39:18,820 --> 00:39:31,560
Right. So you have a 200. So you have a 200 cells and you have a 21 in the early frequencies, about about 10%, slightly over 10%.

342
00:39:31,570 --> 00:39:38,570
So you're going to expect the genotype, the frequencies, about 1%.

343
00:39:39,310 --> 00:39:52,020
So. So maybe you know, this having one of the hll is probably close to how you when you click me I guess so then that that is true.

344
00:39:52,020 --> 00:39:55,160
The p value in this case is is exactly once.

345
00:39:55,170 --> 00:40:02,340
So this has the largest p value. Okay. And a chi square test also says that this has a pretty large p value.

346
00:40:02,700 --> 00:40:17,519
Okay. So and if if it deviates more, if you have a more and more homozygous of that genotypes, then that's less likely to happen if the 81 is true.

347
00:40:17,520 --> 00:40:20,790
So the p value becomes a smaller and smaller as you see here.

348
00:40:21,240 --> 00:40:26,190
Okay. So that's what that's what you are observing here.

349
00:40:26,520 --> 00:40:34,790
Okay. And. You know, that that is that that is what this table is showing.

350
00:40:34,790 --> 00:40:39,170
So at this table should be basically equivalent to this table.

351
00:40:39,620 --> 00:40:47,449
It's showing here in what is trying to the what is trying to show here is that there are two

352
00:40:47,450 --> 00:40:53,530
p value chi square test and the exact test and sometimes those two value can be different.

353
00:40:53,540 --> 00:41:00,139
So here these are approximations from the Chi Square test and this should be the more correct p value they should.

354
00:41:00,140 --> 00:41:10,600
They correspond pretty well if the value is not too small, but if the value becomes very small, the exact test says that Peter is to my six,

355
00:41:10,610 --> 00:41:18,050
but the chi square test says it's a p value center mass ten so it becomes more and more skewed as you see.

356
00:41:18,320 --> 00:41:21,820
Okay. So you can try with other, you know, number.

357
00:41:21,890 --> 00:41:29,540
So I'm going to just try with the other numbers and you're going to see that how they behave in each of the cases.

358
00:41:29,540 --> 00:41:38,990
So you and you can play with it and try to understand how these object test becomes different from the Chi Square test.

359
00:41:39,710 --> 00:41:49,520
So most of the software we are using is using this implementing this exact test because with this heuristic, the calculation is not that.

360
00:41:51,620 --> 00:42:00,089
In a slow competition. So that's why. That's what the most of the other softwares implement implemented.

361
00:42:00,090 --> 00:42:06,299
But implementing on your own is definitely not very straightforward.

362
00:42:06,300 --> 00:42:09,360
And this is one attempted to.

363
00:42:11,290 --> 00:42:17,060
Go through the algorithm and try to make a toy implementation of this particular ugly.

364
00:42:18,670 --> 00:42:21,309
Okay. So that's what I wanted to cover.

365
00:42:21,310 --> 00:42:27,639
And this became a little bit longer than I was hoping, but I hope that this was helpful to understand this material.

366
00:42:27,640 --> 00:42:30,790
And if you have a moral question, feel free to reach out to me.

367
00:42:31,000 --> 00:42:32,410
Thank you. Okay, bye.

